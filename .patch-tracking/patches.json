{
  "patches": [
    {
      "patchId": "UJO*3.0*28",
      "package": "UJO*3.0*28",
      "packageCode": "UJO",
      "version": "3.0",
      "patchNumber": 28,
      "title": "Add New Prompt \"RESIDENT PATHOLOGIST\" For Surgical Pathology Accession Areas",
      "createdDate": "2025-06-17T15:05:03",
      "author": "Osama Swies",
      "description": [],
      "gitlabIssues": [],
      "routines": [
        "LRAPD1",
        "LRSPRPTA",
        "LRAPCUM",
        "LRAPBR1"
      ],
      "raw": "KIDS Distribution saved on Jun 17, 2025@15:05:03\nAdd New Prompt \"RESIDENT PATHOLOGIST\" For Surgical Pathology Accession Areas\n**KIDS**:UJO*3.0*28^\n\n**INSTALL NAME**\nUJO*3.0*28\n\"BLD\",9913,0)\nUJO*3.0*28^JORDAN SPECIFIC MODIFICATIONS^0^3250617^y\n\"BLD\",9913,1,0)\n^^28^28^3250617^^^\n\"BLD\",9913,1,1,0)\nThis Patch Was Created On 17/06/2025 By Osama Swies\n\"BLD\",9913,1,2,0)\n            \n\"BLD\",9913,1,3,0)\nhttps://gitlab.ehs.com.jo/software_projects/laboratory/lab-package/-/issue\n\"BLD\",9913,1,4,0)\ns/15\n\"BLD\",9913,1,5,0)\n \n\"BLD\",9913,1,6,0)\nhttps://gitlab.ehs.com.jo/software_projects/laboratory/lab-package/-/issue\n\"BLD\",9913,1,7,0)\ns/41\n\"BLD\",9913,1,8,0)\n \n\"BLD\",9913,1,9,0)\nhttps://gitlab.ehs.com.jo/software_projects/laboratory/lab-package/-/issue\n\"BLD\",9913,1,10,0)\ns/42\n\"BLD\",9913,1,11,0)\n \n\"BLD\",9913,1,12,0)\nThe Patch Includes Updates To Four Routines: LRAPD1, LRSPRPTA, LRAPCUM \n\"BLD\",9913,1,13,0)\nAnd LRAPBR1.\n\"BLD\",9913,1,14,0)\n \n\"BLD\",9913,1,15,0)\nThe Main Functionality Of Updating The Routine \"LRAPD1\" is To Add a New \n\"BLD\",9913,1,16,0)\n\"RESIDENT PATHOLOGIST\" Prompt For Surgical Pathology Accession Areas.\n\"BLD\",9913,1,17,0)\nOn [LRAPDGM] And [LRAPDGS] Options.\n\"BLD\",9913,1,18,0)\n \n\"BLD\",9913,1,19,0)\nThe Main Functionality Of Updating The Routine \"LRSPRPTA\" aligns \n\"BLD\",9913,1,20,0)\n\"RESIDENT PATHOLOGIST\" To The Left On [LRAPFICH], [LRAPQAM], [LRAPQAMR], \n\"BLD\",9913,1,21,0)\n[LRAPQAR], [LRAP PRINT SINGLE] Options.\n\"BLD\",9913,1,22,0)\n \n\"BLD\",9913,1,23,0)\nThe Main Functionality Of Updating The Routine \"LRAPCUM\" Is To Convert \n\"BLD\",9913,1,24,0)\nthe label \"Resident\" To \"Pathology Resident\" within the [LRAPSPCUM] And \n\"BLD\",9913,1,25,0)\n[LRAPPA] Options.\n\"BLD\",9913,1,26,0)\n \n\"BLD\",9913,1,27,0)\nThe Main Functionality Of Updating The Routine \"LRAPBR1\" aligns \"RESIDENT \n\"BLD\",9913,1,28,0)\nPATHOLOGIST\" To The Left On [LRAPR], [LRAPSPSGL] And [LRAPMOD] Options.\n\"BLD\",9913,4,0)\n^9.64PA^^\n\"BLD\",9913,6.3)\n6\n\"BLD\",9913,\"ABPKG\")\nn\n\"BLD\",9913,\"KRN\",0)\n^9.67PA^8993^21\n\"BLD\",9913,\"KRN\",.4,0)\n.4\n\"BLD\",9913,\"KRN\",.401,0)\n.401\n\"BLD\",9913,\"KRN\",.402,0)\n.402\n\"BLD\",9913,\"KRN\",.403,0)\n.403\n\"BLD\",9913,\"KRN\",.5,0)\n.5\n\"BLD\",9913,\"KRN\",.84,0)\n.84\n\"BLD\",9913,\"KRN\",3.6,0)\n3.6\n\"BLD\",9913,\"KRN\",3.8,0)\n3.8\n\"BLD\",9913,\"KRN\",9.2,0)\n9.2\n\"BLD\",9913,\"KRN\",9.8,0)\n9.8\n\"BLD\",9913,\"KRN\",9.8,\"NM\",0)\n^9.68A^5^4\n\"BLD\",9913,\"KRN\",9.8,\"NM\",2,0)\nLRAPD1^^0^B29057051\n\"BLD\",9913,\"KRN\",9.8,\"NM\",3,0)\nLRSPRPTA^^0^B18457484\n\"BLD\",9913,\"KRN\",9.8,\"NM\",4,0)\nLRAPCUM^^0^B26379480\n\"BLD\",9913,\"KRN\",9.8,\"NM\",5,0)\nLRAPBR1^^0^B137729318\n\"BLD\",9913,\"KRN\",9.8,\"NM\",\"B\",\"LRAPBR1\",5)\n\n\"BLD\",9913,\"KRN\",9.8,\"NM\",\"B\",\"LRAPCUM\",4)\n\n\"BLD\",9913,\"KRN\",9.8,\"NM\",\"B\",\"LRAPD1\",2)\n\n\"BLD\",9913,\"KRN\",9.8,\"NM\",\"B\",\"LRSPRPTA\",3)\n\n\"BLD\",9913,\"KRN\",19,0)\n19\n\"BLD\",9913,\"KRN\",19.1,0)\n19.1\n\"BLD\",9913,\"KRN\",101,0)\n101\n\"BLD\",9913,\"KRN\",409.61,0)\n409.61\n\"BLD\",9913,\"KRN\",771,0)\n771\n\"BLD\",9913,\"KRN\",779.2,0)\n779.2\n\"BLD\",9913,\"KRN\",870,0)\n870\n\"BLD\",9913,\"KRN\",8989.51,0)\n8989.51\n\"BLD\",9913,\"KRN\",8989.52,0)\n8989.52\n\"BLD\",9913,\"KRN\",8993,0)\n8993\n\"BLD\",9913,\"KRN\",8994,0)\n8994\n\"BLD\",9913,\"KRN\",\"B\",.4,.4)\n\n\"BLD\",9913,\"KRN\",\"B\",.401,.401)\n\n\"BLD\",9913,\"KRN\",\"B\",.402,.402)\n\n\"BLD\",9913,\"KRN\",\"B\",.403,.403)\n\n\"BLD\",9913,\"KRN\",\"B\",.5,.5)\n\n\"BLD\",9913,\"KRN\",\"B\",.84,.84)\n\n\"BLD\",9913,\"KRN\",\"B\",3.6,3.6)\n\n\"BLD\",9913,\"KRN\",\"B\",3.8,3.8)\n\n\"BLD\",9913,\"KRN\",\"B\",9.2,9.2)\n\n\"BLD\",9913,\"KRN\",\"B\",9.8,9.8)\n\n\"BLD\",9913,\"KRN\",\"B\",19,19)\n\n\"BLD\",9913,\"KRN\",\"B\",19.1,19.1)\n\n\"BLD\",9913,\"KRN\",\"B\",101,101)\n\n\"BLD\",9913,\"KRN\",\"B\",409.61,409.61)\n\n\"BLD\",9913,\"KRN\",\"B\",771,771)\n\n\"BLD\",9913,\"KRN\",\"B\",779.2,779.2)\n\n\"BLD\",9913,\"KRN\",\"B\",870,870)\n\n\"BLD\",9913,\"KRN\",\"B\",8989.51,8989.51)\n\n\"BLD\",9913,\"KRN\",\"B\",8989.52,8989.52)\n\n\"BLD\",9913,\"KRN\",\"B\",8993,8993)\n\n\"BLD\",9913,\"KRN\",\"B\",8994,8994)\n\n\"BLD\",9913,\"QUES\",0)\n^9.62^^\n\"BLD\",9913,\"REQB\",0)\n^9.611^^\n\"MBREQ\")\n0\n\"PKG\",209,-1)\n1^1\n\"PKG\",209,0)\nJORDAN SPECIFIC MODIFICATIONS^UJO\n\"PKG\",209,22,0)\n^9.49I^1^1\n\"PKG\",209,22,1,0)\n3.0\n\"PKG\",209,22,1,\"PAH\",1,0)\n28^3250617^8\n\"PKG\",209,22,1,\"PAH\",1,1,0)\n^^28^28^3250617\n\"PKG\",209,22,1,\"PAH\",1,1,1,0)\nThis Patch Was Created On 17/06/2025 By Osama Swies\n\"PKG\",209,22,1,\"PAH\",1,1,2,0)\n            \n\"PKG\",209,22,1,\"PAH\",1,1,3,0)\nhttps://gitlab.ehs.com.jo/software_projects/laboratory/lab-package/-/issue\n\"PKG\",209,22,1,\"PAH\",1,1,4,0)\ns/15\n\"PKG\",209,22,1,\"PAH\",1,1,5,0)\n \n\"PKG\",209,22,1,\"PAH\",1,1,6,0)\nhttps://gitlab.ehs.com.jo/software_projects/laboratory/lab-package/-/issue\n\"PKG\",209,22,1,\"PAH\",1,1,7,0)\ns/41\n\"PKG\",209,22,1,\"PAH\",1,1,8,0)\n \n\"PKG\",209,22,1,\"PAH\",1,1,9,0)\nhttps://gitlab.ehs.com.jo/software_projects/laboratory/lab-package/-/issue\n\"PKG\",209,22,1,\"PAH\",1,1,10,0)\ns/42\n\"PKG\",209,22,1,\"PAH\",1,1,11,0)\n \n\"PKG\",209,22,1,\"PAH\",1,1,12,0)\nThe Patch Includes Updates To Four Routines: LRAPD1, LRSPRPTA, LRAPCUM \n\"PKG\",209,22,1,\"PAH\",1,1,13,0)\nAnd LRAPBR1.\n\"PKG\",209,22,1,\"PAH\",1,1,14,0)\n \n\"PKG\",209,22,1,\"PAH\",1,1,15,0)\nThe Main Functionality Of Updating The Routine \"LRAPD1\" is To Add a New \n\"PKG\",209,22,1,\"PAH\",1,1,16,0)\n\"RESIDENT PATHOLOGIST\" Prompt For Surgical Pathology Accession Areas.\n\"PKG\",209,22,1,\"PAH\",1,1,17,0)\nOn [LRAPDGM] And [LRAPDGS] Options.\n\"PKG\",209,22,1,\"PAH\",1,1,18,0)\n \n\"PKG\",209,22,1,\"PAH\",1,1,19,0)\nThe Main Functionality Of Updating The Routine \"LRSPRPTA\" aligns \n\"PKG\",209,22,1,\"PAH\",1,1,20,0)\n\"RESIDENT PATHOLOGIST\" To The Left On [LRAPFICH], [LRAPQAM], [LRAPQAMR], \n\"PKG\",209,22,1,\"PAH\",1,1,21,0)\n[LRAPQAR], [LRAP PRINT SINGLE] Options.\n\"PKG\",209,22,1,\"PAH\",1,1,22,0)\n \n\"PKG\",209,22,1,\"PAH\",1,1,23,0)\nThe Main Functionality Of Updating The Routine \"LRAPCUM\" Is To Convert \n\"PKG\",209,22,1,\"PAH\",1,1,24,0)\nthe label \"Resident\" To \"Pathology Resident\" within the [LRAPSPCUM] And \n\"PKG\",209,22,1,\"PAH\",1,1,25,0)\n[LRAPPA] Options.\n\"PKG\",209,22,1,\"PAH\",1,1,26,0)\n \n\"PKG\",209,22,1,\"PAH\",1,1,27,0)\nThe Main Functionality Of Updating The Routine \"LRAPBR1\" aligns \"RESIDENT \n\"PKG\",209,22,1,\"PAH\",1,1,28,0)\nPATHOLOGIST\" To The Left On [LRAPR], [LRAPSPSGL] And [LRAPMOD] Options.\n\"QUES\",\"XPF1\",0)\nY\n\"QUES\",\"XPF1\",\"??\")\n^D REP^XPDH\n\"QUES\",\"XPF1\",\"A\")\nShall I write over your |FLAG| File\n\"QUES\",\"XPF1\",\"B\")\nYES\n\"QUES\",\"XPF1\",\"M\")\nD XPF1^XPDIQ\n\"QUES\",\"XPF2\",0)\nY\n\"QUES\",\"XPF2\",\"??\")\n^D DTA^XPDH\n\"QUES\",\"XPF2\",\"A\")\nWant my data |FLAG| yours\n\"QUES\",\"XPF2\",\"B\")\nYES\n\"QUES\",\"XPF2\",\"M\")\nD XPF2^XPDIQ\n\"QUES\",\"XPI1\",0)\nYO\n\"QUES\",\"XPI1\",\"??\")\n^D INHIBIT^XPDH\n\"QUES\",\"XPI1\",\"A\")\nWant KIDS to INHIBIT LOGONs during the install\n\"QUES\",\"XPI1\",\"B\")\nNO\n\"QUES\",\"XPI1\",\"M\")\nD XPI1^XPDIQ\n\"QUES\",\"XPM1\",0)\nPO^VA(200,:EM\n\"QUES\",\"XPM1\",\"??\")\n^D MG^XPDH\n\"QUES\",\"XPM1\",\"A\")\nEnter the Coordinator for Mail Group '|FLAG|'\n\"QUES\",\"XPM1\",\"B\")\n\n\"QUES\",\"XPM1\",\"M\")\nD XPM1^XPDIQ\n\"QUES\",\"XPO1\",0)\nY\n\"QUES\",\"XPO1\",\"??\")\n^D MENU^XPDH\n\"QUES\",\"XPO1\",\"A\")\nWant KIDS to Rebuild Menu Trees Upon Completion of Install\n\"QUES\",\"XPO1\",\"B\")\nNO\n\"QUES\",\"XPO1\",\"M\")\nD XPO1^XPDIQ\n\"QUES\",\"XPZ1\",0)\nY\n\"QUES\",\"XPZ1\",\"??\")\n^D OPT^XPDH\n\"QUES\",\"XPZ1\",\"A\")\nWant to DISABLE Scheduled Options, Menu Options, and Protocols\n\"QUES\",\"XPZ1\",\"B\")\nNO\n\"QUES\",\"XPZ1\",\"M\")\nD XPZ1^XPDIQ\n\"QUES\",\"XPZ2\",0)\nY\n\"QUES\",\"XPZ2\",\"??\")\n^D RTN^XPDH\n\"QUES\",\"XPZ2\",\"A\")\nWant to MOVE routines to other CPUs\n\"QUES\",\"XPZ2\",\"B\")\nNO\n\"QUES\",\"XPZ2\",\"M\")\nD XPZ2^XPDIQ\n\"RTN\")\n4\n\"RTN\",\"LRAPBR1\")\n0^5^B137729318\n\"RTN\",\"LRAPBR1\",1,0)\nLRAPBR1 ;DALOI/STAFF - AP Browser Print Cont. ;03/21/13  15:28\n\"RTN\",\"LRAPBR1\",2,0)\n ;;5.2;LAB SERVICE;**259,317,363,350,427**;Sep 27, 1994;Build 6\n\"RTN\",\"LRAPBR1\",3,0)\n ;\n\"RTN\",\"LRAPBR1\",4,0)\n ;\n\"RTN\",\"LRAPBR1\",5,0)\nENTER ; from LRAPBR\n\"RTN\",\"LRAPBR1\",6,0)\n N LRCNT,LRTMP,LRA1,LRADESC,LRLENG1,LRLENG2,LRFILE,LRAPMD\n\"RTN\",\"LRAPBR1\",7,0)\n N LRFLD,LRV,LRV1,LRV2,LRX,LRB1,LRTEXT,LRSPCE,LRIENS,LRAPMR\n\"RTN\",\"LRAPBR1\",8,0)\n Q:'$D(^LR(LRDFN,LRSS,LRI,0))\n\"RTN\",\"LRAPBR1\",9,0)\n S:'LRTIU GROOT=\"^TMP(\"\"LRAPBR\"\",$J,\"\n\"RTN\",\"LRAPBR1\",10,0)\n S:LRTIU GROOT=\"^TMP(\"\"TIUP\"\",$J,\"\n\"RTN\",\"LRAPBR1\",11,0)\n ;\n\"RTN\",\"LRAPBR1\",12,0)\n D GETPCP^LRAPUTL(.LRPRAC,LRDFN,LRSS,LRI)\n\"RTN\",\"LRAPBR1\",13,0)\n ;\n\"RTN\",\"LRAPBR1\",14,0)\n ; If reporting lab available then use instead of VistA site name.\n\"RTN\",\"LRAPBR1\",15,0)\n S LRX=+$G(^LR(LRDFN,LRSS,LRI,\"RF\"))\n\"RTN\",\"LRAPBR1\",16,0)\n I LRX S LRQ(1)=$$NAME^XUAF4(LRX)\n\"RTN\",\"LRAPBR1\",17,0)\n ;\n\"RTN\",\"LRAPBR1\",18,0)\n S LRQ=0 D ^LRUA,HEADER\n\"RTN\",\"LRAPBR1\",19,0)\n S LR(\"F\")=1\n\"RTN\",\"LRAPBR1\",20,0)\n D DASH\n\"RTN\",\"LRAPBR1\",21,0)\n D:LRTIU GLENTRY(\"$TEXT\",,1)\n\"RTN\",\"LRAPBR1\",22,0)\n D GLENTRY(\"Submitted by: \"_LRW(5),\"\",1)\n\"RTN\",\"LRAPBR1\",23,0)\n D GLENTRY(\"Date obtained: \"_LRTK,44)\n\"RTN\",\"LRAPBR1\",24,0)\n D:LRA DASH\n\"RTN\",\"LRAPBR1\",25,0)\n ;\n\"RTN\",\"LRAPBR1\",26,0)\n S LRIENS=LRI_\",\"_LRDFN_\",\"\n\"RTN\",\"LRAPBR1\",27,0)\n ;\n\"RTN\",\"LRAPBR1\",28,0)\n ;\n\"RTN\",\"LRAPBR1\",29,0)\nMAIN ;\n\"RTN\",\"LRAPBR1\",30,0)\n D SPEC\n\"RTN\",\"LRAPBR1\",31,0)\n D MODCHK\n\"RTN\",\"LRAPBR1\",32,0)\n D SUPBNNR\n\"RTN\",\"LRAPBR1\",33,0)\n ; DALOI/LMT - LR,427 - Removed comments from report to restore pre-LR,350 behavior\n\"RTN\",\"LRAPBR1\",34,0)\n ;D COMMENT\n\"RTN\",\"LRAPBR1\",35,0)\n D DIAG\n\"RTN\",\"LRAPBR1\",36,0)\n D DOC\n\"RTN\",\"LRAPBR1\",37,0)\n D WPFLD\n\"RTN\",\"LRAPBR1\",38,0)\n D SUPRPT\n\"RTN\",\"LRAPBR1\",39,0)\n D SSJR\n\"RTN\",\"LRAPBR1\",40,0)\n Q\n\"RTN\",\"LRAPBR1\",41,0)\n ;\n\"RTN\",\"LRAPBR1\",42,0)\n ;\n\"RTN\",\"LRAPBR1\",43,0)\nSPEC ; List specimens\n\"RTN\",\"LRAPBR1\",44,0)\n ;\n\"RTN\",\"LRAPBR1\",45,0)\n ;ZEXCEPT: LRDFN,LRI,LRIENS,LRSF,LRSS\n\"RTN\",\"LRAPBR1\",46,0)\n ;\n\"RTN\",\"LRAPBR1\",47,0)\n N LRB,LRFILE,LRX\n\"RTN\",\"LRAPBR1\",48,0)\n ;\n\"RTN\",\"LRAPBR1\",49,0)\n D GLENTRY(\"Specimen (Received \"_LRTK(1)_\"):\",\"\",1)\n\"RTN\",\"LRAPBR1\",50,0)\n ;\n\"RTN\",\"LRAPBR1\",51,0)\n S LRFILE=+$$GET1^DID(LRSF,.012,\"\",\"SPECIFIER\")\n\"RTN\",\"LRAPBR1\",52,0)\n S LRB=0\n\"RTN\",\"LRAPBR1\",53,0)\n F  S LRB=$O(^LR(LRDFN,LRSS,LRI,.1,LRB)) Q:LRB<1  D\n\"RTN\",\"LRAPBR1\",54,0)\n . S LRX=$$GET1^DIQ(LRFILE,LRB_\",\"_LRIENS,.01)\n\"RTN\",\"LRAPBR1\",55,0)\n . D GLENTRY(LRX,\"\",1)\n\"RTN\",\"LRAPBR1\",56,0)\n ;\n\"RTN\",\"LRAPBR1\",57,0)\n Q\n\"RTN\",\"LRAPBR1\",58,0)\n ;\n\"RTN\",\"LRAPBR1\",59,0)\n ;\n\"RTN\",\"LRAPBR1\",60,0)\nMODCHK ; Display modified banner if required\n\"RTN\",\"LRAPBR1\",61,0)\n S LRAPMR=$$GET1^DIQ(LRSF,LRIENS,.17,\"I\")\n\"RTN\",\"LRAPBR1\",62,0)\n Q:'LRAPMR\n\"RTN\",\"LRAPBR1\",63,0)\n S LRAPMD=$$GET1^DIQ(LRSF,LRIENS,.172,\"I\")\n\"RTN\",\"LRAPBR1\",64,0)\n D GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",65,0)\n S LRTEXT=\"\"\n\"RTN\",\"LRAPBR1\",66,0)\n F LRCNT=1:1:$S(LRAPMD:14,1:15) D\n\"RTN\",\"LRAPBR1\",67,0)\n . S LRTEXT=LRTEXT_\"*+\"\n\"RTN\",\"LRAPBR1\",68,0)\n S LRTEXT=LRTEXT_\" MODIFIED \"\n\"RTN\",\"LRAPBR1\",69,0)\n S LRTEXT=LRTEXT_$S(LRAPMD:\"DIAGNOSIS \",1:\"REPORT \")\n\"RTN\",\"LRAPBR1\",70,0)\n F LRCNT=1:1:$S(LRAPMD:14,1:15) D\n\"RTN\",\"LRAPBR1\",71,0)\n . S LRTEXT=LRTEXT_\"*+\"\n\"RTN\",\"LRAPBR1\",72,0)\n D GLENTRY(LRTEXT,\"\",1)\n\"RTN\",\"LRAPBR1\",73,0)\n D GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",74,0)\n Q\n\"RTN\",\"LRAPBR1\",75,0)\n ;\n\"RTN\",\"LRAPBR1\",76,0)\n ;\n\"RTN\",\"LRAPBR1\",77,0)\nSUPBNNR ; Display supplementary report header if one or more has been added\n\"RTN\",\"LRAPBR1\",78,0)\n I $P($G(^LR(LRDFN,LRSS,LRI,1.2,0)),U,4) D\n\"RTN\",\"LRAPBR1\",79,0)\n . S LRTEXT=\"*+* SUPPLEMENTARY REPORT HAS BEEN ADDED *+*\"\n\"RTN\",\"LRAPBR1\",80,0)\n . D GLENTRY($$CJ^XLFSTR(LRTEXT,IOM),\"\",1)\n\"RTN\",\"LRAPBR1\",81,0)\n . S LRTEXT=\"*+* REFER TO BOTTOM OF REPORT *+*\"\n\"RTN\",\"LRAPBR1\",82,0)\n . D GLENTRY($$CJ^XLFSTR(LRTEXT,IOM),\"\",1)\n\"RTN\",\"LRAPBR1\",83,0)\n . D GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",84,0)\n Q\n\"RTN\",\"LRAPBR1\",85,0)\n ;\n\"RTN\",\"LRAPBR1\",86,0)\n ;\n\"RTN\",\"LRAPBR1\",87,0)\nDIAG ; Display the Brief Clinical History, Preoperative Diagnosis, Operative Findings, and Postoperative Diagnosis\n\"RTN\",\"LRAPBR1\",88,0)\n S LRFILE=LRSF,LRCNT=0,LRIENS=LRI_\",\"_LRDFN_\",\"\n\"RTN\",\"LRAPBR1\",89,0)\n F LRFLD=.013:.001:.016 D\n\"RTN\",\"LRAPBR1\",90,0)\n . D:LRA DASH\n\"RTN\",\"LRAPBR1\",91,0)\n . S LRCNT=LRCNT+1\n\"RTN\",\"LRAPBR1\",92,0)\n . D GLENTRY($P($T(TEXT1+LRCNT),\";\",3),\"\",1)\n\"RTN\",\"LRAPBR1\",93,0)\n . D WP\n\"RTN\",\"LRAPBR1\",94,0)\n Q\n\"RTN\",\"LRAPBR1\",95,0)\n ;\n\"RTN\",\"LRAPBR1\",96,0)\n ;\n\"RTN\",\"LRAPBR1\",97,0)\nDOC ; Pathologist information\n\"RTN\",\"LRAPBR1\",98,0)\n ;\n\"RTN\",\"LRAPBR1\",99,0)\n N LRIENS,LRX\n\"RTN\",\"LRAPBR1\",100,0)\n D GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",101,0)\n ;\n\"RTN\",\"LRAPBR1\",102,0)\n ; Retrieve surgeon/attending\n\"RTN\",\"LRAPBR1\",103,0)\n D ATTEND(.LRMD)\n\"RTN\",\"LRAPBR1\",104,0)\n D GLENTRY(\"Surgeon/physician: \"_LRMD,27,1)\n\"RTN\",\"LRAPBR1\",105,0)\n I LRMD(\"SR-SURGEON\")'=\"\" D GLENTRY(LRMD(\"SR-SURGEON\"),28,1)\n\"RTN\",\"LRAPBR1\",106,0)\n I LRMD(\"SR-ATTEND\")'=\"\" D GLENTRY(LRMD(\"SR-ATTEND\"),26,1)\n\"RTN\",\"LRAPBR1\",107,0)\n ;I +$G(LRMD(\"ERR\"))=601 D GLENTRY($P(LRMD(\"ERR\"),\"^\",2),26,1)\n\"RTN\",\"LRAPBR1\",108,0)\n ;\n\"RTN\",\"LRAPBR1\",109,0)\n D:LRA GLENTRY(LR(\"%1\"),\"\",1)\n\"RTN\",\"LRAPBR1\",110,0)\n D DASH\n\"RTN\",\"LRAPBR1\",111,0)\n D HEADER2\n\"RTN\",\"LRAPBR1\",112,0)\n D:LRA DASH\n\"RTN\",\"LRAPBR1\",113,0)\n I LRRC=\"\" D\n\"RTN\",\"LRAPBR1\",114,0)\n . D GLENTRY(\"+*+* REPORT INCOMPLETE *+*+\",20,1)\n\"RTN\",\"LRAPBR1\",115,0)\n . D GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",116,0)\n D GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",117,0)\n I LRRMD'=\"\" D\n\"RTN\",\"LRAPBR1\",118,0)\n . S LRCNT=0 F LRA1=\"SP\",\"CY\",\"EM\" D\n\"RTN\",\"LRAPBR1\",119,0)\n . . S LRCNT=LRCNT+1\n\"RTN\",\"LRAPBR1\",120,0)\n . . S LRTMP(LRA1)=$P($T(TEXT2+LRCNT),\";\",4)\n\"RTN\",\"LRAPBR1\",121,0)\n . S LRTMP=LRTMP(LRSS)\n\"RTN\",\"LRAPBR1\",122,0)\n        .;EHS/OSS ;UJO*3.0*28 ; JUN 17,2025 ;Update[This Change Was Made To Align \"Pathology Resident\" To The Left]\n\"RTN\",\"LRAPBR1\",123,0)\n        .; Scope  : Aligned \"RESIDENT PATHOLOGIST\" Label To The Left On LRAPR, LRAPSPSGL And LRAPMOD Options\n\"RTN\",\"LRAPBR1\",124,0)\n        .;. D GLENTRY(LRTMP_\" \"_LRRMD,31)\n\"RTN\",\"LRAPBR1\",125,0)\n . DO GLENTRY(LRTMP_\" \"_LRRMD,\"\")\n\"RTN\",\"LRAPBR1\",126,0)\n Q\n\"RTN\",\"LRAPBR1\",127,0)\n ;\n\"RTN\",\"LRAPBR1\",128,0)\n ;\n\"RTN\",\"LRAPBR1\",129,0)\nWPFLD ; Display Frozen Section, Gross Description, Microscopic Description and Surgical Path Diagnosis\n\"RTN\",\"LRAPBR1\",130,0)\n F LRCNT=1:1:4 D\n\"RTN\",\"LRAPBR1\",131,0)\n . S X=$T(FIELDS+LRCNT)\n\"RTN\",\"LRAPBR1\",132,0)\n . S LRV=$P(X,\";\",3),LRV1=$P(X,\";\",4),LRV2=$P(X,\";\",5)\n\"RTN\",\"LRAPBR1\",133,0)\n . D TEXTCHK\n\"RTN\",\"LRAPBR1\",134,0)\n . I $P($G(^LR(LRDFN,LRSS,LRI,LRV,0)),U,4) D\n\"RTN\",\"LRAPBR1\",135,0)\n . . D GLENTRY(\"\",\"\",1),GLENTRY(LR(69.2,LRV1),\"\",1)\n\"RTN\",\"LRAPBR1\",136,0)\n . . S LRFILE=LRSF,LRIENS=LRI_\",\"_LRDFN_\",\",LRFLD=LRV\n\"RTN\",\"LRAPBR1\",137,0)\n . . I $P($G(^LR(LRDFN,LRSS,LRI,LRV2,0)),U,4) D\n\"RTN\",\"LRAPBR1\",138,0)\n . . . S LRFILE1=+$$GET1^DID(LRSF,LRV2,\"\",\"SPECIFIER\")\n\"RTN\",\"LRAPBR1\",139,0)\n . . . D GLENTRY(\"*+* MODIFIED REPORT *+*\",28,1)\n\"RTN\",\"LRAPBR1\",140,0)\n . . . D GLENTRY(\"(Last modified: \",\"\",1)\n\"RTN\",\"LRAPBR1\",141,0)\n . . . S (LRA1,LRB1)=0\n\"RTN\",\"LRAPBR1\",142,0)\n . . . F  S LRA1=$O(^LR(LRDFN,LRSS,LRI,LRV2,LRA1)) Q:'LRA1  S LRB1=LRA1\n\"RTN\",\"LRAPBR1\",143,0)\n . . . Q:'$D(^LR(LRDFN,LRSS,LRI,LRV2,LRB1,0))\n\"RTN\",\"LRAPBR1\",144,0)\n . . . S LRSR1=$$GET1^DIQ(LRFILE1,LRB1_\",\"_LRIENS,.01)\n\"RTN\",\"LRAPBR1\",145,0)\n . . . S LRSR2=$$GET1^DIQ(LRFILE1,LRB1_\",\"_LRIENS,.02)\n\"RTN\",\"LRAPBR1\",146,0)\n . . . S LRTEXT=LRSR1_\" typed by \"_LRSR2_\")\"\n\"RTN\",\"LRAPBR1\",147,0)\n . . . D GLENTRY(LRTEXT,BTAB)\n\"RTN\",\"LRAPBR1\",148,0)\n . . D WP\n\"RTN\",\"LRAPBR1\",149,0)\n Q\n\"RTN\",\"LRAPBR1\",150,0)\n ;\n\"RTN\",\"LRAPBR1\",151,0)\n ;\n\"RTN\",\"LRAPBR1\",152,0)\nSUPRPT ; Supplementary Report\n\"RTN\",\"LRAPBR1\",153,0)\n N LRA2\n\"RTN\",\"LRAPBR1\",154,0)\n I $P($G(^LR(LRDFN,LRSS,LRI,1.2,0)),U,4) D\n\"RTN\",\"LRAPBR1\",155,0)\n . S LRFILE=+$$GET1^DID(LRSF,1.2,\"\",\"SPECIFIER\")\n\"RTN\",\"LRAPBR1\",156,0)\n . S LRIENS1=LRI_\",\"_LRDFN_\",\"\n\"RTN\",\"LRAPBR1\",157,0)\n . D GLENTRY(\"\",\"\",1),GLENTRY(\"SUPPLEMENTARY REPORT(S):\",\"\",1)\n\"RTN\",\"LRAPBR1\",158,0)\n . S LRV=0 F  S LRV=$O(^LR(LRDFN,LRSS,LRI,1.2,LRV)) Q:'LRV  D\n\"RTN\",\"LRAPBR1\",159,0)\n . . S LRIENS=LRV_\",\"_LRIENS1\n\"RTN\",\"LRAPBR1\",160,0)\n . . S LRSR1=$$GET1^DIQ(LRFILE,LRIENS,.01)\n\"RTN\",\"LRAPBR1\",161,0)\n . . S LRSR2=+$$GET1^DIQ(LRFILE,LRIENS,.02)\n\"RTN\",\"LRAPBR1\",162,0)\n . . D GLENTRY(\"Supplementary Report Date: \"_LRSR1,3,1)\n\"RTN\",\"LRAPBR1\",163,0)\n . . I $D(LR(\"R\")),'LRSR2 D GLENTRY(\" not verified\",BTAB) Q\n\"RTN\",\"LRAPBR1\",164,0)\n . . I $P($G(^LR(LRDFN,LRSS,LRI,1.2,LRV,2,0)),U,4) D\n\"RTN\",\"LRAPBR1\",165,0)\n . . . S LRTEXT=\"*+* SUPPLEMENTARY REPORT HAS BEEN ADDED/MODIFIED *+*\"\n\"RTN\",\"LRAPBR1\",166,0)\n . . . D GLENTRY($$CJ^XLFSTR(LRTEXT,IOM),\"\",1)\n\"RTN\",\"LRAPBR1\",167,0)\n . . . D GLENTRY(\"(Added/Last\",\"\",1)\n\"RTN\",\"LRAPBR1\",168,0)\n . . . S (LRA1,LRB1)=0\n\"RTN\",\"LRAPBR1\",169,0)\n . . . F  S LRA1=$O(^LR(LRDFN,LRSS,LRI,1.2,LRV,2,LRA1)) Q:'LRA1  D\n\"RTN\",\"LRAPBR1\",170,0)\n . . . . S LRB1=LRA1\n\"RTN\",\"LRAPBR1\",171,0)\n . . . Q:'$D(^LR(LRDFN,LRSS,LRI,1.2,LRV,2,LRB1,0))\n\"RTN\",\"LRAPBR1\",172,0)\n . . . S LRA2=^(0),Y=+LRA2,LRA2A=$P(LRA2,\"^\",2),LRSGN=\" Typed by \",LRDSC=\" modified: \"\n\"RTN\",\"LRAPBR1\",173,0)\n . . . I $P(LRA2,\"^\",3) S LRSGN=\" Signed by \",LRDSC=\" released: \",LRA2A=$P(LRA2,\"^\",3),Y=$P(LRA2,\"^\",4)\n\"RTN\",\"LRAPBR1\",174,0)\n . . . S LRA2A=$S($D(^VA(200,LRA2A,0)):$P(^(0),\"^\"),1:LRA2A)\n\"RTN\",\"LRAPBR1\",175,0)\n . . . D D^LRU\n\"RTN\",\"LRAPBR1\",176,0)\n . . . D GLENTRY(LRDSC_Y_LRSGN_LRA2A_\")\",BTAB)\n\"RTN\",\"LRAPBR1\",177,0)\n . . S LRFLD=1 D WP\n\"RTN\",\"LRAPBR1\",178,0)\n . . D GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",179,0)\n Q\n\"RTN\",\"LRAPBR1\",180,0)\n ;\n\"RTN\",\"LRAPBR1\",181,0)\n ;\n\"RTN\",\"LRAPBR1\",182,0)\nCOMMENT ; Print comment field (#99)\n\"RTN\",\"LRAPBR1\",183,0)\n ;\n\"RTN\",\"LRAPBR1\",184,0)\n N LRB\n\"RTN\",\"LRAPBR1\",185,0)\n I '$O(^LR(LRDFN,LRSS,LRI,99,0)) Q\n\"RTN\",\"LRAPBR1\",186,0)\n ;\n\"RTN\",\"LRAPBR1\",187,0)\n D GLENTRY(\"Comment:\",\"\",1)\n\"RTN\",\"LRAPBR1\",188,0)\n ;\n\"RTN\",\"LRAPBR1\",189,0)\n S LRB=0\n\"RTN\",\"LRAPBR1\",190,0)\n F  S LRB=$O(^LR(LRDFN,LRSS,LRI,99,LRB)) Q:'LRB  D\n\"RTN\",\"LRAPBR1\",191,0)\n . S LRB(0)=^LR(LRDFN,LRSS,LRI,99,LRB,0)\n\"RTN\",\"LRAPBR1\",192,0)\n . D GLENTRY(LRB(0),\"\",1)\n\"RTN\",\"LRAPBR1\",193,0)\n ;\n\"RTN\",\"LRAPBR1\",194,0)\n D GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",195,0)\n ;\n\"RTN\",\"LRAPBR1\",196,0)\n Q\n\"RTN\",\"LRAPBR1\",197,0)\n ;\n\"RTN\",\"LRAPBR1\",198,0)\n ;\n\"RTN\",\"LRAPBR1\",199,0)\nSSJR ; Print special studies/journal references\n\"RTN\",\"LRAPBR1\",200,0)\n D ^LRAPBR3\n\"RTN\",\"LRAPBR1\",201,0)\n S LREFLG=1\n\"RTN\",\"LRAPBR1\",202,0)\n Q\n\"RTN\",\"LRAPBR1\",203,0)\n ;\n\"RTN\",\"LRAPBR1\",204,0)\n ;\n\"RTN\",\"LRAPBR1\",205,0)\nPPL ; Print performing laboratories.\n\"RTN\",\"LRAPBR1\",206,0)\n N LRPL,LRJ\n\"RTN\",\"LRAPBR1\",207,0)\n ;\n\"RTN\",\"LRAPBR1\",208,0)\n D RETLST^LRRPL(.LRPL,LRDFN,LRSS,LRI,0)\n\"RTN\",\"LRAPBR1\",209,0)\n I $G(LRPL)<1 Q\n\"RTN\",\"LRAPBR1\",210,0)\n ;\n\"RTN\",\"LRAPBR1\",211,0)\n D GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",212,0)\n D GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",213,0)\n ;\n\"RTN\",\"LRAPBR1\",214,0)\n D GLENTRY(\"Performing Laboratory:\",\"\",1)\n\"RTN\",\"LRAPBR1\",215,0)\n S LRJ=0\n\"RTN\",\"LRAPBR1\",216,0)\n F  S LRJ=$O(LRPL(LRJ)) Q:'LRJ  D GLENTRY(LRPL(LRJ),\"\",1)\n\"RTN\",\"LRAPBR1\",217,0)\n ;\n\"RTN\",\"LRAPBR1\",218,0)\n D GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",219,0)\n ;\n\"RTN\",\"LRAPBR1\",220,0)\n Q\n\"RTN\",\"LRAPBR1\",221,0)\n ;\n\"RTN\",\"LRAPBR1\",222,0)\n ;\n\"RTN\",\"LRAPBR1\",223,0)\nWP ; Display word processing fields\n\"RTN\",\"LRAPBR1\",224,0)\n K LRTMP,^UTILITY($J,\"W\")\n\"RTN\",\"LRAPBR1\",225,0)\n N X,DIWR,DIWL,LRINC\n\"RTN\",\"LRAPBR1\",226,0)\n S X=$$GET1^DIQ(LRFILE,LRIENS,LRFLD,\"\",\"LRTMP\",)\n\"RTN\",\"LRAPBR1\",227,0)\n S DIWR=IOM-5,DIWL=5,DIWF=$G(DIWF)\n\"RTN\",\"LRAPBR1\",228,0)\n S X=+$$GET1^DID(LRFILE,LRFLD,\"\",\"SPECIFIER\")\n\"RTN\",\"LRAPBR1\",229,0)\n I $$GET1^DID(X,.01,\"\",\"SPECIFIER\")[\"L\",DIWF'[\"N\" S DIWF=DIWF_\"N\"\n\"RTN\",\"LRAPBR1\",230,0)\n S LRINC=0\n\"RTN\",\"LRAPBR1\",231,0)\n F  S LRINC=$O(LRTMP(LRINC)) Q:'LRINC  S X=LRTMP(LRINC) D ^DIWP\n\"RTN\",\"LRAPBR1\",232,0)\n S LRINC=0\n\"RTN\",\"LRAPBR1\",233,0)\n F  S LRINC=$O(^UTILITY($J,\"W\",DIWL,LRINC)) Q:'LRINC  D GLENTRY(^UTILITY($J,\"W\",DIWL,LRINC,0),DIWL,1)\n\"RTN\",\"LRAPBR1\",234,0)\n K ^UTILITY($J,\"W\")\n\"RTN\",\"LRAPBR1\",235,0)\n Q\n\"RTN\",\"LRAPBR1\",236,0)\n ;\n\"RTN\",\"LRAPBR1\",237,0)\n ;\n\"RTN\",\"LRAPBR1\",238,0)\nHEADER ;\n\"RTN\",\"LRAPBR1\",239,0)\n D:LRTIU GLENTRY(\"$APHDR\",,1)\n\"RTN\",\"LRAPBR1\",240,0)\n D GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",241,0)\n ;\n\"RTN\",\"LRAPBR1\",242,0)\n ; Print names of facilities printing/releasing this report.\n\"RTN\",\"LRAPBR1\",243,0)\n N LRN,LRPL,LRRL,LRX\n\"RTN\",\"LRAPBR1\",244,0)\n I $$GET^XPAR(\"DIV^PKG\",\"LR REPORTS FACILITY PRINT\",1,\"Q\")>1,'LRTIU D\n\"RTN\",\"LRAPBR1\",245,0)\n . D PFAC^LRRP1(DUZ(2),\"\",1,.LRPL)\n\"RTN\",\"LRAPBR1\",246,0)\n . S LRN=0\n\"RTN\",\"LRAPBR1\",247,0)\n . F  S LRN=$O(LRPL(LRN)) Q:'LRN  D GLENTRY(LRPL(LRN),\"\",1)\n\"RTN\",\"LRAPBR1\",248,0)\n ;\n\"RTN\",\"LRAPBR1\",249,0)\n ; Display reporting lab\n\"RTN\",\"LRAPBR1\",250,0)\n I $$GET^XPAR(\"DIV^PKG\",\"LR REPORTS FACILITY PRINT\",1,\"Q\")#2 D\n\"RTN\",\"LRAPBR1\",251,0)\n . S LRX=+$G(^LR(LRDFN,LRSS,LRI,\"RF\"))\n\"RTN\",\"LRAPBR1\",252,0)\n . I LRX<1 Q\n\"RTN\",\"LRAPBR1\",253,0)\n . D RL^LRRP1(LRX,1,.LRRL),GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",254,0)\n . S LRN=0\n\"RTN\",\"LRAPBR1\",255,0)\n . F  S LRN=$O(LRRL(LRN)) Q:'LRN  D GLENTRY(LRRL(LRN),\"\",1)\n\"RTN\",\"LRAPBR1\",256,0)\n ;\n\"RTN\",\"LRAPBR1\",257,0)\n D DASH\n\"RTN\",\"LRAPBR1\",258,0)\n D GLENTRY(\"MEDICAL RECORD |\",5,1)\n\"RTN\",\"LRAPBR1\",259,0)\n D GLENTRY(LRAA1,40)\n\"RTN\",\"LRAPBR1\",260,0)\n D DASH\n\"RTN\",\"LRAPBR1\",261,0)\n ;\n\"RTN\",\"LRAPBR1\",262,0)\n ;\n\"RTN\",\"LRAPBR1\",263,0)\nHEADER2 ;\n\"RTN\",\"LRAPBR1\",264,0)\n ;\n\"RTN\",\"LRAPBR1\",265,0)\n S LRADESC=\"Accession No. \"_$S(LRQ(8)]\"\":LRQ(8)_LRW(1)_\" \"_LRAC,1:LRAC)\n\"RTN\",\"LRAPBR1\",266,0)\n S LRLENG1=$L(LRQ(1)),LRLENG2=$L(LRADESC),LRSPCE=IOM-LRLENG2-14\n\"RTN\",\"LRAPBR1\",267,0)\n S:LRLENG1>LRSPCE LRQ(1)=$E(LRQ(1),1,LRSPCE)\n\"RTN\",\"LRAPBR1\",268,0)\n ;\n\"RTN\",\"LRAPBR1\",269,0)\n D GLENTRY(\"PATHOLOGY REPORT\",30,1)\n\"RTN\",\"LRAPBR1\",270,0)\n I '$G(^LR(LRDFN,LRSS,LRI,\"RF\")) D GLENTRY(\"Laboratory: \"_LRQ(1),\"\",1)\n\"RTN\",\"LRAPBR1\",271,0)\n D GLENTRY(LRADESC,IOM-LRLENG2-1)\n\"RTN\",\"LRAPBR1\",272,0)\n Q\n\"RTN\",\"LRAPBR1\",273,0)\n ;\n\"RTN\",\"LRAPBR1\",274,0)\n ;\n\"RTN\",\"LRAPBR1\",275,0)\nFOOTER ; Footer-called from ^LRAPBR\n\"RTN\",\"LRAPBR1\",276,0)\n D:LRTIU GLENTRY(\"$FTR\",,1)\n\"RTN\",\"LRAPBR1\",277,0)\n D DASH\n\"RTN\",\"LRAPBR1\",278,0)\n S LRTEXT=$S('$D(LR(\"W\")):\"\",1:\"See signed copy in chart\")\n\"RTN\",\"LRAPBR1\",279,0)\n D GLENTRY(LRTEXT,\"\",1)\n\"RTN\",\"LRAPBR1\",280,0)\n S LRTEXT=\"(\"_$S($D(LREFLG):\"End of report\",1:\"See next page\")_\")\"\n\"RTN\",\"LRAPBR1\",281,0)\n D GLENTRY(LRTEXT,57)\n\"RTN\",\"LRAPBR1\",282,0)\n D GLENTRY(LRPMD,\"\",1),GLENTRY(LRW(9),52),GLENTRY(\"| Date \"_LRRC,55)\n\"RTN\",\"LRAPBR1\",283,0)\n D DASH\n\"RTN\",\"LRAPBR1\",284,0)\n D GLENTRY(LRP,\"\",1)\n\"RTN\",\"LRAPBR1\",285,0)\n S LRTEXT=$S('$D(LR(\"W\")):\"STANDARD FORM 515\",1:\"WORK COPY ONLY !!\")\n\"RTN\",\"LRAPBR1\",286,0)\n D GLENTRY(LRTEXT,50)\n\"RTN\",\"LRAPBR1\",287,0)\n D GLENTRY(\"ID:\"_SSN,\"\",1)\n\"RTN\",\"LRAPBR1\",288,0)\n D GLENTRY(\"SEX:\"_SEX,16),GLENTRY(\" DOB:\"_DOB,BTAB)\n\"RTN\",\"LRAPBR1\",289,0)\n I AGE D\n\"RTN\",\"LRAPBR1\",290,0)\n . S LRTEXT=$S($G(VADM(6))]\"\":\" AGE AT DEATH: \",1:\" AGE: \")_AGE\n\"RTN\",\"LRAPBR1\",291,0)\n . D GLENTRY(LRTEXT,BTAB)\n\"RTN\",\"LRAPBR1\",292,0)\n D GLENTRY(\" LOC:\"_LRLLOC,BTAB)\n\"RTN\",\"LRAPBR1\",293,0)\n D GLENTRY(\"\",\"\",1)\n\"RTN\",\"LRAPBR1\",294,0)\n I LRADM'=\"\" D GLENTRY(\"ADM:\"_$P(LRADM,\"@\"),BTAB)\n\"RTN\",\"LRAPBR1\",295,0)\n I LRADX'=\"\" D GLENTRY(\"DX:\"_$E(LRADX,1,26),17)\n\"RTN\",\"LRAPBR1\",296,0)\n D GLENTRY(\"PCP:\",46)\n\"RTN\",\"LRAPBR1\",297,0)\n I LRPRAC'=\"\" D GLENTRY($E(LRPRAC(1),1,28),51)\n\"RTN\",\"LRAPBR1\",298,0)\n Q\n\"RTN\",\"LRAPBR1\",299,0)\n ;\n\"RTN\",\"LRAPBR1\",300,0)\n ;\n\"RTN\",\"LRAPBR1\",301,0)\nESIGLN ; Write signature block name, title, and date of signature\n\"RTN\",\"LRAPBR1\",302,0)\n D GLENTRY(,,1)\n\"RTN\",\"LRAPBR1\",303,0)\n I $D(^VA(200,DUZ,0)) D\n\"RTN\",\"LRAPBR1\",304,0)\n . S LRFILE=200,LRFLD=20.2,LRFLD2=20.3\n\"RTN\",\"LRAPBR1\",305,0)\n . S X=$$GET1^DIQ(LRFILE,DUZ,LRFLD)\n\"RTN\",\"LRAPBR1\",306,0)\n ; Compare DUZ to pathologist, if different, use proxy signature\n\"RTN\",\"LRAPBR1\",307,0)\n S:LRSS=\"AU\" LRPATH=$$GET1^DIQ(63,LRDFN,13.6,\"I\")\n\"RTN\",\"LRAPBR1\",308,0)\n I LRSS'=\"AU\" D\n\"RTN\",\"LRAPBR1\",309,0)\n . S LRFL2=$S(LRSS=\"EM\":63.02,LRSS=\"CY\":63.09,LRSS=\"SP\":63.08,1:0)\n\"RTN\",\"LRAPBR1\",310,0)\n . S LRIENS=LRI_\",\"_LRDFN_\",\"\n\"RTN\",\"LRAPBR1\",311,0)\n . S LRPATH=$$GET1^DIQ(LRFL2,LRIENS,.02,\"I\")\n\"RTN\",\"LRAPBR1\",312,0)\n S LRPATH2=\"\"\n\"RTN\",\"LRAPBR1\",313,0)\n S:LRPATH'=DUZ LRPATH2=\" FOR \"_$$GET1^DIQ(LRFILE,LRPATH,LRFLD)\n\"RTN\",\"LRAPBR1\",314,0)\n S LRTEXT=\"/es/ \"_X_LRPATH2\n\"RTN\",\"LRAPBR1\",315,0)\n ; S LRTEXT=\"/es/ \"_X\n\"RTN\",\"LRAPBR1\",316,0)\n D GLENTRY(LRTEXT,,1)\n\"RTN\",\"LRAPBR1\",317,0)\n S LRTEXT=$$GET1^DIQ(LRFILE,DUZ,LRFLD2)\n\"RTN\",\"LRAPBR1\",318,0)\n D GLENTRY(LRTEXT,,1)\n\"RTN\",\"LRAPBR1\",319,0)\n S LRTEXT=\"Signed \"_$$FMTE^XLFDT(LRNTIME,\"1MZ\")\n\"RTN\",\"LRAPBR1\",320,0)\n D GLENTRY(LRTEXT,,1)\n\"RTN\",\"LRAPBR1\",321,0)\n Q\n\"RTN\",\"LRAPBR1\",322,0)\n ;\n\"RTN\",\"LRAPBR1\",323,0)\n ;\n\"RTN\",\"LRAPBR1\",324,0)\nDASH ; Display a line of dashes\n\"RTN\",\"LRAPBR1\",325,0)\n D GLENTRY(LR(\"%\"),\"\",1)\n\"RTN\",\"LRAPBR1\",326,0)\n Q\n\"RTN\",\"LRAPBR1\",327,0)\n ;\n\"RTN\",\"LRAPBR1\",328,0)\n ;\n\"RTN\",\"LRAPBR1\",329,0)\nGLENTRY(LRPR1,LRPR2,LRPR3) ; Write to global\n\"RTN\",\"LRAPBR1\",330,0)\n ; LRPR1 = Text to be written to global\n\"RTN\",\"LRAPBR1\",331,0)\n ; LRPR2 = Tab position\n\"RTN\",\"LRAPBR1\",332,0)\n ; LRPR3 = 1 means start a new line.  Otherwise, write an current line.\n\"RTN\",\"LRAPBR1\",333,0)\n S LRPR1=$G(LRPR1)\n\"RTN\",\"LRAPBR1\",334,0)\n S LRPR2=+$G(LRPR2)\n\"RTN\",\"LRAPBR1\",335,0)\n S LRPR3=+$G(LRPR3)\n\"RTN\",\"LRAPBR1\",336,0)\n D:LRPR3 NEWLN^LRAPUTL(LRPR1,LRPR2)\n\"RTN\",\"LRAPBR1\",337,0)\n D:'LRPR3 GLBWRT^LRAPUTL(LRPR1,LRPR2)\n\"RTN\",\"LRAPBR1\",338,0)\n Q\n\"RTN\",\"LRAPBR1\",339,0)\n ;\n\"RTN\",\"LRAPBR1\",340,0)\n ;\n\"RTN\",\"LRAPBR1\",341,0)\nTEXT1 ;Text for top of report\n\"RTN\",\"LRAPBR1\",342,0)\n ;;BRIEF CLINICAL HISTORY:\n\"RTN\",\"LRAPBR1\",343,0)\n ;;PREOPERATIVE DIAGNOSIS:\n\"RTN\",\"LRAPBR1\",344,0)\n ;;OPERATIVE FINDINGS:\n\"RTN\",\"LRAPBR1\",345,0)\n ;;POSTOPERATIVE DIAGNOSIS:\n\"RTN\",\"LRAPBR1\",346,0)\n ;\n\"RTN\",\"LRAPBR1\",347,0)\nTEXT2 ;Descriptive text based on section\n\"RTN\",\"LRAPBR1\",348,0)\n ;;SP;Pathology Resident:\n\"RTN\",\"LRAPBR1\",349,0)\n ;;CY;Screened by:\n\"RTN\",\"LRAPBR1\",350,0)\n ;;EM;Prepared by:\n\"RTN\",\"LRAPBR1\",351,0)\n ;\n\"RTN\",\"LRAPBR1\",352,0)\nFIELDS ;Field numbers for word processing fields\n\"RTN\",\"LRAPBR1\",353,0)\n ;;1.3;.13;6\n\"RTN\",\"LRAPBR1\",354,0)\n ;;1;.03;7\n\"RTN\",\"LRAPBR1\",355,0)\n ;;1.1;.04;4\n\"RTN\",\"LRAPBR1\",356,0)\n ;;1.4;.14;5\n\"RTN\",\"LRAPBR1\",357,0)\n ;\n\"RTN\",\"LRAPBR1\",358,0)\nTEXTCHK ; update text line counter if it is missing (Remedy 116253)\n\"RTN\",\"LRAPBR1\",359,0)\n N I,X,DATA\n\"RTN\",\"LRAPBR1\",360,0)\n S I=0\n\"RTN\",\"LRAPBR1\",361,0)\n K ^TMP(\"WP\",$J)\n\"RTN\",\"LRAPBR1\",362,0)\n S X=$G(^LR(LRDFN,LRSS,LRI,LRV,0))\n\"RTN\",\"LRAPBR1\",363,0)\n I X'=\"\",$L(X,\"^\")=1 D\n\"RTN\",\"LRAPBR1\",364,0)\n . F  S I=$O(^LR(LRDFN,LRSS,LRI,LRV,I)) Q:I=\"\"  D\n\"RTN\",\"LRAPBR1\",365,0)\n . . S DATA=$G(^LR(LRDFN,LRSS,LRI,LRV,I,0))\n\"RTN\",\"LRAPBR1\",366,0)\n . . S ^TMP(\"WP\",$J,I,0)=DATA\n\"RTN\",\"LRAPBR1\",367,0)\n I $D(^TMP(\"WP\",$J)) D\n\"RTN\",\"LRAPBR1\",368,0)\n . D WP^DIE(63.08,LRI_\",\"_LRDFN_\",\",LRV,\"\",\"^TMP(\"\"WP\"\",$J)\")\n\"RTN\",\"LRAPBR1\",369,0)\n . K ^TMP(\"WP\",$J)\n\"RTN\",\"LRAPBR1\",370,0)\n Q\n\"RTN\",\"LRAPBR1\",371,0)\n ;\n\"RTN\",\"LRAPBR1\",372,0)\n ;\n\"RTN\",\"LRAPBR1\",373,0)\nATTEND(LRMD) ; Retrieve surgeon/attending\n\"RTN\",\"LRAPBR1\",374,0)\n ; Call with LRMD = current ordering provider array, pass by reference\n\"RTN\",\"LRAPBR1\",375,0)\n ;\n\"RTN\",\"LRAPBR1\",376,0)\n ; Update ordering provider/surgeon if Surgery package indicates change\n\"RTN\",\"LRAPBR1\",377,0)\n ;\n\"RTN\",\"LRAPBR1\",378,0)\n N LRIENS,LRX\n\"RTN\",\"LRAPBR1\",379,0)\n S LRIENS=LRDFN_\",\"_LRSS_\",\"_LRI_\",0\",(LRMD(\"SR-ATTEND\"),LRMD(\"SR-SURGEON\"))=\"\"\n\"RTN\",\"LRAPBR1\",380,0)\n S LRX=$O(^LR(LRDFN,\"EPR\",\"AD\",LRIENS,1,0))\n\"RTN\",\"LRAPBR1\",381,0)\n I LRX<1 Q\n\"RTN\",\"LRAPBR1\",382,0)\n ;\n\"RTN\",\"LRAPBR1\",383,0)\n N LRDATA,LRJ,LRORDP,LRREF,LRSRDATA,LRSRTN\n\"RTN\",\"LRAPBR1\",384,0)\n S LRREF=LRX_\",\"_LRDFN_\",\"\n\"RTN\",\"LRAPBR1\",385,0)\n D GETDATA^LRUEPR(.LRDATA,LRREF)\n\"RTN\",\"LRAPBR1\",386,0)\n S LRSRTN=LRDATA(63.00013,LRREF,1,\"I\")\n\"RTN\",\"LRAPBR1\",387,0)\n ;\n\"RTN\",\"LRAPBR1\",388,0)\n I $P(LRSRTN,\";\",2)'=\"SRF(\" Q\n\"RTN\",\"LRAPBR1\",389,0)\n ;\n\"RTN\",\"LRAPBR1\",390,0)\n S LRORDP=+$P(^LR(LRDFN,LRSS,LRI,0),\"^\",7) ; Retrieve current surgeon/provider from file #63\n\"RTN\",\"LRAPBR1\",391,0)\n D SRCASE^LRUEPR(.LRSRDATA,+LRSRTN)\n\"RTN\",\"LRAPBR1\",392,0)\n ;\n\"RTN\",\"LRAPBR1\",393,0)\n I $G(LRSRDATA(\"ERR\")) D  Q\n\"RTN\",\"LRAPBR1\",394,0)\n . S LRMD(\"ERR\")=LRSRDATA(\"ERR\")\n\"RTN\",\"LRAPBR1\",395,0)\n . D SRCASERR^LRUEPR(LRREF,LRSRTN,LRSRDATA(\"ERR\"))\n\"RTN\",\"LRAPBR1\",396,0)\n ;\n\"RTN\",\"LRAPBR1\",397,0)\n F LRJ=.14,123 D\n\"RTN\",\"LRAPBR1\",398,0)\n . S LRX=LRSRDATA(130,+LRSRTN_\",\",LRJ,\"I\")\n\"RTN\",\"LRAPBR1\",399,0)\n . I LRX,LRORDP,LRX'=LRORDP S LRMD(\"SR-SURGEON\")=$S(LRJ=.14:\" Current Surgeon\",LRJ=123:\"Current Provider\",1:\"\")_\": \"_$$NAME^XUSER(LRX,\"G\")\n\"RTN\",\"LRAPBR1\",400,0)\n F LRJ=.164,124 D\n\"RTN\",\"LRAPBR1\",401,0)\n . S LRX=LRSRDATA(130,+LRSRTN_\",\",LRJ,\"I\")\n\"RTN\",\"LRAPBR1\",402,0)\n . I LRX S LRMD(\"SR-ATTEND\")=$S(LRJ=.164:\" Attending Surgeon\",LRJ=124:\"Attending Provider\",1:\"\")_\": \"_$$NAME^XUSER(LRX,\"G\")\n\"RTN\",\"LRAPBR1\",403,0)\n ;\n\"RTN\",\"LRAPBR1\",404,0)\n Q\n\"RTN\",\"LRAPCUM\")\n0^4^B26379480\n\"RTN\",\"LRAPCUM\",1,0)\nLRAPCUM ;DALOI/STAFF - AP PATIENT CUM ;03/21/13  15:28\n\"RTN\",\"LRAPCUM\",2,0)\n ;;5.2;LAB SERVICE;**34,72,173,248,259,350,427**;Sep 27, 1994;Build 6\n\"RTN\",\"LRAPCUM\",3,0)\n ;\n\"RTN\",\"LRAPCUM\",4,0)\n ;\n\"RTN\",\"LRAPCUM\",5,0)\n S IOP=\"HOME\" D ^%ZIS,L^LRU\n\"RTN\",\"LRAPCUM\",6,0)\n W !!?15,LRAA(1),\" PATIENT REPORT(S) DISPLAY\"\n\"RTN\",\"LRAPCUM\",7,0)\nP W ! S LR(\"Q\")=0 K DIC D ^LRDPA Q:LRDFN=-1  D R G P\n\"RTN\",\"LRAPCUM\",8,0)\n ;\n\"RTN\",\"LRAPCUM\",9,0)\nR W !!,\"Is this the patient \" S %=1 D YN^LRU Q:%'=1\n\"RTN\",\"LRAPCUM\",10,0)\n I '$D(^LR(LRDFN,LRSS)) W $C(7),!!,\"No \",LRAA(1),\" reports on file\",! Q\n\"RTN\",\"LRAPCUM\",11,0)\n D S F LRI=0:0 W @IOF S LRA(1)=21,LRI=$O(^LR(LRDFN,LRSS,LRI)) Q:'LRI  S B=$G(^(LRI,0)) I B D W Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",12,0)\n Q\n\"RTN\",\"LRAPCUM\",13,0)\nC S C=0 F LRZ=0:1 S C=$O(^LR(LRDFN,LRSS,LRI,LRV,C)) Q:'C  D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P  W !?2,$P(^LR(LRDFN,LRSS,LRI,LRV,C,0),U)\n\"RTN\",\"LRAPCUM\",14,0)\n Q\n\"RTN\",\"LRAPCUM\",15,0)\nF D E\n\"RTN\",\"LRAPCUM\",16,0)\n K ^UTILITY($J,\"W\")\n\"RTN\",\"LRAPCUM\",17,0)\n S C=0 F LRZ=0:1 S C=$O(^LR(LRDFN,LRSS,LRI,LRV,C)) Q:'C!(LRA(2)?1P)  D\n\"RTN\",\"LRAPCUM\",18,0)\n .D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",19,0)\n .S X=^LR(LRDFN,LRSS,LRI,LRV,C,0),X=$P(X,U)\n\"RTN\",\"LRAPCUM\",20,0)\n .D ^DIWP\n\"RTN\",\"LRAPCUM\",21,0)\n Q:LRA(2)?1P  D:LRZ ^DIWW\n\"RTN\",\"LRAPCUM\",22,0)\n Q\n\"RTN\",\"LRAPCUM\",23,0)\n ;\n\"RTN\",\"LRAPCUM\",24,0)\n ;\n\"RTN\",\"LRAPCUM\",25,0)\nE K ^TMP($J) S DIWL=3,DIWR=IOM-3,DIWF=\"W\"\n\"RTN\",\"LRAPCUM\",26,0)\n Q\n\"RTN\",\"LRAPCUM\",27,0)\n ;\n\"RTN\",\"LRAPCUM\",28,0)\n ;\n\"RTN\",\"LRAPCUM\",29,0)\nW S Y=+B D D^LRU S LRW(1)=Y,Y=$P(B,\"^\",10) D D^LRU S LRW(10)=Y,Y=$P(B,\"^\",3) D D^LRU S LRW(3)=Y,X=$P(B,\"^\",2) D:X D^LRUA S LRW(2)=X,LRW(11)=$P(B,\"^\",11)\n\"RTN\",\"LRAPCUM\",30,0)\n S X=$P(B,\"^\",4) D:X D^LRUA S LRW(4)=X,X=$P(B,\"^\",7) D:X D^LRUA S LRW(7)=X\n\"RTN\",\"LRAPCUM\",31,0)\n ;\n\"RTN\",\"LRAPCUM\",32,0)\n        ;EHS/OSS ;UJO*3.0*28 ; JUN 17,2025 ;Update[Edit Incorrect Field Label Displayed as \"Resident\" Instead of \"Pathology Resident\"]\n\"RTN\",\"LRAPCUM\",33,0)\n        ; Scope  : Convert \"Resident\" Label To \"Pathology Resident\" On LRAPSPCUM And LRAPPA Options\n\"RTN\",\"LRAPCUM\",34,0)\n        ;W !,\"Date Spec taken: \",LRW(1),?38,\"Pathologist:\",LRW(2),!,\"Date Spec rec'd: \",LRW(10),?38,$S(LRSS=\"SP\":\"Resident: \",31:\"Tech: \"),LRW(4)\n\"RTN\",\"LRAPCUM\",35,0)\n WRITE !,\"Date Spec taken: \",LRW(1),?38,\"Pathologist:\",LRW(2),!,\"Date Spec rec'd: \",LRW(10),?38,$SELECT(LRSS=\"SP\":\"Pathology Resident: \",1:\"Tech: \"),LRW(4)\n\"RTN\",\"LRAPCUM\",36,0)\n W !,$S($L(LRW(3)):\"Date  completed: \",1:\"REPORT INCOMPLETE\"),LRW(3),?38,\"Accession #: \",$P(B,\"^\",6),!,\"Submitted by: \",$P(B,\"^\",5),?38,\"Practitioner:\",LRW(7),!,LR(\"%\")\n\"RTN\",\"LRAPCUM\",37,0)\n I LRW(11)=\"\" D A W !,$C(7),\"Report not verified\",! G MORE\n\"RTN\",\"LRAPCUM\",38,0)\n I $D(^LR(LRDFN,LRSS,LRI,.1)) W !,\"Specimen: \" S LRV=.1 D C Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",39,0)\n I $D(^LR(LRDFN,LRSS,LRI,.2)) W !,\"Brief Clinical History:\" S LRV=.2 D F Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",40,0)\n I $D(^LR(LRDFN,LRSS,LRI,.3)) W !,\"Preoperative Diagnosis:\" S LRV=.3 D F Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",41,0)\n I $D(^LR(LRDFN,LRSS,LRI,.4)) W !,\"Operative Findings:\" S LRV=.4 D F Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",42,0)\n I $D(^LR(LRDFN,LRSS,LRI,.5)) W !,\"Postoperative Diagnosis:\" S LRV=.5 D F Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",43,0)\n D SET^LRUA\n\"RTN\",\"LRAPCUM\",44,0)\n I $O(^LR(LRDFN,LRSS,LRI,1.3,0)) D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P  W !,LR(69.2,.13) I $P($G(^LR(LRDFN,LRSS,LRI,6,0)),U,4) S LR(0)=6 D ^LRSPRPTM\n\"RTN\",\"LRAPCUM\",45,0)\n S LRV=1.3 D F Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",46,0)\n I $O(^LR(LRDFN,LRSS,LRI,1,0)) D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P  W !,LR(69.2,.03) I $P($G(^LR(LRDFN,LRSS,LRI,7,0)),U,4) S LR(0)=7 D ^LRSPRPTM\n\"RTN\",\"LRAPCUM\",47,0)\n S LRV=1 D F Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",48,0)\n I $O(^LR(LRDFN,LRSS,LRI,1.1,0)) D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P  W !,LR(69.2,.04),\" (Date Spec taken: \",LRW(1),\")\" I $P($G(^LR(LRDFN,LRSS,LRI,4,0)),U,4) S LR(0)=4 D ^LRSPRPTM\n\"RTN\",\"LRAPCUM\",49,0)\n S LRV=1.1 D F Q:LRA(2)?1P  I $O(^LR(LRDFN,LRSS,LRI,1.4,0)) D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P  W !,LR(69.2,.14) I $P($G(^LR(LRDFN,LRSS,LRI,5,0)),U,4) S LR(0)=5 D ^LRSPRPTM\n\"RTN\",\"LRAPCUM\",50,0)\n S LRV=1.4 D F Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",51,0)\n I $O(^LR(LRDFN,LRSS,LRI,1.2,0)) D\n\"RTN\",\"LRAPCUM\",52,0)\n .W !,\"Supplementary Report:\"\n\"RTN\",\"LRAPCUM\",53,0)\n .F C=0:0 S C=$O(^LR(LRDFN,LRSS,LRI,1.2,C)) Q:'C!(LRA(2)?1P)  D\n\"RTN\",\"LRAPCUM\",54,0)\n ..S X=^(C,0),Y=+X,X=$P(X,U,2) D D^LRU\n\"RTN\",\"LRAPCUM\",55,0)\n ..W !?3,\"Date: \",Y W:'X \" not verified\"\n\"RTN\",\"LRAPCUM\",56,0)\n ..D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",57,0)\n ..I X,$P($G(^LR(LRDFN,LRSS,LRI,1.2,C,2,0)),U,4) D\n\"RTN\",\"LRAPCUM\",58,0)\n ...S LRV=C,LR(\"Q\")=LRA(2)\n\"RTN\",\"LRAPCUM\",59,0)\n ...D SUPA^LRSPRPT\n\"RTN\",\"LRAPCUM\",60,0)\n ...S LRA(2)=LR(\"Q\")\n\"RTN\",\"LRAPCUM\",61,0)\n ..D:X U Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",62,0)\n Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",63,0)\n ;\n\"RTN\",\"LRAPCUM\",64,0)\n ; User must possess the LRLAB key to view SNOMED codes\n\"RTN\",\"LRAPCUM\",65,0)\n I $D(^LR(LRDFN,LRSS,LRI,2)) D\n\"RTN\",\"LRAPCUM\",66,0)\n .D B\n\"RTN\",\"LRAPCUM\",67,0)\n .I $D(^XUSEC(\"LRLAB\",DUZ)) D ^LRAPCUM1\n\"RTN\",\"LRAPCUM\",68,0)\n Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",69,0)\n ; DALOI/LMT - LR,427 - Removed comments from report to restore pre-LR,350 behavior\n\"RTN\",\"LRAPCUM\",70,0)\n ;I $D(^LR(LRDFN,LRSS,LRI,99)) D\n\"RTN\",\"LRAPCUM\",71,0)\n ;. N A\n\"RTN\",\"LRAPCUM\",72,0)\n ;. W !,\"Comments:\" S A=0\n\"RTN\",\"LRAPCUM\",73,0)\n ;. F  S A=$O(^LR(LRDFN,LRSS,LRI,99,A)) Q:'A  W !,$P(^(A,0),\"^\")\n\"RTN\",\"LRAPCUM\",74,0)\n D MORE\n\"RTN\",\"LRAPCUM\",75,0)\n Q\n\"RTN\",\"LRAPCUM\",76,0)\n ;\n\"RTN\",\"LRAPCUM\",77,0)\n ;\n\"RTN\",\"LRAPCUM\",78,0)\nMORE R !,\"'^' TO STOP: \",LRA(2):DTIME I LRA(2)[\"?\" W $C(7) G MORE\n\"RTN\",\"LRAPCUM\",79,0)\n I LRA(2)?1P S A=0 Q\n\"RTN\",\"LRAPCUM\",80,0)\n S LRA(1)=LRA(1)+21\n\"RTN\",\"LRAPCUM\",81,0)\n W $C(13),$J(\"\",15),$C(13)\n\"RTN\",\"LRAPCUM\",82,0)\n Q\n\"RTN\",\"LRAPCUM\",83,0)\n ;\n\"RTN\",\"LRAPCUM\",84,0)\n ;\n\"RTN\",\"LRAPCUM\",85,0)\nS S (A,LRA(2))=0\n\"RTN\",\"LRAPCUM\",86,0)\n Q\n\"RTN\",\"LRAPCUM\",87,0)\n ;\n\"RTN\",\"LRAPCUM\",88,0)\n ;\n\"RTN\",\"LRAPCUM\",89,0)\nU D E\n\"RTN\",\"LRAPCUM\",90,0)\n K ^UTILITY($J,\"W\")\n\"RTN\",\"LRAPCUM\",91,0)\n S E=0\n\"RTN\",\"LRAPCUM\",92,0)\n F LRZ=0:1 S E=$O(^LR(LRDFN,LRSS,LRI,1.2,C,1,E)) Q:'E!(LRA(2)?1P)  D\n\"RTN\",\"LRAPCUM\",93,0)\n .D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",94,0)\n .S X=^LR(LRDFN,LRSS,LRI,1.2,C,1,E,0)\n\"RTN\",\"LRAPCUM\",95,0)\n .D ^DIWP\n\"RTN\",\"LRAPCUM\",96,0)\n Q:LRA(2)?1P  D:LRZ ^DIWW\n\"RTN\",\"LRAPCUM\",97,0)\n Q\n\"RTN\",\"LRAPCUM\",98,0)\n ;\n\"RTN\",\"LRAPCUM\",99,0)\n ;\n\"RTN\",\"LRAPCUM\",100,0)\nB F C=0:0 S C=$O(^LR(LRDFN,LRSS,LRI,2,C)) Q:'C!(LRA(2)?1P)  D SP\n\"RTN\",\"LRAPCUM\",101,0)\n Q\n\"RTN\",\"LRAPCUM\",102,0)\n ;\n\"RTN\",\"LRAPCUM\",103,0)\n ;\n\"RTN\",\"LRAPCUM\",104,0)\nSP F G=0:0 S G=$O(^LR(LRDFN,LRSS,LRI,2,C,5,G)) Q:'G  S X=^(G,0),Y=$P(X,\"^\",2),E=$P(X,\"^\",3),E(1)=$P(X,\"^\")_\":\",E(1)=$P($P(LR(LRSS),E(1),2),\";\") D D^LRU S T(2)=Y D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P  D WP\n\"RTN\",\"LRAPCUM\",105,0)\n Q\n\"RTN\",\"LRAPCUM\",106,0)\n ;\n\"RTN\",\"LRAPCUM\",107,0)\n ;\n\"RTN\",\"LRAPCUM\",108,0)\nWP W !,E(1),\" \",E,\" Date: \",T(2),\" \",!\n\"RTN\",\"LRAPCUM\",109,0)\n D E\n\"RTN\",\"LRAPCUM\",110,0)\n K ^UTILITY($J,\"W\")\n\"RTN\",\"LRAPCUM\",111,0)\n S F=0\n\"RTN\",\"LRAPCUM\",112,0)\n F LRZ=0:1 S F=$O(^LR(LRDFN,LRSS,LRI,2,C,5,G,1,F)) Q:'F!(LRA(2)?1P)  D\n\"RTN\",\"LRAPCUM\",113,0)\n .D:$Y>LRA(1)!'$Y MORE Q:LRA(2)?1P\n\"RTN\",\"LRAPCUM\",114,0)\n .S X=^LR(LRDFN,LRSS,LRI,2,C,5,G,1,F,0) D ^DIWP\n\"RTN\",\"LRAPCUM\",115,0)\n Q:LRA(2)?1P  D:LRZ ^DIWW\n\"RTN\",\"LRAPCUM\",116,0)\n Q\n\"RTN\",\"LRAPCUM\",117,0)\n ;\n\"RTN\",\"LRAPCUM\",118,0)\n ;\n\"RTN\",\"LRAPCUM\",119,0)\nA S A=0 F  S A=$O(^LR(LRDFN,LRSS,LRI,97,A)) Q:'A  W !,^(A,0)\n\"RTN\",\"LRAPCUM\",120,0)\n Q\n\"RTN\",\"LRAPD1\")\n0^2^B29057051\n\"RTN\",\"LRAPD1\",1,0)\nLRAPD1 ;AVAMC/REG/WTY/KLL - AP DATA ENTRY ;9/25/00\n\"RTN\",\"LRAPD1\",2,0)\n ;;5.2;LAB SERVICE;**41,91,248,259,317,350,422**;Sep 27, 1994;Build 6\n\"RTN\",\"LRAPD1\",3,0)\n ;\n\"RTN\",\"LRAPD1\",4,0)\n ;WTY;17-AUG-01;Unwrapped text and add kills for DR string\n\"RTN\",\"LRAPD1\",5,0)\n ;\n\"RTN\",\"LRAPD1\",6,0)\nSP ;Gross Desc/Clinical Hx, Surg Path\n\"RTN\",\"LRAPD1\",7,0)\n S LRSOP=\"G\"\n\"RTN\",\"LRAPD1\",8,0)\n K DR S DR=\".09///^S X=LRWHO;.012;.013;.014;.015;.016;\"\n\"RTN\",\"LRAPD1\",9,0)\n S DR=DR_\".021//^S X=LR(\"\"TR\"\");1;S:'LR(\"\"FS\"\") Y=0;1.3\"\n\"RTN\",\"LRAPD1\",10,0)\n S LR(6)=1,DR(2,63.812)=\".01;.06R;.07R\"\n\"RTN\",\"LRAPD1\",11,0)\n Q\n\"RTN\",\"LRAPD1\",12,0)\nMSP ;Micro Description/Gross Review, Surg Path\n\"RTN\",\"LRAPD1\",13,0)\n S LRSOP=\"M\"\n\"RTN\",\"LRAPD1\",14,0)\n K DR S DR=\".09///^S X=LRWHO;S:'LR(\"\"FS\"\") Y=1;1.3;1;1.1;\"\n\"RTN\",\"LRAPD1\",15,0)\n        ;EHS/OSS ;UJO*3.0*28 ; APR 30,2025 ;Update[Add New Prompt \"RESIDENT PATHOLOGIST\" For Surgical Pathology Accession Areas]\n\"RTN\",\"LRAPD1\",16,0)\n        ; Scope  : Add \"RESIDENT PATHOLOGIST\" Prompt to FS/Gross/Micro/Dx \"LRAPDGM\" Option\n\"RTN\",\"LRAPD1\",17,0)\n        ;S DR=DR_\"S:'LR(\"\"DX\"\") Y=.02;1.4;.02;.03;S:'LRV Y=0;.14\"\n\"RTN\",\"LRAPD1\",18,0)\n        SET DR=DR_\"S:'LR(\"\"DX\"\") Y=.02;1.4;.021;.02;.03;S:'LRV Y=0;.14\"\n\"RTN\",\"LRAPD1\",19,0)\n S (LR(7),LR(6))=1\n\"RTN\",\"LRAPD1\",20,0)\n Q\n\"RTN\",\"LRAPD1\",21,0)\nBSP ;Micro Description/Snomed Coding\n\"RTN\",\"LRAPD1\",22,0)\n S LRSOP=\"B\",(LR(2),LR(7),LR(6))=1\n\"RTN\",\"LRAPD1\",23,0)\n K DR S DR=\".09///^S X=LRWHO;S:'LR(\"\"FS\"\") Y=1;1.3;1;1.1;\"\n\"RTN\",\"LRAPD1\",24,0)\n        ;EHS/OSS ;UJO*3.0*28 ; APR 30,2025 ;Update[Add New Prompt \"RESIDENT PATHOLOGIST\" For Surgical Pathology Accession Areas]\n\"RTN\",\"LRAPD1\",25,0)\n        ; Scope  : Add \"RESIDENT PATHOLOGIST\" Prompt to FS/Gross/Micro/Dx/SNOMED Coding \"LRAPDGS\" Option\n\"RTN\",\"LRAPD1\",26,0)\n        ;S DR=DR_\"S:'LR(\"\"DX\"\") Y=.02;1.4;.02;.03;S:'LRV Y=10;.14;10\"\n\"RTN\",\"LRAPD1\",27,0)\n SET DR=DR_\"S:'LR(\"\"DX\"\") Y=.02;1.4;.021;.02;.03;S:'LRV Y=10;.14;10\"\n\"RTN\",\"LRAPD1\",28,0)\n S DR(2,63.12)=\".01;D T^LRAPD;S:'LR(8) Y=4;2;4;I '$D(LR(1)) S Y=0;\"\n\"RTN\",\"LRAPD1\",29,0)\n S DR(2,63.12)=DR(2,63.12)_\"1;1.5;3\"\n\"RTN\",\"LRAPD1\",30,0)\n S DR(3,63.16)=\".01;I '$D(LR(1)) S Y=0;1\"\n\"RTN\",\"LRAPD1\",31,0)\n S DR(3,63.82)=\".01;D R^LRAPD;.02\"\n\"RTN\",\"LRAPD1\",32,0)\n Q\n\"RTN\",\"LRAPD1\",33,0)\nASP ;Micro Description/ICDCM Coding\n\"RTN\",\"LRAPD1\",34,0)\n S LRSOP=\"A\",(LR(7),LR(6))=1\n\"RTN\",\"LRAPD1\",35,0)\n K DR S DR=\".09///^S X=LRWHO;S:'LR(\"\"FS\"\") Y=1;1.3;1;1.1;\"\n\"RTN\",\"LRAPD1\",36,0)\n S DR=DR_\"S:'LR(\"\"DX\"\") Y=.02;1.4;.02;.03;D F80^LRAPD1;.14;@1;\"_$S($G(LRCDSYS)=30:\"D EN^LRAPICD(LRDXV)\",1:80)\n\"RTN\",\"LRAPD1\",37,0)\n Q\n\"RTN\",\"LRAPD1\",38,0)\nF80 ;\n\"RTN\",\"LRAPD1\",39,0)\n I 'LRV S Y=\"@1\"\n\"RTN\",\"LRAPD1\",40,0)\n Q\n\"RTN\",\"LRAPD1\",41,0)\nSSP ;Supplementary Report, Surg Path\n\"RTN\",\"LRAPD1\",42,0)\n S (LRSOP,LRSFLG)=\"S\",(LR(2),LR(7),LR(6))=1\n\"RTN\",\"LRAPD1\",43,0)\n K DR\n\"RTN\",\"LRAPD1\",44,0)\n ;Entry of Supp rept must be allowed on released reports\n\"RTN\",\"LRAPD1\",45,0)\n ;S DR=\"N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS,LRI) \"\n\"RTN\",\"LRAPD1\",46,0)\n ;S DR=DR_\"I LRREL(1) D VMSG^LRAPD1 S LRSFLG=\"\"\"\",Y=0;\"\n\"RTN\",\"LRAPD1\",47,0)\n ;S DR=DR_\".09///^S X=LRWHO;.03;10\"\n\"RTN\",\"LRAPD1\",48,0)\n S DR=\".09///^S X=LRWHO;.03;10\"\n\"RTN\",\"LRAPD1\",49,0)\n S DR(2,63.12)=\".01;D T^LRAPD;S:'LR(8) Y=4;2;4;I '$D(LR(1)) \"\n\"RTN\",\"LRAPD1\",50,0)\n S DR(2,63.12)=DR(2,63.12)_\"S Y=0;1;1.5;3\"\n\"RTN\",\"LRAPD1\",51,0)\n S DR(3,63.16)=\".01;I '$D(LR(1)) S Y=0;1\"\n\"RTN\",\"LRAPD1\",52,0)\n S DR(3,63.82)=\".01;D R^LRAPD;.02\"\n\"RTN\",\"LRAPD1\",53,0)\n Q\n\"RTN\",\"LRAPD1\",54,0)\nPSP ;Special Studies, Surg Path\n\"RTN\",\"LRAPD1\",55,0)\n S LRSOP=\"P\"\n\"RTN\",\"LRAPD1\",56,0)\n K DR\n\"RTN\",\"LRAPD1\",57,0)\n S DR=\"N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS,LRI) \"\n\"RTN\",\"LRAPD1\",58,0)\n S DR=DR_\"I LRREL(1) D VMSG^LRAPD1 S Y=0;.03;10\"\n\"RTN\",\"LRAPD1\",59,0)\n S DR(2,63.12)=\"5;1.5\"\n\"RTN\",\"LRAPD1\",60,0)\n S DR(3,63.82)=\".01;D R^LRAPD;.02\",LR(7)=1\n\"RTN\",\"LRAPD1\",61,0)\n Q\n\"RTN\",\"LRAPD1\",62,0)\nCY ;Gross Desc/Clinic Hx, Cytopath\n\"RTN\",\"LRAPD1\",63,0)\n S LRSOP=\"G\"\n\"RTN\",\"LRAPD1\",64,0)\n K DR S DR=\".09///^S X=LRWHO;.012;.013;.014;.015;.016;\"\n\"RTN\",\"LRAPD1\",65,0)\n S DR=DR_\".021//^S X=LR(\"\"TR\"\");1\"\n\"RTN\",\"LRAPD1\",66,0)\n S LR(6)=1,DR(2,63.902)=\".01;.02;.06R;.07R\"\n\"RTN\",\"LRAPD1\",67,0)\n Q\n\"RTN\",\"LRAPD1\",68,0)\nMCY ;Micro Desc/Gross Review, Cytopath\n\"RTN\",\"LRAPD1\",69,0)\n S LRSOP=\"M\"\n\"RTN\",\"LRAPD1\",70,0)\n K DR S DR=\".09///^S X=LRWHO;1;1.1;S:'LR(\"\"DX\"\") Y=.021;1.4;\"\n\"RTN\",\"LRAPD1\",71,0)\n S DR=DR_\".021//^S X=LR(\"\"TR\"\");.02;.03;.101;S:'LRV Y=0;.14\"\n\"RTN\",\"LRAPD1\",72,0)\n S (LR(7),LR(6))=1\n\"RTN\",\"LRAPD1\",73,0)\n Q\n\"RTN\",\"LRAPD1\",74,0)\nBCY ;Micro Desc/SNOMED Coding, Cytopath\n\"RTN\",\"LRAPD1\",75,0)\n S LRSOP=\"B\",DIC(0)=\"M\"\n\"RTN\",\"LRAPD1\",76,0)\n S (LR(2),LR(7),LR(6))=1\n\"RTN\",\"LRAPD1\",77,0)\n K DR S DR=\".09///^S X=LRWHO;1;1.1;S:'LR(\"\"DX\"\") Y=.021;1.4;\"\n\"RTN\",\"LRAPD1\",78,0)\n S DR=DR_\".021//^S X=LR(\"\"TR\"\");.02;.03;.101;S:'LRV Y=10;.14;10\"\n\"RTN\",\"LRAPD1\",79,0)\n S DR(2,63.912)=\".01;D T^LRAPD;S:'LR(8) Y=4;2;4;\"\n\"RTN\",\"LRAPD1\",80,0)\n S DR(2,63.912)=DR(2,63.912)_\"I '$D(LR(1)) S Y=0;1;1.5;3\"\n\"RTN\",\"LRAPD1\",81,0)\n S DR(3,63.916)=\".01;I '$D(LR(1)) S Y=0;1\"\n\"RTN\",\"LRAPD1\",82,0)\n S DR(3,63.982)=\".01;D R^LRAPD;.02\"\n\"RTN\",\"LRAPD1\",83,0)\n Q\n\"RTN\",\"LRAPD1\",84,0)\nACY ;Micro Desc/ICDCM Coding\n\"RTN\",\"LRAPD1\",85,0)\n S LRSOP=\"A\"\n\"RTN\",\"LRAPD1\",86,0)\n S (LR(7),LR(6))=1\n\"RTN\",\"LRAPD1\",87,0)\n K DR S DR=\".09///^S X=LRWHO;1;1.1;S:'LR(\"\"DX\"\") Y=.021;1.4;\"\n\"RTN\",\"LRAPD1\",88,0)\n S DR=DR_\".021//^S X=LR(\"\"TR\"\");.02;.03;.101;D F80^LRAPD1;.14;@1;\"_$S($G(LRCDSYS)=30:\"D EN^LRAPICD(LRDXV)\",1:80)\n\"RTN\",\"LRAPD1\",89,0)\n Q\n\"RTN\",\"LRAPD1\",90,0)\nSCY ;Supplementary Report, Cyto\n\"RTN\",\"LRAPD1\",91,0)\n S LRSFLG=\"S\"\n\"RTN\",\"LRAPD1\",92,0)\n S (LR(2),LR(7),LR(6))=1\n\"RTN\",\"LRAPD1\",93,0)\n K DR\n\"RTN\",\"LRAPD1\",94,0)\n ;Entry of Supp rept must be allowed on released reports\n\"RTN\",\"LRAPD1\",95,0)\n ;S DR=\"N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS,LRI) \"\n\"RTN\",\"LRAPD1\",96,0)\n ;S DR=DR_\"I LRREL(1) D VMSG^LRAPD1 S LRSFLG=\"\"\"\",Y=0;\"\n\"RTN\",\"LRAPD1\",97,0)\n ;S DR=DR_\".09///^S X=LRWHO;.03;10\"\n\"RTN\",\"LRAPD1\",98,0)\n S DR=\".09///^S X=LRWHO;.03;10\"\n\"RTN\",\"LRAPD1\",99,0)\n S DR(2,63.912)=\".01;D T^LRAPD;S:'LR(8) Y=4;2;4;I '$D(LR(1)) \"\n\"RTN\",\"LRAPD1\",100,0)\n S DR(2,63.912)=DR(2,63.912)_\"S Y=0;1;1.5;3\"\n\"RTN\",\"LRAPD1\",101,0)\n S DR(3,63.916)=\".01;I '$D(LR(1)) S Y=0;1\"\n\"RTN\",\"LRAPD1\",102,0)\n S DR(3,63.982)=\".01;D R^LRAPD;.02\"\n\"RTN\",\"LRAPD1\",103,0)\n Q\n\"RTN\",\"LRAPD1\",104,0)\nPCY ;Special Studies, Cyto\n\"RTN\",\"LRAPD1\",105,0)\n K DR\n\"RTN\",\"LRAPD1\",106,0)\n S DR=\"N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS,LRI) \"\n\"RTN\",\"LRAPD1\",107,0)\n S DR=DR_\"I LRREL(1) D VMSG^LRAPD1 S Y=0;.03;10\"\n\"RTN\",\"LRAPD1\",108,0)\n S DR(2,63.912)=\"5;1.5\"\n\"RTN\",\"LRAPD1\",109,0)\n S DR(3,63.982)=\".01;D R^LRAPD;.02\"\n\"RTN\",\"LRAPD1\",110,0)\n S LR(7)=1\n\"RTN\",\"LRAPD1\",111,0)\n Q\n\"RTN\",\"LRAPD1\",112,0)\nEM ;Gross Desc/Clinical Hx, Em\n\"RTN\",\"LRAPD1\",113,0)\n S LRSOP=\"G\",LR(6)=1\n\"RTN\",\"LRAPD1\",114,0)\n K DR S DR=\".09///^S X=LRWHO;.012;.013;.014;.015;.016;\"\n\"RTN\",\"LRAPD1\",115,0)\n S DR=DR_\".021//^S X=LR(\"\"TR\"\");1\"\n\"RTN\",\"LRAPD1\",116,0)\n S DR(2,63.202)=\".01;.06R;.07R\"\n\"RTN\",\"LRAPD1\",117,0)\n Q\n\"RTN\",\"LRAPD1\",118,0)\nMEM ;Micro Desc/Gross Review, EM\n\"RTN\",\"LRAPD1\",119,0)\n S LRSOP=\"M\"\n\"RTN\",\"LRAPD1\",120,0)\n K DR S DR=\".09///^S X=LRWHO;1;1.1;S:'LR(\"\"DX\"\") Y=.021;1.4;\"\n\"RTN\",\"LRAPD1\",121,0)\n S DR=DR_\".021//^S X=LR(\"\"TR\"\");.02;.03;S:'LRV Y=0;.14\"\n\"RTN\",\"LRAPD1\",122,0)\n S (LR(7),LR(6))=1\n\"RTN\",\"LRAPD1\",123,0)\n Q\n\"RTN\",\"LRAPD1\",124,0)\nBEM ;Micro Desc/SNOMED Coding\n\"RTN\",\"LRAPD1\",125,0)\n S LRSOP=\"B\",(LR(2),LR(7),LR(6))=1\n\"RTN\",\"LRAPD1\",126,0)\n K DR S DR=\".09///^S X=LRWHO;1;1.1;S:'LR(\"\"DX\"\") Y=.021;1.4;\"\n\"RTN\",\"LRAPD1\",127,0)\n S DR=DR_\".021//^S X=LR(\"\"TR\"\");.02;.03;S:'LRV Y=10;.14;10\"\n\"RTN\",\"LRAPD1\",128,0)\n S DR(2,63.212)=\".01;D T^LRAPD;S:'LR(8) Y=4;2;4;\"\n\"RTN\",\"LRAPD1\",129,0)\n S DR(2,63.212)=DR(2,63.212)_\"I '$D(LR(1)) S Y=0;1;1.5;3\"\n\"RTN\",\"LRAPD1\",130,0)\n S DR(3,63.216)=\".01;I '$D(LR(1)) S Y=0;1\"\n\"RTN\",\"LRAPD1\",131,0)\n S DR(3,63.282)=\".01;D R^LRAPD;.02\"\n\"RTN\",\"LRAPD1\",132,0)\n Q\n\"RTN\",\"LRAPD1\",133,0)\nAEM ;Micro Desc/ICDCM Coding\n\"RTN\",\"LRAPD1\",134,0)\n S LRSOP=\"A\"\n\"RTN\",\"LRAPD1\",135,0)\n S (LR(7),LR(6))=1\n\"RTN\",\"LRAPD1\",136,0)\n K DR S DR=\".09///^S X=LRWHO;1;1.1;S:'LR(\"\"DX\"\") Y=.021;1.4;\"\n\"RTN\",\"LRAPD1\",137,0)\n S DR=DR_\".021//^S X=LR(\"\"TR\"\");.02;.03;D F80^LRAPD1;.14;@1;\"_$S($G(LRCDSYS)=30:\"D EN^LRAPICD(LRDXV)\",1:80)\n\"RTN\",\"LRAPD1\",138,0)\n Q\n\"RTN\",\"LRAPD1\",139,0)\nSEM ;Supplementary Report, EM\n\"RTN\",\"LRAPD1\",140,0)\n S LRSFLG=\"S\"\n\"RTN\",\"LRAPD1\",141,0)\n S (LR(2),LR(7),LR(6))=1\n\"RTN\",\"LRAPD1\",142,0)\n K DR\n\"RTN\",\"LRAPD1\",143,0)\n ;Entry of Supp rept must be allowed on released reports\n\"RTN\",\"LRAPD1\",144,0)\n ;S DR=\"N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS,LRI) \"\n\"RTN\",\"LRAPD1\",145,0)\n ;S DR=DR_\"I LRREL(1) D VMSG^LRAPD1 S LRSFLG=\"\"\"\",Y=0;\"\n\"RTN\",\"LRAPD1\",146,0)\n ;S DR=DR_\".09///^S X=LRWHO;.03;10\"\n\"RTN\",\"LRAPD1\",147,0)\n S DR=\".09///^S X=LRWHO;.03;10\"\n\"RTN\",\"LRAPD1\",148,0)\n S DR(2,63.212)=\".01;D T^LRAPD;S:'LR(8) Y=4;2;4;I '$D(LR(1)) \"\n\"RTN\",\"LRAPD1\",149,0)\n S DR(2,63.212)=DR(2,63.212)_\"S Y=0;1;1.5;3\"\n\"RTN\",\"LRAPD1\",150,0)\n S DR(3,63.216)=\".01;I '$D(LR(1)) S Y=0;1\"\n\"RTN\",\"LRAPD1\",151,0)\n S DR(3,63.282)=\".01;D R^LRAPD;.02\"\n\"RTN\",\"LRAPD1\",152,0)\n Q\n\"RTN\",\"LRAPD1\",153,0)\nPEM ;Special Studies, EM\n\"RTN\",\"LRAPD1\",154,0)\n K DR\n\"RTN\",\"LRAPD1\",155,0)\n S DR=\"N LRREL D RELEASE^LRAPUTL(.LRREL,LRDFN,LRSS,LRI) \"\n\"RTN\",\"LRAPD1\",156,0)\n S DR=DR_\"I LRREL(1) D VMSG^LRAPD1 S Y=0;.03;10\"\n\"RTN\",\"LRAPD1\",157,0)\n S DR(2,63.212)=5,LR(7)=1\n\"RTN\",\"LRAPD1\",158,0)\n Q\n\"RTN\",\"LRAPD1\",159,0)\nVMSG ;Verified message\n\"RTN\",\"LRAPD1\",160,0)\n N LRMSG\n\"RTN\",\"LRAPD1\",161,0)\n S LRMSG=$C(7)_\"Report verified.  Cannot edit with this option.\"\n\"RTN\",\"LRAPD1\",162,0)\n D EN^DDIOL(LRMSG,\"\",\"!!\")\n\"RTN\",\"LRAPD1\",163,0)\n Q\n\"RTN\",\"LRSPRPTA\")\n0^3^B18457484\n\"RTN\",\"LRSPRPTA\",1,0)\nLRSPRPTA ;DALOI/STAFF - CY/EM/SP PATIENT RPT (cont'd) ;03/21/13  15:29\n\"RTN\",\"LRSPRPTA\",2,0)\n ;;5.2;LAB SERVICE;**350,427**;Sep 27, 1994;Build 6\n\"RTN\",\"LRSPRPTA\",3,0)\n ;\n\"RTN\",\"LRSPRPTA\",4,0)\n ; Continuation of LRSPRPT.\n\"RTN\",\"LRSPRPTA\",5,0)\n ;\n\"RTN\",\"LRSPRPTA\",6,0)\nEN ; from LRSPRPT\n\"RTN\",\"LRSPRPTA\",7,0)\n ; Suppress SNOMED codes except on Preliminary\n\"RTN\",\"LRSPRPTA\",8,0)\n S LR(\"SPSM\")=$S($G(LRPRE):0,1:1)\n\"RTN\",\"LRSPRPTA\",9,0)\n S LR(.21)=+$G(^LRO(69.2,+$G(LRAA),.2))\n\"RTN\",\"LRSPRPTA\",10,0)\n K LRO Q:'$D(^LR(LRDFN,LRSS,LRI,0))\n\"RTN\",\"LRSPRPTA\",11,0)\n S LRQ=0\n\"RTN\",\"LRSPRPTA\",12,0)\n D ^LRUA\n\"RTN\",\"LRSPRPTA\",13,0)\n ;\n\"RTN\",\"LRSPRPTA\",14,0)\n D GETPCP^LRAPUTL(.LRPRAC,LRDFN,LRSS,LRI)\n\"RTN\",\"LRSPRPTA\",15,0)\n ;\n\"RTN\",\"LRSPRPTA\",16,0)\n D ^LRAPF Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",17,0)\n S LR(\"F\")=1 W !,\"Submitted by: \",LRW(5),?44,\"Date obtained: \",LRTK\n\"RTN\",\"LRSPRPTA\",18,0)\n D:LRA W^LRSPRPT\n\"RTN\",\"LRSPRPTA\",19,0)\n W !,\"Specimen (Received \",LRTK(1),\"):\" S LRV=.1 D A^LRSPRPT Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",20,0)\n I $P($G(^LR(LRDFN,LRSS,LRI,1.2,0)),\"^\",4) D\n\"RTN\",\"LRSPRPTA\",21,0)\n . W !?14,\"*+* SUPPLEMENTARY REPORT HAS BEEN ADDED *+*\"\n\"RTN\",\"LRSPRPTA\",22,0)\n . W !?19,\"*+* REFER TO BOTTOM OF REPORT *+*\",!\n\"RTN\",\"LRSPRPTA\",23,0)\n ;\n\"RTN\",\"LRSPRPTA\",24,0)\n ; DALOI/LMT - LR,427 - Removed comments from report to restore pre-LR,350 behavior\n\"RTN\",\"LRSPRPTA\",25,0)\n ;I $O(^LR(LRDFN,LRSS,LRI,99,0)) W !,\"Comment:\"\n\"RTN\",\"LRSPRPTA\",26,0)\n ;S LRB=0\n\"RTN\",\"LRSPRPTA\",27,0)\n ;F  S LRB=$O(^LR(LRDFN,LRSS,LRI,99,LRB)) Q:'LRB!(LR(\"Q\"))  D\n\"RTN\",\"LRSPRPTA\",28,0)\n ;. W !,^LR(LRDFN,LRSS,LRI,99,LRB,0)\n\"RTN\",\"LRSPRPTA\",29,0)\n ;. I $G(LRSF515),$Y>(IOSL-11) D F^LRAPF,^LRAPF\n\"RTN\",\"LRSPRPTA\",30,0)\n ;\n\"RTN\",\"LRSPRPTA\",31,0)\n D:LRA W^LRSPRPT W !,\"Brief Clinical History:\" S LRV=.2 D F^LRSPRPT Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",32,0)\n D:LRA W^LRSPRPT W !,\"Preoperative Diagnosis:\" S LRV=.3 D F^LRSPRPT Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",33,0)\n D:LRA W^LRSPRPT W !,\"Operative Findings:\" S LRV=.4 D F^LRSPRPT Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",34,0)\n D:LRA W^LRSPRPT W !,\"Postoperative Diagnosis:\" S LRV=.5 D F^LRSPRPT Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",35,0)\n ;\n\"RTN\",\"LRSPRPTA\",36,0)\n ;\n\"RTN\",\"LRSPRPTA\",37,0)\n ; Retrieve surgeon/attending\n\"RTN\",\"LRSPRPTA\",38,0)\n D ATTEND^LRAPBR1(.LRMD)\n\"RTN\",\"LRSPRPTA\",39,0)\n I LRMD'=\"\" W !?27,\"Surgeon/physician: \",LRMD\n\"RTN\",\"LRSPRPTA\",40,0)\n I LRMD(\"SR-SURGEON\")'=\"\" w !,?28,LRMD(\"SR-SURGEON\")\n\"RTN\",\"LRSPRPTA\",41,0)\n I LRMD(\"SR-ATTEND\")'=\"\" W !,?26,LRMD(\"SR-ATTEND\")\n\"RTN\",\"LRSPRPTA\",42,0)\n ;I +$G(LRMD(\"ERR\"))=601 W !,?26,$P(LRMD(\"ERR\"),\"^\",2)\n\"RTN\",\"LRSPRPTA\",43,0)\n ;\n\"RTN\",\"LRSPRPTA\",44,0)\n I LRA W !,LR(\"%1\")\n\"RTN\",\"LRSPRPTA\",45,0)\n ;\n\"RTN\",\"LRSPRPTA\",46,0)\n I $Y>(IOSL-14) D  Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",47,0)\n . D F^LRAPF,^LRAPF\n\"RTN\",\"LRSPRPTA\",48,0)\n E  D P^LRAPF\n\"RTN\",\"LRSPRPTA\",49,0)\n ;I $Y>(IOSL-8) D F^LRAPF,^LRAPF Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",50,0)\n D:LRA W^LRSPRPT\n\"RTN\",\"LRSPRPTA\",51,0)\n W:LRRC=\"\" !?20,\"+*+* REPORT INCOMPLETE *+*+\",!\n\"RTN\",\"LRSPRPTA\",52,0)\n I $Y>(IOSL-11) D F^LRAPF,^LRAPF Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",53,0)\n ;\n\"RTN\",\"LRSPRPTA\",54,0)\n W !\n\"RTN\",\"LRSPRPTA\",55,0)\n        ;EHS/OSS ;UJO*3.0*28 ; JUN 17,2025 ;Update[This Change Was Made To Align \"Pathology Resident\" To The Left]\n\"RTN\",\"LRSPRPTA\",56,0)\n        ; Scope  : Aligned \"RESIDENT PATHOLOGIST\" Label To The Left On LRAPFICH,LRAPQAM,LRAPQAMR,LRAPQAR,LRAP PRINT SINGLE Options\n\"RTN\",\"LRSPRPTA\",57,0)\n        ;I LRRMD'=\"\" W ?31,$S(LRSS=\"SP\":\"Pathology Resident: \",LRSS=\"CY\":\"Screened by: \",LRSS=\"EM\":\"Prepared by: \",1:\" \"),LRRMD\n\"RTN\",\"LRSPRPTA\",58,0)\n IF LRRMD'=\"\" WRITE $SELECT(LRSS=\"SP\":\"Pathology Resident: \",LRSS=\"CY\":\"Screened by: \",LRSS=\"EM\":\"Prepared by: \",1:\" \"),LRRMD\n\"RTN\",\"LRSPRPTA\",59,0)\n I $O(^LR(LRDFN,LRSS,LRI,1.3,0)) D  Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",60,0)\n . I $Y>(IOSL-11) D F^LRAPF,^LRAPF Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",61,0)\n . W !,LR(69.2,.13)\n\"RTN\",\"LRSPRPTA\",62,0)\n . I $P($G(^LR(LRDFN,LRSS,LRI,6,0)),U,4) S LR(0)=6 D ^LRSPRPTM\n\"RTN\",\"LRSPRPTA\",63,0)\n ;\n\"RTN\",\"LRSPRPTA\",64,0)\n S LRV=1.3 D F^LRSPRPT Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",65,0)\n I $O(^LR(LRDFN,LRSS,LRI,1,0)) D  Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",66,0)\n . I $Y>(IOSL-11) D F^LRAPF,^LRAPF Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",67,0)\n . W !,LR(69.2,.03)\n\"RTN\",\"LRSPRPTA\",68,0)\n . I $P($G(^LR(LRDFN,LRSS,LRI,7,0)),U,4) S LR(0)=7 D ^LRSPRPTM\n\"RTN\",\"LRSPRPTA\",69,0)\n ;\n\"RTN\",\"LRSPRPTA\",70,0)\n S LRV=1 D F^LRSPRPT Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",71,0)\n I $O(^LR(LRDFN,LRSS,LRI,1.1,0)) D  Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",72,0)\n . I $Y>(IOSL-11) D F^LRAPF,^LRAPF Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",73,0)\n . W !,LR(69.2,.04)\n\"RTN\",\"LRSPRPTA\",74,0)\n . I $P($G(^LR(LRDFN,LRSS,LRI,4,0)),\"^\",4) S LR(0)=4 D ^LRSPRPTM\n\"RTN\",\"LRSPRPTA\",75,0)\n ;\n\"RTN\",\"LRSPRPTA\",76,0)\n S LRV=1.1 D F^LRSPRPT Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",77,0)\n I $O(^LR(LRDFN,LRSS,LRI,1.4,0)) D  Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",78,0)\n . I $Y>(IOSL-11) D F^LRAPF,^LRAPF Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",79,0)\n . W !,LR(69.2,.14)\n\"RTN\",\"LRSPRPTA\",80,0)\n . I $P($G(^LR(LRDFN,LRSS,LRI,5,0)),U,4) S LR(0)=5 D ^LRSPRPTM\n\"RTN\",\"LRSPRPTA\",81,0)\n ;\n\"RTN\",\"LRSPRPTA\",82,0)\n S LRV=1.4 D F^LRSPRPT Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",83,0)\n ;\n\"RTN\",\"LRSPRPTA\",84,0)\n ; Supplementary Report\n\"RTN\",\"LRSPRPTA\",85,0)\n I $O(^LR(LRDFN,LRSS,LRI,1.2,0)) D:LR(.21) F^LRAPF,^LRAPF Q:LR(\"Q\")  D\n\"RTN\",\"LRSPRPTA\",86,0)\n . D:$Y>(IOSL-13) F^LRAPF,^LRAPF Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",87,0)\n . W !,\"Supplementary Report:\"\n\"RTN\",\"LRSPRPTA\",88,0)\n . S LRV=0 F  S LRV=$O(^LR(LRDFN,LRSS,LRI,1.2,LRV)) Q:'LRV!(LR(\"Q\"))  D\n\"RTN\",\"LRSPRPTA\",89,0)\n . . S X=^LR(LRDFN,LRSS,LRI,1.2,LRV,0) D S^LRSPRPT\n\"RTN\",\"LRSPRPTA\",90,0)\n D ^LRSPRPT1 Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",91,0)\n ;\n\"RTN\",\"LRSPRPTA\",92,0)\n ; Print performing laboratory if designated\n\"RTN\",\"LRSPRPTA\",93,0)\n D PPL\n\"RTN\",\"LRSPRPTA\",94,0)\n ;\n\"RTN\",\"LRSPRPTA\",95,0)\n ; Don't set the final flag and print the footer if prelim\n\"RTN\",\"LRSPRPTA\",96,0)\n Q:+$G(LRPRE)\n\"RTN\",\"LRSPRPTA\",97,0)\n S LRO=1 D F^LRAPF\n\"RTN\",\"LRSPRPTA\",98,0)\n Q\n\"RTN\",\"LRSPRPTA\",99,0)\n ;\n\"RTN\",\"LRSPRPTA\",100,0)\n ;\n\"RTN\",\"LRSPRPTA\",101,0)\nPPL ; Print any performing laboratories\n\"RTN\",\"LRSPRPTA\",102,0)\n ;\n\"RTN\",\"LRSPRPTA\",103,0)\n N LRPL,LRJ,LRX\n\"RTN\",\"LRSPRPTA\",104,0)\n ;\n\"RTN\",\"LRSPRPTA\",105,0)\n D RETLST^LRRPL(.LRPL,LRDFN,LRSS,LRI,0)\n\"RTN\",\"LRSPRPTA\",106,0)\n I $G(LRPL)<1 Q\n\"RTN\",\"LRSPRPTA\",107,0)\n ;\n\"RTN\",\"LRSPRPTA\",108,0)\n ; Start new page if space on existing page too small to display a significant portion of labs\n\"RTN\",\"LRSPRPTA\",109,0)\n I $Y>(IOSL-15) D F^LRAPF,^LRAPF Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",110,0)\n ;\n\"RTN\",\"LRSPRPTA\",111,0)\n W !!,$$REPEAT^XLFSTR(\"=\",IOM)\n\"RTN\",\"LRSPRPTA\",112,0)\n W !,\"Performing Laboratory:\",!\n\"RTN\",\"LRSPRPTA\",113,0)\n S LRJ=0\n\"RTN\",\"LRSPRPTA\",114,0)\n F  S LRJ=$O(LRPL(LRJ)) Q:'LRJ  D  Q:LR(\"Q\")\n\"RTN\",\"LRSPRPTA\",115,0)\n . I $Y>(IOSL-12) D F^LRAPF,^LRAPF Q:LR(\"Q\")  W !,\"Performing Laboratory (cont'd):\",!\n\"RTN\",\"LRSPRPTA\",116,0)\n . W !,LRPL(LRJ)\n\"RTN\",\"LRSPRPTA\",117,0)\n ;\n\"RTN\",\"LRSPRPTA\",118,0)\n Q\n\"VER\")\n8.0^22.2\n**END**\n**END**\n",
      "registeredAt": "2025-12-27T20:39:17.626Z",
      "status": "committed",
      "id": "14b0e6c9b87d96db",
      "linkedChanges": [
        "f34a26f4b094fd67",
        "b53c652270a35500",
        "7a7e135fa5927649",
        "fabff78cba889783",
        "45950d2046354496",
        "5cd5aac2bedaf9ee",
        "b3272f3d838fb2d1",
        "7dcedb128bb15622",
        "e7994ca68cd38587",
        "297e77f40765ea3d",
        "e2b3999a78b0e5fa",
        "6278e5883c20062b",
        "99115556d2e9295d",
        "a9f58c1e01189598",
        "6c0b1dd41f58125b"
      ],
      "updatedAt": "2025-12-27T20:39:31.646Z",
      "error": "Git commit failed: Command failed: git push origin main --tags\nerror: src refspec main does not match any\nerror: failed to push some refs to 'gitlab.ehs.com.jo:Ahmad.AlKhalaileh/docker.git'\n",
      "committedAt": "2025-12-27T20:39:31.643Z",
      "commitResult": {
        "success": true,
        "patchId": "UJO*3.0*28",
        "committedAt": "2025-12-27T20:39:31.643Z",
        "commitOutput": "No changes - files already up to date",
        "pushOutput": ""
      }
    },
    {
      "patchId": "UJOM*2.1*243",
      "package": "UJOM*2.1*243",
      "packageCode": "UJOM",
      "version": "2.1",
      "patchNumber": 243,
      "title": "Make the rpc's specific for moh to run scheduling",
      "createdDate": "2023-11-05T19:28:37",
      "author": "Mohammad Alkouz",
      "description": [],
      "gitlabIssues": [
        {
          "url": "https://gitlab.ehs.com.jo/software_projects/hakeem-API/-/issues/7",
          "number": "7"
        },
        {
          "url": "https://gitlab.ehs.com.jo/software_projects/hakeem-API/-/issues/7",
          "number": "7"
        }
      ],
      "routines": [
        "BSDX07",
        "UJOWASC",
        "BSDX28",
        "UJOPBSD1",
        "UJOPSCVL",
        "BSDX01",
        "UJOAPTPS",
        "BSDX02"
      ],
      "raw": "KIDS Distribution saved on Nov 05, 2023@19:28:37\nMake the rpc's specific for moh to run scheduling\n**KIDS**:UJOM*2.1*243^\n\n**INSTALL NAME**\nUJOM*2.1*243\n\"BLD\",9321,0)\nUJOM*2.1*243^MOH SPECIFIC MODIFICATIONS^0^3231105^y\n\"BLD\",9321,1,0)\n^^12^12^3231105^\n\"BLD\",9321,1,1,0)\nThis patch was created on 02/10/2023 by Mohammad Alkouz\n\"BLD\",9321,1,2,0)\nfor issue    \n\"BLD\",9321,1,3,0)\n:https://gitlab.ehs.com.jo/software_projects/hakeem-API/-/issues/7\n\"BLD\",9321,1,4,0)\n \n\"BLD\",9321,1,5,0)\n \n\"BLD\",9321,1,6,0)\nThis patch consider to make a set of rpc's that run Scheduling \n\"BLD\",9321,1,7,0)\napplication to be specific so we can install it in moh site's without any \n\"BLD\",9321,1,8,0)\nissues\n\"BLD\",9321,1,9,0)\n \n\"BLD\",9321,1,10,0)\nalso to rollback specific headers\n\"BLD\",9321,1,11,0)\n \n\"BLD\",9321,1,12,0)\nAnd this patch used to rollback specific code after install UJO*2.1*151\n\"BLD\",9321,4,0)\n^9.64PA^^\n\"BLD\",9321,6.3)\n11\n\"BLD\",9321,\"ABPKG\")\nn\n\"BLD\",9321,\"KRN\",0)\n^9.67PA^779.2^20\n\"BLD\",9321,\"KRN\",.4,0)\n.4\n\"BLD\",9321,\"KRN\",.401,0)\n.401\n\"BLD\",9321,\"KRN\",.402,0)\n.402\n\"BLD\",9321,\"KRN\",.403,0)\n.403\n\"BLD\",9321,\"KRN\",.5,0)\n.5\n\"BLD\",9321,\"KRN\",.84,0)\n.84\n\"BLD\",9321,\"KRN\",3.6,0)\n3.6\n\"BLD\",9321,\"KRN\",3.8,0)\n3.8\n\"BLD\",9321,\"KRN\",9.2,0)\n9.2\n\"BLD\",9321,\"KRN\",9.8,0)\n9.8\n\"BLD\",9321,\"KRN\",9.8,\"NM\",0)\n^9.68A^9^8\n\"BLD\",9321,\"KRN\",9.8,\"NM\",1,0)\nBSDX07^^0^B144048499\n\"BLD\",9321,\"KRN\",9.8,\"NM\",2,0)\nUJOWASC^^0^B124001134\n\"BLD\",9321,\"KRN\",9.8,\"NM\",4,0)\nBSDX28^^0^B66129299\n\"BLD\",9321,\"KRN\",9.8,\"NM\",5,0)\nUJOPBSD1^^0^B89782864\n\"BLD\",9321,\"KRN\",9.8,\"NM\",6,0)\nUJOPSCVL^^0^B100989404\n\"BLD\",9321,\"KRN\",9.8,\"NM\",7,0)\nBSDX01^^0^B243830800\n\"BLD\",9321,\"KRN\",9.8,\"NM\",8,0)\nUJOAPTPS^^0^B3463632\n\"BLD\",9321,\"KRN\",9.8,\"NM\",9,0)\nBSDX02^^0^B55079780\n\"BLD\",9321,\"KRN\",9.8,\"NM\",\"B\",\"BSDX01\",7)\n\n\"BLD\",9321,\"KRN\",9.8,\"NM\",\"B\",\"BSDX02\",9)\n\n\"BLD\",9321,\"KRN\",9.8,\"NM\",\"B\",\"BSDX07\",1)\n\n\"BLD\",9321,\"KRN\",9.8,\"NM\",\"B\",\"BSDX28\",4)\n\n\"BLD\",9321,\"KRN\",9.8,\"NM\",\"B\",\"UJOAPTPS\",8)\n\n\"BLD\",9321,\"KRN\",9.8,\"NM\",\"B\",\"UJOPBSD1\",5)\n\n\"BLD\",9321,\"KRN\",9.8,\"NM\",\"B\",\"UJOPSCVL\",6)\n\n\"BLD\",9321,\"KRN\",9.8,\"NM\",\"B\",\"UJOWASC\",2)\n\n\"BLD\",9321,\"KRN\",19,0)\n19\n\"BLD\",9321,\"KRN\",19.1,0)\n19.1\n\"BLD\",9321,\"KRN\",101,0)\n101\n\"BLD\",9321,\"KRN\",409.61,0)\n409.61\n\"BLD\",9321,\"KRN\",771,0)\n771\n\"BLD\",9321,\"KRN\",779.2,0)\n779.2\n\"BLD\",9321,\"KRN\",870,0)\n870\n\"BLD\",9321,\"KRN\",8989.51,0)\n8989.51\n\"BLD\",9321,\"KRN\",8989.52,0)\n8989.52\n\"BLD\",9321,\"KRN\",8994,0)\n8994\n\"BLD\",9321,\"KRN\",\"B\",.4,.4)\n\n\"BLD\",9321,\"KRN\",\"B\",.401,.401)\n\n\"BLD\",9321,\"KRN\",\"B\",.402,.402)\n\n\"BLD\",9321,\"KRN\",\"B\",.403,.403)\n\n\"BLD\",9321,\"KRN\",\"B\",.5,.5)\n\n\"BLD\",9321,\"KRN\",\"B\",.84,.84)\n\n\"BLD\",9321,\"KRN\",\"B\",3.6,3.6)\n\n\"BLD\",9321,\"KRN\",\"B\",3.8,3.8)\n\n\"BLD\",9321,\"KRN\",\"B\",9.2,9.2)\n\n\"BLD\",9321,\"KRN\",\"B\",9.8,9.8)\n\n\"BLD\",9321,\"KRN\",\"B\",19,19)\n\n\"BLD\",9321,\"KRN\",\"B\",19.1,19.1)\n\n\"BLD\",9321,\"KRN\",\"B\",101,101)\n\n\"BLD\",9321,\"KRN\",\"B\",409.61,409.61)\n\n\"BLD\",9321,\"KRN\",\"B\",771,771)\n\n\"BLD\",9321,\"KRN\",\"B\",779.2,779.2)\n\n\"BLD\",9321,\"KRN\",\"B\",870,870)\n\n\"BLD\",9321,\"KRN\",\"B\",8989.51,8989.51)\n\n\"BLD\",9321,\"KRN\",\"B\",8989.52,8989.52)\n\n\"BLD\",9321,\"KRN\",\"B\",8994,8994)\n\n\"BLD\",9321,\"QUES\",0)\n^9.62^^\n\"BLD\",9321,\"REQB\",0)\n^9.611^2^2\n\"BLD\",9321,\"REQB\",1,0)\nUJOP*2.1*19^1\n\"BLD\",9321,\"REQB\",2,0)\nUJO*2.1*151^1\n\"BLD\",9321,\"REQB\",\"B\",\"UJO*2.1*151\",2)\n\n\"BLD\",9321,\"REQB\",\"B\",\"UJOP*2.1*19\",1)\n\n\"MBREQ\")\n0\n\"PKG\",218,-1)\n1^1\n\"PKG\",218,0)\nMOH SPECIFIC MODIFICATIONS^UJOM^This package was added to Ministry Of Health (MOH) in Jordan\n\"PKG\",218,20,0)\n^9.402P^^\n\"PKG\",218,22,0)\n^9.49I^1^1\n\"PKG\",218,22,1,0)\n2.1\n\"PKG\",218,22,1,\"PAH\",1,0)\n243^3231105^8\n\"PKG\",218,22,1,\"PAH\",1,1,0)\n^^12^12^3231105\n\"PKG\",218,22,1,\"PAH\",1,1,1,0)\nThis patch was created on 02/10/2023 by Mohammad Alkouz\n\"PKG\",218,22,1,\"PAH\",1,1,2,0)\nfor issue    \n\"PKG\",218,22,1,\"PAH\",1,1,3,0)\n:https://gitlab.ehs.com.jo/software_projects/hakeem-API/-/issues/7\n\"PKG\",218,22,1,\"PAH\",1,1,4,0)\n \n\"PKG\",218,22,1,\"PAH\",1,1,5,0)\n \n\"PKG\",218,22,1,\"PAH\",1,1,6,0)\nThis patch consider to make a set of rpc's that run Scheduling \n\"PKG\",218,22,1,\"PAH\",1,1,7,0)\napplication to be specific so we can install it in moh site's without any \n\"PKG\",218,22,1,\"PAH\",1,1,8,0)\nissues\n\"PKG\",218,22,1,\"PAH\",1,1,9,0)\n \n\"PKG\",218,22,1,\"PAH\",1,1,10,0)\nalso to rollback specific headers\n\"PKG\",218,22,1,\"PAH\",1,1,11,0)\n \n\"PKG\",218,22,1,\"PAH\",1,1,12,0)\nAnd this patch used to rollback specific code after install UJO*2.1*151\n\"QUES\",\"XPF1\",0)\nY\n\"QUES\",\"XPF1\",\"??\")\n^D REP^XPDH\n\"QUES\",\"XPF1\",\"A\")\nShall I write over your |FLAG| File\n\"QUES\",\"XPF1\",\"B\")\nYES\n\"QUES\",\"XPF1\",\"M\")\nD XPF1^XPDIQ\n\"QUES\",\"XPF2\",0)\nY\n\"QUES\",\"XPF2\",\"??\")\n^D DTA^XPDH\n\"QUES\",\"XPF2\",\"A\")\nWant my data |FLAG| yours\n\"QUES\",\"XPF2\",\"B\")\nYES\n\"QUES\",\"XPF2\",\"M\")\nD XPF2^XPDIQ\n\"QUES\",\"XPI1\",0)\nYO\n\"QUES\",\"XPI1\",\"??\")\n^D INHIBIT^XPDH\n\"QUES\",\"XPI1\",\"A\")\nWant KIDS to INHIBIT LOGONs during the install\n\"QUES\",\"XPI1\",\"B\")\nNO\n\"QUES\",\"XPI1\",\"M\")\nD XPI1^XPDIQ\n\"QUES\",\"XPM1\",0)\nPO^VA(200,:EM\n\"QUES\",\"XPM1\",\"??\")\n^D MG^XPDH\n\"QUES\",\"XPM1\",\"A\")\nEnter the Coordinator for Mail Group '|FLAG|'\n\"QUES\",\"XPM1\",\"B\")\n\n\"QUES\",\"XPM1\",\"M\")\nD XPM1^XPDIQ\n\"QUES\",\"XPO1\",0)\nY\n\"QUES\",\"XPO1\",\"??\")\n^D MENU^XPDH\n\"QUES\",\"XPO1\",\"A\")\nWant KIDS to Rebuild Menu Trees Upon Completion of Install\n\"QUES\",\"XPO1\",\"B\")\nNO\n\"QUES\",\"XPO1\",\"M\")\nD XPO1^XPDIQ\n\"QUES\",\"XPZ1\",0)\nY\n\"QUES\",\"XPZ1\",\"??\")\n^D OPT^XPDH\n\"QUES\",\"XPZ1\",\"A\")\nWant to DISABLE Scheduled Options, Menu Options, and Protocols\n\"QUES\",\"XPZ1\",\"B\")\nNO\n\"QUES\",\"XPZ1\",\"M\")\nD XPZ1^XPDIQ\n\"QUES\",\"XPZ2\",0)\nY\n\"QUES\",\"XPZ2\",\"??\")\n^D RTN^XPDH\n\"QUES\",\"XPZ2\",\"A\")\nWant to MOVE routines to other CPUs\n\"QUES\",\"XPZ2\",\"B\")\nNO\n\"QUES\",\"XPZ2\",\"M\")\nD XPZ2^XPDIQ\n\"RTN\")\n8\n\"RTN\",\"BSDX01\")\n0^7^B243830800\n\"RTN\",\"BSDX01\",1,0)\nBSDX01 ; IHS/OIT/HMW - WINDOWS SCHEDULING RPCS ; 4/20/16 6:49pm\n\"RTN\",\"BSDX01\",2,0)\n ;;1.7;BSDX;;Nov 08, 2012;Build 11\n\"RTN\",\"BSDX01\",3,0)\n ; Licensed under LGPL\n\"RTN\",\"BSDX01\",4,0)\n ;\n\"RTN\",\"BSDX01\",5,0)\nSUINFOD(BSDXY,BSDXDUZ) ;EP Debugging entry point\n\"RTN\",\"BSDX01\",6,0)\n ;D DEBUG^%Serenji(\"SUINFO^BSDX01(.BSDXY,BSDXDUZ)\")\n\"RTN\",\"BSDX01\",7,0)\n ;\n\"RTN\",\"BSDX01\",8,0)\n Q\n\"RTN\",\"BSDX01\",9,0)\n    ;EHS/WAT;UJO*2.0*31 ;OCT 6,2013;Update [Updating the SUINFO function by adding a new parameter \"USERKEY\" that holds the name of the user key].\n\"RTN\",\"BSDX01\",10,0)\n    ;SUINFO(BSDXY,BSDXDUZ)    ;EP\n\"RTN\",\"BSDX01\",11,0)\nSUINFO(BSDXY,BSDXDUZ,USERKEY)  ;EP\n\"RTN\",\"BSDX01\",12,0)\n ;Called by BSDX SCHEDULING USER INFO\n\"RTN\",\"BSDX01\",13,0)\n ;Returns ADO Recordset having column MANAGER\n\"RTN\",\"BSDX01\",14,0)\n ;MANAGER = YES if user has keys BSDXZMGR or XUPROGMODE\n\"RTN\",\"BSDX01\",15,0)\n ;\n\"RTN\",\"BSDX01\",16,0)\n NEW BSDXMGR,BSDXERR\n\"RTN\",\"BSDX01\",17,0)\n KILL ^BSDXTMP($J)\n\"RTN\",\"BSDX01\",18,0)\n SET BSDXY=\"^BSDXTMP(\"_$J_\")\"\n\"RTN\",\"BSDX01\",19,0)\n SET BSDXI=0\n\"RTN\",\"BSDX01\",20,0)\n SET BSDXERR=\"\"\n\"RTN\",\"BSDX01\",21,0)\n SET ^BSDXTMP($J,BSDXI)=\"T00010MANAGER\"_$C(30)\n\"RTN\",\"BSDX01\",22,0)\n ;Check SECURITY KEY file for BSDXZMGR or XUPROGMODE keys\n\"RTN\",\"BSDX01\",23,0)\n IF '+BSDXDUZ S BSDXDUZ=DUZ\n\"RTN\",\"BSDX01\",24,0)\n    ;EHS/WAT;UJO*2.0*31 ;OCT 6,2013; Update [Updating the argument sent to $$APSEC function from hard coded string \"BSDXZMGR\" to \"USERKEY\" variable].\n\"RTN\",\"BSDX01\",25,0)\n    ;S BSDXMGR=$$APSEC(\"BSDXZMGR\",BSDXDUZ);\n\"RTN\",\"BSDX01\",26,0)\n    SET BSDXMGR=$$APSEC(USERKEY,BSDXDUZ)\n\"RTN\",\"BSDX01\",27,0)\n SET BSDXMGR=$S(BSDXMGR=1:\"YES\",1:\"NO\")\n\"RTN\",\"BSDX01\",28,0)\n SET BSDXI=BSDXI+1\n\"RTN\",\"BSDX01\",29,0)\n SET ^BSDXTMP($J,BSDXI)=BSDXMGR_$C(30)\n\"RTN\",\"BSDX01\",30,0)\n SET ^BSDXTMP($J,BSDXI+1)=$C(31)_BSDXERR    \n\"RTN\",\"BSDX01\",31,0)\n QUIT\n\"RTN\",\"BSDX01\",32,0)\nDEPUSRD(BSDXY,BSDXDUZ) ;EP Debugging entry point\n\"RTN\",\"BSDX01\",33,0)\n ;\n\"RTN\",\"BSDX01\",34,0)\n ;\n\"RTN\",\"BSDX01\",35,0)\n ;D DEBUG^%Serenji(\"DEPUSR^BSDX01(.BSDXY,BSDXDUZ)\")\n\"RTN\",\"BSDX01\",36,0)\n ;\n\"RTN\",\"BSDX01\",37,0)\n Q\n\"RTN\",\"BSDX01\",38,0)\n ;\n\"RTN\",\"BSDX01\",39,0)\nDEPUSR(BSDXY,BSDXDUZ)  ;EP\n\"RTN\",\"BSDX01\",40,0)\n ;Called by BSDX RESOURCE GROUPS BY USER\n\"RTN\",\"BSDX01\",41,0)\n ;Returns ADO Recordset with all ACTIVE resource group names to which user has access\n\"RTN\",\"BSDX01\",42,0)\n ;based on entries in BSDX RESOURCE USER file (Say this again for myself: Groups ONLY!!)\n\"RTN\",\"BSDX01\",43,0)\n ;If BSDXDUZ=0 then returns all department names for current DUZ\n\"RTN\",\"BSDX01\",44,0)\n    ;if not linked, always returned.\n\"RTN\",\"BSDX01\",45,0)\n ;If user BSDXDUZ possesses the key BSDXZMGR or XUPROGMODE\n\"RTN\",\"BSDX01\",46,0)\n ;then ALL resource group names are returned regardless of whether any active resources\n\"RTN\",\"BSDX01\",47,0)\n ;are associated with the group or not.\n\"RTN\",\"BSDX01\",48,0)\n ;\n\"RTN\",\"BSDX01\",49,0)\n ;\n\"RTN\",\"BSDX01\",50,0)\n N BSDXERR,BSDXRET,BSDXIEN,BSDXRES,BSDXDEP,BSDXDDR,BSDXDEPN,BSDXRDAT,BSDXRNOD,BSDXI\n\"RTN\",\"BSDX01\",51,0)\n N BSDXMGR,BSDXNOD\n\"RTN\",\"BSDX01\",52,0)\n K ^BSDXTEMP($J)\n\"RTN\",\"BSDX01\",53,0)\n K ^BSDXTMP($J)\n\"RTN\",\"BSDX01\",54,0)\n S BSDXY=\"^BSDXTMP(\"_$J_\")\"\n\"RTN\",\"BSDX01\",55,0)\n S BSDXI=0\n\"RTN\",\"BSDX01\",56,0)\n S BSDXERR=\"\"\n\"RTN\",\"BSDX01\",57,0)\n S ^BSDXTMP($J,BSDXI)=\"I00020RESOURCE_GROUPID^T00030RESOURCE_GROUP\"_$C(30)\n\"RTN\",\"BSDX01\",58,0)\n I '+BSDXDUZ S BSDXDUZ=DUZ\n\"RTN\",\"BSDX01\",59,0)\n ;Check SECURITY KEY file for BSDXZMGR or XUPROGMODE keys\n\"RTN\",\"BSDX01\",60,0)\n S BSDXMGR=$$APSEC(\"BSDXZMGR\",BSDXDUZ)\n\"RTN\",\"BSDX01\",61,0)\n ;\n\"RTN\",\"BSDX01\",62,0)\n ;User does not have BSDXZMGR or XUPROGMODE keys, so\n\"RTN\",\"BSDX01\",63,0)\n ;$O THRU AC XREF OF BSDX RESOURCE USER\n\"RTN\",\"BSDX01\",64,0)\n I 'BSDXMGR,$D(^BSDXRSU(\"AC\",BSDXDUZ)) S BSDXIEN=0 F  S BSDXIEN=$O(^BSDXRSU(\"AC\",BSDXDUZ,BSDXIEN)) Q:'+BSDXIEN  D\n\"RTN\",\"BSDX01\",65,0)\n . S BSDXRES=$P(^BSDXRSU(BSDXIEN,0),U)\n\"RTN\",\"BSDX01\",66,0)\n . Q:'$D(^BSDXDEPT(\"AB\",BSDXRES))  ; If not part of a group, quit (\"AB\" is the whole file index for the resource multiple in Group file)\n\"RTN\",\"BSDX01\",67,0)\n    . ; Q:'$$INDIV2(BSDXRES)  ; If not in the same division as user, quit\n\"RTN\",\"BSDX01\",68,0)\n . S BSDXRNOD=^BSDXRES(BSDXRES,0)\n\"RTN\",\"BSDX01\",69,0)\n . ;QUIT if the resource is inactive\n\"RTN\",\"BSDX01\",70,0)\n . Q:$P(BSDXRNOD,U,2)=1\n\"RTN\",\"BSDX01\",71,0)\n . S BSDXDEP=0 F  S BSDXDEP=$O(^BSDXDEPT(\"AB\",BSDXRES,BSDXDEP)) Q:'+BSDXDEP  D\n\"RTN\",\"BSDX01\",72,0)\n . . Q:'$D(^BSDXDEPT(BSDXDEP,0))\n\"RTN\",\"BSDX01\",73,0)\n . . Q:$D(^BSDXTEMP($J,BSDXDEP))\n\"RTN\",\"BSDX01\",74,0)\n . . S ^BSDXTEMP($J,BSDXDEP)=\"\"\n\"RTN\",\"BSDX01\",75,0)\n . . S BSDXDEPN=$P(^BSDXDEPT(BSDXDEP,0),U)\n\"RTN\",\"BSDX01\",76,0)\n . . S BSDXI=BSDXI+1\n\"RTN\",\"BSDX01\",77,0)\n . . S ^BSDXTMP($J,BSDXI)=BSDXDEP_U_BSDXDEPN_$C(30)\n\"RTN\",\"BSDX01\",78,0)\n . . Q\n\"RTN\",\"BSDX01\",79,0)\n . Q\n\"RTN\",\"BSDX01\",80,0)\n ;\n\"RTN\",\"BSDX01\",81,0)\n ;User does have BSDXZMGR or XUPROGMODE keys, so\n\"RTN\",\"BSDX01\",82,0)\n ;$O THRU BSDX RESOURCE GROUP file directly\n\"RTN\",\"BSDX01\",83,0)\n I BSDXMGR S BSDXIEN=0 F  S BSDXIEN=$O(^BSDXDEPT(BSDXIEN)) Q:'+BSDXIEN  D\n\"RTN\",\"BSDX01\",84,0)\n . Q:'$D(^BSDXDEPT(BSDXIEN,0))\n\"RTN\",\"BSDX01\",85,0)\n . S BSDXNOD=^BSDXDEPT(BSDXIEN,0)\n\"RTN\",\"BSDX01\",86,0)\n . S BSDXDEPN=$P(BSDXNOD,U)\n\"RTN\",\"BSDX01\",87,0)\n . S BSDXI=BSDXI+1\n\"RTN\",\"BSDX01\",88,0)\n . S ^BSDXTMP($J,BSDXI)=BSDXIEN_U_BSDXDEPN_$C(30)\n\"RTN\",\"BSDX01\",89,0)\n . Q\n\"RTN\",\"BSDX01\",90,0)\n ;\n\"RTN\",\"BSDX01\",91,0)\n S ^BSDXTMP($J,BSDXI+1)=$C(31)_BSDXERR\n\"RTN\",\"BSDX01\",92,0)\n Q\n\"RTN\",\"BSDX01\",93,0)\n ;\n\"RTN\",\"BSDX01\",94,0)\n ;\n\"RTN\",\"BSDX01\",95,0)\nRESUSRD(BSDXY,BSDXDUZ) ;EP Debugging entry point\n\"RTN\",\"BSDX01\",96,0)\n ;\n\"RTN\",\"BSDX01\",97,0)\n ;\n\"RTN\",\"BSDX01\",98,0)\n ;D DEBUG^%Serenji(\"RESUSR^BSDX01(.BSDXY,BSDXDUZ)\")\n\"RTN\",\"BSDX01\",99,0)\n ;\n\"RTN\",\"BSDX01\",100,0)\n Q\n\"RTN\",\"BSDX01\",101,0)\n ;\n\"RTN\",\"BSDX01\",102,0)\nRESUSR(BSDXY,BSDXDUZ) ;EP\n\"RTN\",\"BSDX01\",103,0)\n ;Returns ADO Recordset with ALL RESOURCE names\n\"RTN\",\"BSDX01\",104,0)\n ;Inactive RESOURCES are NOT filtered out\n\"RTN\",\"BSDX01\",105,0)\n ;Called by BSDX RESOURCES BY USER\n\"RTN\",\"BSDX01\",106,0)\n ;\n\"RTN\",\"BSDX01\",107,0)\n N BSDXERR,BSDXRET,BSDXIEN,BSDXRES,BSDXDEP,BSDXDDR,BSDXDEPN,BSDXRDAT,BSDXRNOD,BSDXI,BSDX,BSDXLTR\n\"RTN\",\"BSDX01\",108,0)\n N BSDXNOS,BSDXCAN\n\"RTN\",\"BSDX01\",109,0)\n K ^BSDXTMP($J)\n\"RTN\",\"BSDX01\",110,0)\n S BSDXY=\"^BSDXTMP(\"_$J_\")\"\n\"RTN\",\"BSDX01\",111,0)\n S BSDXI=0\n\"RTN\",\"BSDX01\",112,0)\n S BSDXERR=\"\"\n\"RTN\",\"BSDX01\",113,0)\n S ^BSDXTMP($J,BSDXI)=\"I00010RESOURCEID^T00030RESOURCE_NAME^T00010INACTIVE^I00010TIMESCALE^I00010HOSPITAL_LOCATION_ID^T00030LETTER_TEXT^T00030NO_SHOW_LETTER\"\n\"RTN\",\"BSDX01\",114,0)\n    ; EHS/AYG; \"UJO*2.0*61\" ; Nov 28,2013 ; Update [ADDING BSDX RESOURCE configuration fields]\n\"RTN\",\"BSDX01\",115,0)\n    ; Added the following fields BSDX RESOURCE FILE#9002018.1 :\n\"RTN\",\"BSDX01\",116,0)\n    ; 400000000 FIRST APPOINTMENTS MAXIMUM\n\"RTN\",\"BSDX01\",117,0)\n    ; 400000001 FOLLOW-UP APPOINTMENTS MAXIMUM\n\"RTN\",\"BSDX01\",118,0)\n    ; 400000002 APPOINTMENTS/SLOT MAXIMUM\n\"RTN\",\"BSDX01\",119,0)\n    ; 400000003 OVERBOOKS/DAY MAXIMUM\n\"RTN\",\"BSDX01\",120,0)\n    ; 400000004 SLOTS FOR FIRST APPOINTMENT\n\"RTN\",\"BSDX01\",121,0)\n    ; 400000005 SLOTS FOR FOLLOWUP APPOINTMENT\n\"RTN\",\"BSDX01\",122,0)\n    ; ; START OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"BSDX01\",123,0)\n    ; ; START OF OLD CODE\n\"RTN\",\"BSDX01\",124,0)\n    ; S ^BSDXTMP($J,BSDXI)=^(BSDXI)_\"^T00030CLINIC_CANCELLATION_LETTER^I00010VIEW^I00010OVERBOOK^I00010MODIFY_SCHEDULE^I00010MODIFY_APPOINTMENTS_$C(30)\n\"RTN\",\"BSDX01\",125,0)\n    ; END OF OLD CODE\n\"RTN\",\"BSDX01\",126,0)\n    ; START OF NEW CODE\n\"RTN\",\"BSDX01\",127,0)\n        ;\n\"RTN\",\"BSDX01\",128,0)\n        ;EHS/HEH; \"UJOM*2.0*105\" ; DEC 31,2015 ; Update [add cancel referral header]\n\"RTN\",\"BSDX01\",129,0)\n ;SET ^BSDXTMP($J,BSDXI)=^(BSDXI)_\"^T00030CLINIC_CANCELLATION_LETTER^I00010VIEW^I00010OVERBOOK^I00010MODIFY_SCHEDULE^I00010MODIFY_APPOINTMENTS^I00010FIRST_MAX^I00010FOLLOW_MAX^I00010APPT_SLOT_MAX^I00010OVERBOOK_MAX^I00010FIRST_APPT_SLOTS^I00010FOLLOWUP_APPT_SLOTS\"_$C(30)\n\"RTN\",\"BSDX01\",130,0)\n        SET ^BSDXTMP($JOB,BSDXI)=^(BSDXI)_\"^T00030CLINIC_CANCELLATION_LETTER^I00010VIEW^I00010OVERBOOK^I00010MODIFY_SCHEDULE^I00010MODIFY_APPOINTMENTS^I00010FIRST_MAX^I00010FOLLOW_MAX^I00010APPT_SLOT_MAX^I00010OVERBOOK_MAX^I00010FIRST_APPT_SLOTS^I00010FOLLOWUP_APPT_SLOTS^I00010CANCEL_REFERRAL\"_$C(30)\n\"RTN\",\"BSDX01\",131,0)\n       ;\n\"RTN\",\"BSDX01\",132,0)\n    ; END OF NEW CODE\n\"RTN\",\"BSDX01\",133,0)\n    ; END OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"BSDX01\",134,0)\n IF '+BSDXDUZ S BSDXDUZ=DUZ\n\"RTN\",\"BSDX01\",135,0)\n ;$O THRU AC XREF OF BSDX RESOURCE USER\n\"RTN\",\"BSDX01\",136,0)\n ;Rmoved these lines in order to just return all resource names\n\"RTN\",\"BSDX01\",137,0)\n ;I $D(^BSDXRSU(\"AC\",BSDXDUZ)) S BSDXIEN=0 F  S BSDXIEN=$O(^BSDXRSU(\"AC\",BSDXDUZ,BSDXIEN)) Q:'+BSDXIEN  D\n\"RTN\",\"BSDX01\",138,0)\n ;. S BSDXRES=$P(^BSDXRSU(BSDXIEN,0),U)\n\"RTN\",\"BSDX01\",139,0)\n ;\n\"RTN\",\"BSDX01\",140,0)\n ;$O THRU BSDX RESOURCE File\n\"RTN\",\"BSDX01\",141,0)\n SET BSDXRES=0 F  S BSDXRES=$O(^BSDXRES(BSDXRES)) Q:'+BSDXRES  D\n\"RTN\",\"BSDX01\",142,0)\n . QUIT:'$D(^BSDXRES(BSDXRES,0))\n\"RTN\",\"BSDX01\",143,0)\n . SET BSDXRNOD=^BSDXRES(BSDXRES,0)\n\"RTN\",\"BSDX01\",144,0)\n . NEW BSDXSC S BSDXSC=$P(BSDXRNOD,U,4)  ; Hospital Location\n\"RTN\",\"BSDX01\",145,0)\n    . ;Q:$P(BSDXRNOD,U,2)=1  ;Inactive resources not filtered\n\"RTN\",\"BSDX01\",146,0)\n . ;S BSDXRDAT=$P(BSDXRNOD,U,1,4)\n\"RTN\",\"BSDX01\",147,0)\n . ;I '$$INDIV(BSDXSC) QUIT  ; If not in division, quit\n\"RTN\",\"BSDX01\",148,0)\n    . KILL BSDXRDAT\n\"RTN\",\"BSDX01\",149,0)\n . FOR BSDX=1:1:4 S $P(BSDXRDAT,U,BSDX)=$P(BSDXRNOD,U,BSDX)\n\"RTN\",\"BSDX01\",150,0)\n . SET BSDXRDAT=BSDXRES_U_BSDXRDAT\n\"RTN\",\"BSDX01\",151,0)\n . ;Get letter text from wp field\n\"RTN\",\"BSDX01\",152,0)\n . SET BSDXLTR=\"\"\n\"RTN\",\"BSDX01\",153,0)\n . IF $D(^BSDXRES(BSDXRES,1)) D\n\"RTN\",\"BSDX01\",154,0)\n . . SET BSDXIEN=0\n\"RTN\",\"BSDX01\",155,0)\n . . FOR  SET BSDXIEN=$O(^BSDXRES(BSDXRES,1,BSDXIEN)) Q:'+BSDXIEN  D\n\"RTN\",\"BSDX01\",156,0)\n . . . SET BSDXLTR=BSDXLTR_$G(^BSDXRES(BSDXRES,1,BSDXIEN,0))\n\"RTN\",\"BSDX01\",157,0)\n . . . SET BSDXLTR=BSDXLTR_$C(13)_$C(10)\n\"RTN\",\"BSDX01\",158,0)\n . SET BSDXNOS=\"\"\n\"RTN\",\"BSDX01\",159,0)\n . IF $D(^BSDXRES(BSDXRES,12)) D\n\"RTN\",\"BSDX01\",160,0)\n . . SET BSDXIEN=0 F  S BSDXIEN=$O(^BSDXRES(BSDXRES,12,BSDXIEN)) Q:'+BSDXIEN  D\n\"RTN\",\"BSDX01\",161,0)\n . . . SET BSDXNOS=BSDXNOS_$G(^BSDXRES(BSDXRES,12,BSDXIEN,0))\n\"RTN\",\"BSDX01\",162,0)\n . . . SET BSDXNOS=BSDXNOS_$C(13)_$C(10)\n\"RTN\",\"BSDX01\",163,0)\n . SET BSDXCAN=\"\"\n\"RTN\",\"BSDX01\",164,0)\n . IF $D(^BSDXRES(BSDXRES,13)) D\n\"RTN\",\"BSDX01\",165,0)\n . . SET BSDXIEN=0 F  S BSDXIEN=$O(^BSDXRES(BSDXRES,13,BSDXIEN)) Q:'+BSDXIEN  D\n\"RTN\",\"BSDX01\",166,0)\n . . . SET BSDXCAN=BSDXCAN_$G(^BSDXRES(BSDXRES,13,BSDXIEN,0))\n\"RTN\",\"BSDX01\",167,0)\n . . . SET BSDXCAN=BSDXCAN_$C(13)_$C(10)\n\"RTN\",\"BSDX01\",168,0)\n . NEW BSDXACC,BSDXMGR\n\"RTN\",\"BSDX01\",169,0)\n . SET BSDXACC=\"0^0^0^0\"\n\"RTN\",\"BSDX01\",170,0)\n . SET BSDXMGR=$O(^DIC(19.1,\"B\",\"BSDXZMGR\",0))\n\"RTN\",\"BSDX01\",171,0)\n . IF +BSDXMGR,$D(^VA(200,BSDXDUZ,51,BSDXMGR)) S BSDXACC=\"1^1^1^1\"\n\"RTN\",\"BSDX01\",172,0)\n . SET BSDXMGR=$O(^DIC(19.1,\"B\",\"XUPROGMODE\",0))\n\"RTN\",\"BSDX01\",173,0)\n . IF +BSDXMGR,$D(^VA(200,BSDXDUZ,51,BSDXMGR)) S BSDXACC=\"1^1^1^1\"\n\"RTN\",\"BSDX01\",174,0)\n        . ;EHS/HEH; \"UJOM*2.0*105\" ; DEC 31,2015 ; Addition [Set default value for cancel referral privilege]\n\"RTN\",\"BSDX01\",175,0)\n        . ; Decalre the cancel referral variable and set default value\n\"RTN\",\"BSDX01\",176,0)\n        . ; START OF CODE CHANGE FOR ; UJOM*2.0*105\n\"RTN\",\"BSDX01\",177,0)\n        . NEW UJOMCRF\n\"RTN\",\"BSDX01\",178,0)\n        . SET UJOMCRF=0\n\"RTN\",\"BSDX01\",179,0)\n        . ; END OF CODE CHANGE FOR ; UJOM*2.0*105\n\"RTN\",\"BSDX01\",180,0)\n . IF BSDXACC=\"0^0^0^0\" D\n\"RTN\",\"BSDX01\",181,0)\n . . NEW BSDXNOD,BSDXRUID\n\"RTN\",\"BSDX01\",182,0)\n . . SET BSDXRUID=0\n\"RTN\",\"BSDX01\",183,0)\n . . ;Get entry for this user and resource\n\"RTN\",\"BSDX01\",184,0)\n . . FOR  SET BSDXRUID=$O(^BSDXRSU(\"AC\",BSDXDUZ,BSDXRUID)) Q:'+BSDXRUID  I $D(^BSDXRSU(BSDXRUID,0)),$P(^(0),U)=BSDXRES Q\n\"RTN\",\"BSDX01\",185,0)\n . . QUIT:'+BSDXRUID\n\"RTN\",\"BSDX01\",186,0)\n . . SET $P(BSDXACC,U)=1\n\"RTN\",\"BSDX01\",187,0)\n . . SET BSDXNOD=$G(^BSDXRSU(BSDXRUID,0))\n\"RTN\",\"BSDX01\",188,0)\n . . SET $P(BSDXACC,U,2)=+$P(BSDXNOD,U,3)\n\"RTN\",\"BSDX01\",189,0)\n . . SET $P(BSDXACC,U,3)=+$P(BSDXNOD,U,4)\n\"RTN\",\"BSDX01\",190,0)\n    . . SET $P(BSDXACC,U,4)=+$P(BSDXNOD,U,5)\n\"RTN\",\"BSDX01\",191,0)\n    . . ;EHS/HEH; \"UJOM*2.0*105\" ; DEC 31,2015 ; Addition [Get the cancel referral field]\n\"RTN\",\"BSDX01\",192,0)\n    . . ; Get the value of UJOM CANCEL REFERRAL field #400077000 from BSDX RESOURCE USER file #9002018.15\n\"RTN\",\"BSDX01\",193,0)\n    . . ; START OF CODE CHANGE FOR ; UJOM*2.0*105\n\"RTN\",\"BSDX01\",194,0)\n    . . NEW UJOMGRF\n\"RTN\",\"BSDX01\",195,0)\n    . . ;EHS/MOK; \"UJOM*2.1*243\" ; OCT 17,2023 ; Update [Change the field number to be generic UJO CANCEL REFFERRAL]\n\"RTN\",\"BSDX01\",196,0)\n    . . ;SET UJOMGRF=$$GET1^DIQ(9002018.15,BSDXRUID,400077000,\"I\")\n\"RTN\",\"BSDX01\",197,0)\n    . . SET UJOMGRF=$$GET1^DIQ(9002018.15,BSDXRUID,400000001,\"I\")\n\"RTN\",\"BSDX01\",198,0)\n    . . SET:UJOMGRF'=\"\" UJOMCRF=UJOMGRF\n\"RTN\",\"BSDX01\",199,0)\n    . . ; END OF CODE CHANGE FOR ; UJOM*2.0*105\n\"RTN\",\"BSDX01\",200,0)\n . SET BSDXRDAT=BSDXRDAT_U_BSDXLTR_U_BSDXNOS_U_BSDXCAN_U_BSDXACC\n\"RTN\",\"BSDX01\",201,0)\n    . ; EHS/AYG; \"UJO*2.0*61\" ; Nov 28,2013 ; Addition [ADDING BSDX RESOURCE configuration fields]\n\"RTN\",\"BSDX01\",202,0)\n    . ; Added the following fields BSDX RESOURCE FILE#9002018.1 :\n\"RTN\",\"BSDX01\",203,0)\n    . ; (FIRSTMAX) 400000000 FIRST APPOINTMENTS MAXIMUM \n\"RTN\",\"BSDX01\",204,0)\n    . ; (FOLLOMAX) 400000001 FOLLOW-UP APPOINTMENTS MAXIMUM\n\"RTN\",\"BSDX01\",205,0)\n    . ; (SLOTMAX)  400000002 APPOINTMENTS/SLOT MAXIMUM\n\"RTN\",\"BSDX01\",206,0)\n    . ; (OVERBMAX) 400000003 OVERBOOKS/DAY MAXIMUM\n\"RTN\",\"BSDX01\",207,0)\n    . ; (FIRSTSLT) 400000004 SLOTS FOR FIRST APPOINTMENT\n\"RTN\",\"BSDX01\",208,0)\n    . ; (FOLLOSLT) 400000005 SLOTS FOR FOLLOWUP APPOINTMENT\n\"RTN\",\"BSDX01\",209,0)\n    . ; ; START OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"BSDX01\",210,0)\n    . NEW FIRSTMAX,FOLLOMAX,SLOTMAX,OVERBMAX,FIRSTSLT,FOLLOSLT\n\"RTN\",\"BSDX01\",211,0)\n    . SET FIRSTMAX=$$GET1^DIQ(9002018.1,BSDXRES_\",\",400000000)\n\"RTN\",\"BSDX01\",212,0)\n    . SET FOLLOMAX=$$GET1^DIQ(9002018.1,BSDXRES_\",\",400000001)\n\"RTN\",\"BSDX01\",213,0)\n    . SET SLOTMAX=$$GET1^DIQ(9002018.1,BSDXRES_\",\",400000002)\n\"RTN\",\"BSDX01\",214,0)\n    . SET OVERBMAX=$$GET1^DIQ(9002018.1,BSDXRES_\",\",400000003)\n\"RTN\",\"BSDX01\",215,0)\n    . SET FIRSTSLT=$$GET1^DIQ(9002018.1,BSDXRES_\",\",400000004)\n\"RTN\",\"BSDX01\",216,0)\n    . SET FOLLOSLT=$$GET1^DIQ(9002018.1,BSDXRES_\",\",400000005)\n\"RTN\",\"BSDX01\",217,0)\n    . SET BSDXRDAT=BSDXRDAT_U_FIRSTMAX_U_FOLLOMAX_U_SLOTMAX_U_OVERBMAX_U_FIRSTSLT_U_FOLLOSLT\n\"RTN\",\"BSDX01\",218,0)\n       . ;EHS/HEH; \"UJOM*2.0*105\" ; DEC 31,2015 ; Addition [add field to check if user can cancel referral]\n\"RTN\",\"BSDX01\",219,0)\n       . SET BSDXRDAT=BSDXRDAT_U_UJOMCRF\n\"RTN\",\"BSDX01\",220,0)\n    . ;END OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"BSDX01\",221,0)\n . S BSDXI=BSDXI+1\n\"RTN\",\"BSDX01\",222,0)\n . S ^BSDXTMP($J,BSDXI)=BSDXRDAT_$C(30)\n\"RTN\",\"BSDX01\",223,0)\n S ^BSDXTMP($J,BSDXI+1)=$C(31)_BSDXERR\n\"RTN\",\"BSDX01\",224,0)\n Q\n\"RTN\",\"BSDX01\",225,0)\n ;\n\"RTN\",\"BSDX01\",226,0)\nDEPRESD(BSDXY,BSDXDUZ) ;EP Debugging entry point\n\"RTN\",\"BSDX01\",227,0)\n ;\n\"RTN\",\"BSDX01\",228,0)\n ;\n\"RTN\",\"BSDX01\",229,0)\n ;D DEBUG^%Serenji(\"DEPRES^BSDX01(.BSDXY,BSDXDUZ)\")\n\"RTN\",\"BSDX01\",230,0)\n ;\n\"RTN\",\"BSDX01\",231,0)\n Q\n\"RTN\",\"BSDX01\",232,0)\n ;\n\"RTN\",\"BSDX01\",233,0)\nDEPRES(BSDXY,BSDXDUZ) ;EP\n\"RTN\",\"BSDX01\",234,0)\n ;Called by BSDX GROUP RESOURCE\n\"RTN\",\"BSDX01\",235,0)\n ;Returns ADO Recordset with all ACTIVE GROUP/RESOURCE combinations\n\"RTN\",\"BSDX01\",236,0)\n ;to which user has access based on entries in BSDX RESOURCE USER file\n\"RTN\",\"BSDX01\",237,0)\n ;If BSDXDUZ=0 then returns all ACTIVE GROUP/RESOURCE combinations for current DUZ\n\"RTN\",\"BSDX01\",238,0)\n ;If user BSDXDUZ possesses the key BSDXZMGR or XUPROGMODE\n\"RTN\",\"BSDX01\",239,0)\n ;then ALL ACTIVE resource group names are returned\n\"RTN\",\"BSDX01\",240,0)\n ;\n\"RTN\",\"BSDX01\",241,0)\n N BSDXERR,BSDXRET,BSDXIEN,BSDXRES,BSDXDEP,BSDXDDR,BSDXDEPN,BSDXRDAT,BSDXRNOD,BSDXI\n\"RTN\",\"BSDX01\",242,0)\n N BSDXRESN,BSDXMGR,BSDXRESD,BSDXNOD,BSDXSUBID\n\"RTN\",\"BSDX01\",243,0)\n K ^BSDXTEMP($J)\n\"RTN\",\"BSDX01\",244,0)\n K ^BSDXTMP($J)\n\"RTN\",\"BSDX01\",245,0)\n S BSDXY=\"^BSDXTMP(\"_$J_\")\"\n\"RTN\",\"BSDX01\",246,0)\n S BSDXI=0\n\"RTN\",\"BSDX01\",247,0)\n S BSDXERR=\"\"\n\"RTN\",\"BSDX01\",248,0)\n S ^BSDXTMP($J,BSDXI)=\"I00020RESOURCE_GROUPID^T00030RESOURCE_GROUP^I00020RESOURCE_GROUP_ITEMID^T00030RESOURCE_NAME^I00020RESOURCEID\"_$C(30)\n\"RTN\",\"BSDX01\",249,0)\n I '+BSDXDUZ S BSDXDUZ=DUZ\n\"RTN\",\"BSDX01\",250,0)\n ;Check SECURITY KEY file for BSDXZMGR or XUPROGMODE keys\n\"RTN\",\"BSDX01\",251,0)\n S BSDXMGR=$$APSEC(\"BSDXZMGR\",BSDXDUZ)\n\"RTN\",\"BSDX01\",252,0)\n ;\n\"RTN\",\"BSDX01\",253,0)\n ;User does not have BSDXZMGR or XUPROGMODE keys, so\n\"RTN\",\"BSDX01\",254,0)\n ;$O THRU AC XREF OF BSDX RESOURCE USER\n\"RTN\",\"BSDX01\",255,0)\n I 'BSDXMGR,$D(^BSDXRSU(\"AC\",BSDXDUZ))  S BSDXIEN=0 F  S BSDXIEN=$O(^BSDXRSU(\"AC\",BSDXDUZ,BSDXIEN)) Q:'+BSDXIEN  D\n\"RTN\",\"BSDX01\",256,0)\n . S BSDXRES=$P(^BSDXRSU(BSDXIEN,0),U)\n\"RTN\",\"BSDX01\",257,0)\n . Q:'$D(^BSDXDEPT(\"AB\",BSDXRES))  ; Quit if Resource isn't part of any Group\n\"RTN\",\"BSDX01\",258,0)\n    . ;Q:'$$INDIV2(BSDXRES)  ; Quit if Resource isn't in same division as user.\n\"RTN\",\"BSDX01\",259,0)\n . S BSDXRNOD=$G(^BSDXRES(BSDXRES,0))\n\"RTN\",\"BSDX01\",260,0)\n . Q:BSDXRNOD=\"\"\n\"RTN\",\"BSDX01\",261,0)\n . ;QUIT if the resource is inactive\n\"RTN\",\"BSDX01\",262,0)\n . Q:$P(BSDXRNOD,U,2)=1\n\"RTN\",\"BSDX01\",263,0)\n . S BSDXRESN=$P(BSDXRNOD,U)\n\"RTN\",\"BSDX01\",264,0)\n . S BSDXDEP=0 F  S BSDXDEP=$O(^BSDXDEPT(\"AB\",BSDXRES,BSDXDEP)) Q:'+BSDXDEP  D\n\"RTN\",\"BSDX01\",265,0)\n . . Q:'$D(^BSDXDEPT(BSDXDEP,0))\n\"RTN\",\"BSDX01\",266,0)\n . . S BSDXDEPN=$P(^BSDXDEPT(BSDXDEP,0),U)\n\"RTN\",\"BSDX01\",267,0)\n . . S BSDXSUBID=$O(^BSDXDEPT(BSDXDEP,1,\"B\",BSDXRES,0))\n\"RTN\",\"BSDX01\",268,0)\n . . S BSDXI=BSDXI+1\n\"RTN\",\"BSDX01\",269,0)\n . . S ^BSDXTMP($J,BSDXI)=BSDXDEP_U_BSDXDEPN_U_BSDXSUBID_U_BSDXRESN_U_BSDXRES_$C(30)\n\"RTN\",\"BSDX01\",270,0)\n . Q\n\"RTN\",\"BSDX01\",271,0)\n ;\n\"RTN\",\"BSDX01\",272,0)\n ;User does have BSDXZMGR or XUPROGMODE keys, so\n\"RTN\",\"BSDX01\",273,0)\n ;$O THRU BSDX RESOURCE GROUP file directly\n\"RTN\",\"BSDX01\",274,0)\n I BSDXMGR S BSDXIEN=0 F  S BSDXIEN=$O(^BSDXDEPT(BSDXIEN)) Q:'+BSDXIEN  D\n\"RTN\",\"BSDX01\",275,0)\n . Q:'$D(^BSDXDEPT(BSDXIEN,0))\n\"RTN\",\"BSDX01\",276,0)\n . S BSDXNOD=^BSDXDEPT(BSDXIEN,0)\n\"RTN\",\"BSDX01\",277,0)\n . S BSDXDEPN=$P(BSDXNOD,U)\n\"RTN\",\"BSDX01\",278,0)\n . S BSDXRES=0 F  S BSDXRES=$O(^BSDXDEPT(BSDXIEN,1,BSDXRES)) Q:'+BSDXRES  D\n\"RTN\",\"BSDX01\",279,0)\n . . N BSDXRESD\n\"RTN\",\"BSDX01\",280,0)\n . . Q:'$D(^BSDXDEPT(BSDXIEN,1,BSDXRES,0))  ; Quit if zero node is invalid in multiple\n\"RTN\",\"BSDX01\",281,0)\n . . S BSDXRESD=$P(^BSDXDEPT(BSDXIEN,1,BSDXRES,0),\"^\")\n\"RTN\",\"BSDX01\",282,0)\n . . Q:'$D(^BSDXRES(BSDXRESD,0))  ; Quit if zero node of resouce file is invalid\n\"RTN\",\"BSDX01\",283,0)\n    . . ;Q:'$$INDIV2(BSDXRESD)  ; Quit if resource is not in the same division\n\"RTN\",\"BSDX01\",284,0)\n . . S BSDXRNOD=$G(^BSDXRES(BSDXRESD,0))\n\"RTN\",\"BSDX01\",285,0)\n . . Q:BSDXRNOD=\"\"\n\"RTN\",\"BSDX01\",286,0)\n . . ;QUIT if the resource is inactive\n\"RTN\",\"BSDX01\",287,0)\n . . Q:$P(BSDXRNOD,U,2)=1\n\"RTN\",\"BSDX01\",288,0)\n . . S BSDXRESN=$P(BSDXRNOD,U)\n\"RTN\",\"BSDX01\",289,0)\n . . S BSDXI=BSDXI+1\n\"RTN\",\"BSDX01\",290,0)\n . . S ^BSDXTMP($J,BSDXI)=BSDXIEN_U_BSDXDEPN_U_BSDXRES_U_BSDXRESN_U_BSDXRESD_$C(30)\n\"RTN\",\"BSDX01\",291,0)\n . . Q\n\"RTN\",\"BSDX01\",292,0)\n . Q\n\"RTN\",\"BSDX01\",293,0)\n ;\n\"RTN\",\"BSDX01\",294,0)\n S ^BSDXTMP($J,BSDXI+1)=$C(31)_BSDXERR\n\"RTN\",\"BSDX01\",295,0)\n Q\n\"RTN\",\"BSDX01\",296,0)\n ;\n\"RTN\",\"BSDX01\",297,0)\nAPSEC(BSDXKEY,BSDXDUZ) ;EP - Return TRUE (1) if user has keys BSDXKEY or XUPROGMODE, otherwise, returns FALSE (0)\n\"RTN\",\"BSDX01\",298,0)\n ;\n\"RTN\",\"BSDX01\",299,0)\n N BSDXIEN,BSDXPROG,BSDXPKEY\n\"RTN\",\"BSDX01\",300,0)\n I '$G(BSDXDUZ) Q 0\n\"RTN\",\"BSDX01\",301,0)\n ;\n\"RTN\",\"BSDX01\",302,0)\n ;Test for programmer mode key\n\"RTN\",\"BSDX01\",303,0)\n S BSDXPROG=0\n\"RTN\",\"BSDX01\",304,0)\n I $D(^DIC(19.1,\"B\",\"XUPROGMODE\")) D\n\"RTN\",\"BSDX01\",305,0)\n . S BSDXPKEY=$O(^DIC(19.1,\"B\",\"XUPROGMODE\",0))\n\"RTN\",\"BSDX01\",306,0)\n . I '+BSDXPKEY Q\n\"RTN\",\"BSDX01\",307,0)\n . I '$D(^VA(200,BSDXDUZ,51,BSDXPKEY,0)) Q\n\"RTN\",\"BSDX01\",308,0)\n . S BSDXPROG=1\n\"RTN\",\"BSDX01\",309,0)\n I BSDXPROG Q 1\n\"RTN\",\"BSDX01\",310,0)\n ;\n\"RTN\",\"BSDX01\",311,0)\n I BSDXKEY=\"\" Q 0\n\"RTN\",\"BSDX01\",312,0)\n I '$D(^DIC(19.1,\"B\",BSDXKEY)) Q 0\n\"RTN\",\"BSDX01\",313,0)\n S BSDXIEN=$O(^DIC(19.1,\"B\",BSDXKEY,0))\n\"RTN\",\"BSDX01\",314,0)\n I '+BSDXIEN Q 0\n\"RTN\",\"BSDX01\",315,0)\n I '$D(^VA(200,BSDXDUZ,51,BSDXIEN,0)) Q 0\n\"RTN\",\"BSDX01\",316,0)\n Q 1\n\"RTN\",\"BSDX01\",317,0)\nSP(BSDXY,PARAM,YESNO) ; Save Param at User Level - EP\n\"RTN\",\"BSDX01\",318,0)\n ; Called by RPC: BSDX SET PARAM\n\"RTN\",\"BSDX01\",319,0)\n ; Input:\n\"RTN\",\"BSDX01\",320,0)\n ; - Param: Name of Parameter (prog name of course)\n\"RTN\",\"BSDX01\",321,0)\n ; - Yes/No: 1 or 0\n\"RTN\",\"BSDX01\",322,0)\n ; Output: Error Code as string; 0 is good\n\"RTN\",\"BSDX01\",323,0)\n ;\n\"RTN\",\"BSDX01\",324,0)\n ; Security Protection\n\"RTN\",\"BSDX01\",325,0)\n IF $EXTRACT(PARAM,1,4)'=\"BSDX\" S BSDXY=\"-1^BSDX Params only allowed\" QUIT\n\"RTN\",\"BSDX01\",326,0)\n ;\n\"RTN\",\"BSDX01\",327,0)\n N ERROR\n\"RTN\",\"BSDX01\",328,0)\n D PUT^XPAR(\"USR\",PARAM,1,YESNO,.ERROR)\n\"RTN\",\"BSDX01\",329,0)\n S BSDXY=$G(ERROR)\n\"RTN\",\"BSDX01\",330,0)\n QUIT\n\"RTN\",\"BSDX01\",331,0)\n ;\n\"RTN\",\"BSDX01\",332,0)\nGP(BSDXY,PARAM) ; Get Param - EP\n\"RTN\",\"BSDX01\",333,0)\n ; Called by RPC: BSDX GET PARAM\n\"RTN\",\"BSDX01\",334,0)\n ; Input: Name of Parameter\n\"RTN\",\"BSDX01\",335,0)\n ; Output: Value of parameter: 0 or 1, for now.\n\"RTN\",\"BSDX01\",336,0)\n ;\n\"RTN\",\"BSDX01\",337,0)\n S BSDXY=$$GET^XPAR(\"USR^LOC^SYS^PKG\",PARAM,1,\"I\")\n\"RTN\",\"BSDX01\",338,0)\n QUIT\n\"RTN\",\"BSDX01\",339,0)\n ;\n\"RTN\",\"BSDX01\",340,0)\nINDIV(BSDXSC) ; PEP - Is ^SC clinic in the same DUZ(2) as user?\n\"RTN\",\"BSDX01\",341,0)\n ; Input: BSDXSC - Hospital Location IEN\n\"RTN\",\"BSDX01\",342,0)\n ; Output: True or False\n\"RTN\",\"BSDX01\",343,0)\n I '+BSDXSC QUIT 1  ;If not tied to clinic, yes\n\"RTN\",\"BSDX01\",344,0)\n I '$D(^SC(BSDXSC,0)) QUIT 1 ; If Clinic does not exist, yes\n\"RTN\",\"BSDX01\",345,0)\n ; Jump to Division:Medical Center Division:Inst File Pointer for\n\"RTN\",\"BSDX01\",346,0)\n ; Institution IEN (and get its internal value)\n\"RTN\",\"BSDX01\",347,0)\n N DIV S DIV=$$GET1^DIQ(44,BSDXSC_\",\",\"3.5:.07\",\"I\")\n\"RTN\",\"BSDX01\",348,0)\n I DIV=\"\" Q 1 ; If clinic has no division, consider it avial to user.\n\"RTN\",\"BSDX01\",349,0)\n I DIV=DUZ(2) Q 1 ; If same, then User is in same Div as Clinic\n\"RTN\",\"BSDX01\",350,0)\n E  Q 0 ; Otherwise, no\n\"RTN\",\"BSDX01\",351,0)\nINDIV2(BSDXRES) ; PEP - Is Resource in the same DUZ(2) as user?\n\"RTN\",\"BSDX01\",352,0)\n ; Input BSDXRES - BSDX RESOURCE IEN\n\"RTN\",\"BSDX01\",353,0)\n ; Output: True of False\n\"RTN\",\"BSDX01\",354,0)\n Q $$INDIV($P($G(^BSDXRES(BSDXRES,0)),U,4)) ; Extract Hospital Location and send to $$INDIV\n\"RTN\",\"BSDX01\",355,0)\nUTINDIV ; Unit Test $$INDIV\n\"RTN\",\"BSDX01\",356,0)\n W \"Testing if they are the same\",!\n\"RTN\",\"BSDX01\",357,0)\n S DUZ(2)=67\n\"RTN\",\"BSDX01\",358,0)\n I '$$INDIV(1) W \"ERROR\",!\n\"RTN\",\"BSDX01\",359,0)\n I '$$INDIV(2) W \"ERROR\",!\n\"RTN\",\"BSDX01\",360,0)\n W \"Testing if Div not defined in 44, should be true\",!\n\"RTN\",\"BSDX01\",361,0)\n I '$$INDIV(3) W \"ERROR\",!\n\"RTN\",\"BSDX01\",362,0)\n W \"Testing empty string. Should be true\",!\n\"RTN\",\"BSDX01\",363,0)\n I '$$INDIV(\"\") W \"ERROR\",!\n\"RTN\",\"BSDX01\",364,0)\n W \"Testing if they are different\",!\n\"RTN\",\"BSDX01\",365,0)\n S DUZ(2)=899\n\"RTN\",\"BSDX01\",366,0)\n I $$INDIV(1) W \"ERROR\",!\n\"RTN\",\"BSDX01\",367,0)\n I $$INDIV(2) W \"ERROR\",!\n\"RTN\",\"BSDX01\",368,0)\n QUIT\n\"RTN\",\"BSDX01\",369,0)\nUTINDIV2 ; Unit Test $$INDIV2\n\"RTN\",\"BSDX01\",370,0)\n W \"Testing if they are the same\",!\n\"RTN\",\"BSDX01\",371,0)\n S DUZ(2)=69\n\"RTN\",\"BSDX01\",372,0)\n I $$INDIV2(22)'=0 W \"ERROR\",!\n\"RTN\",\"BSDX01\",373,0)\n I $$INDIV2(25)'=1 W \"ERROR\",!\n\"RTN\",\"BSDX01\",374,0)\n I $$INDIV2(26)'=1 W \"ERROR\",!\n\"RTN\",\"BSDX01\",375,0)\n I $$INDIV2(27)'=1 W \"ERROR\",!\n\"RTN\",\"BSDX01\",376,0)\n QUIT\n\"RTN\",\"BSDX01\",377,0)\n ;\n\"RTN\",\"BSDX01\",378,0)\nGETRADEX(BSDXY,DFN,SCIEN) ; Get All Pending and On Hold Radiology Exams for Patient; RPC EP; UJO/SMH new in v 1.6\n\"RTN\",\"BSDX01\",379,0)\n ; RPC: BSDX GET RAD EXAM FOR PT; Return: Global Array\n\"RTN\",\"BSDX01\",380,0)\n ;\n\"RTN\",\"BSDX01\",381,0)\n ; Input: DFN - you should know; SCIEN - IEN of Hospital Location\n\"RTN\",\"BSDX01\",382,0)\n ; Output: ADO Datatable with the following columns:\n\"RTN\",\"BSDX01\",383,0)\n ; - BMXIEN: Radiology Exam IEN in file 75.1 (RAD/NUC MED ORDERS)\n\"RTN\",\"BSDX01\",384,0)\n ; - STATUS: Pending Or Hold Status\n\"RTN\",\"BSDX01\",385,0)\n ; - PROCEDURE: Text Procedure Name\n\"RTN\",\"BSDX01\",386,0)\n ; - REQUEST_DATE: Date Procedure was requested\n\"RTN\",\"BSDX01\",387,0)\n ;\n\"RTN\",\"BSDX01\",388,0)\n ; Error Processing: Silent failure. \n\"RTN\",\"BSDX01\",389,0)\n ;\n\"RTN\",\"BSDX01\",390,0)\n S BSDXY=$NA(^BMXTEMP($J))\n\"RTN\",\"BSDX01\",391,0)\n K @BSDXY\n\"RTN\",\"BSDX01\",392,0)\n ;\n\"RTN\",\"BSDX01\",393,0)\n N BSDXI S BSDXI=0\n\"RTN\",\"BSDX01\",394,0)\n S @BSDXY@(BSDXI)=\"I00015BMXIEN^T00015STATUS^T00100PROCEDURE^D00030REQUEST_DATE\"_$C(30)\n\"RTN\",\"BSDX01\",395,0)\n ;\n\"RTN\",\"BSDX01\",396,0)\n N BSDXRLIEN S BSDXRLIEN=$ORDER(^RA(79.1,\"B\",SCIEN,\"\"))  ; IEN of HL in file 79.1, to get Radiology Imaging IEN\n\"RTN\",\"BSDX01\",397,0)\n I 'BSDXRLIEN GOTO END\n\"RTN\",\"BSDX01\",398,0)\n ;\n\"RTN\",\"BSDX01\",399,0)\n N BSDXOUT,BSDXERR ; Out, Error\n\"RTN\",\"BSDX01\",400,0)\n ;\n\"RTN\",\"BSDX01\",401,0)\n ; File 75.1 = RAD/NUC MED ORDERS\n\"RTN\",\"BSDX01\",402,0)\n ; Fields 5 = Request Status; 2 = Procedure; 16 = Requested Entered Date Time\n\"RTN\",\"BSDX01\",403,0)\n ; Filter Field: First piece is DFN, 5th piece is 3 or 5 (Status of Pending Or Hold); 20th piece is Radiology Location requested\n\"RTN\",\"BSDX01\",404,0)\n        ;;EHS/MKH,BAH;;BSDX 1.7;;30/09/2012;; Update [Fix the performance issue in SchedGUI]\n\"RTN\",\"BSDX01\",405,0)\n        ; START OF CODE CHANGES FOR [BSDX 1.7]\n\"RTN\",\"BSDX01\",406,0)\n        ; Commented old Line\n\"RTN\",\"BSDX01\",407,0)\n        ;D LIST^DIC(75.1,\"\",\"@;5;2;16\",\"P\",\"\",\"\",\"\",\"B\",\"I $P(^(0),U)=DFN&(35[$P(^(0),U,5))&($P(^(0),U,20)=BSDXRLIEN)\",\"\",\"BSDXOUT\",\"BSDXE>>RR\")\n\"RTN\",\"BSDX01\",408,0)\n        DO FIND^DIC(75.1,\"\",\"@;5;2;16\",\"QP\",DFN,\"\",\"B\",\"IF 35[$PIECE(^(0),U,5)&($PIECE(^(0),U,20)=BSDXRLIEN)\",\"\",\"BSDXOUT\",\"BSDXERR\")\n\"RTN\",\"BSDX01\",409,0)\n        ; END OF CODE CHANGES FOR [BSDX 1.7]\n\"RTN\",\"BSDX01\",410,0)\n ;\n\"RTN\",\"BSDX01\",411,0)\n IF $DATA(BSDXERR) GOTO END\n\"RTN\",\"BSDX01\",412,0)\n ;\n\"RTN\",\"BSDX01\",413,0)\n I +BSDXOUT(\"DILIST\",0)>0 FOR BSDXI=1:1:+BSDXOUT(\"DILIST\",0) DO  ; if we have data, fetch the data in each row and store it in the return variable\n\"RTN\",\"BSDX01\",414,0)\n . N BMXIEN,BMXSTAUS,BMXPROC,BMXDATE ; Proc IEN, Proc Status, Proc Name\n\"RTN\",\"BSDX01\",415,0)\n . S BMXIEN=$P(BSDXOUT(\"DILIST\",BSDXI,0),U) ; IEN\n\"RTN\",\"BSDX01\",416,0)\n . S BMXSTATUS=$P(BSDXOUT(\"DILIST\",BSDXI,0),U,2) ; Status\n\"RTN\",\"BSDX01\",417,0)\n . S BMXPROC=$P(BSDXOUT(\"DILIST\",BSDXI,0),U,3) ; Procedure Name\n\"RTN\",\"BSDX01\",418,0)\n . S BMXDATE=$TR($P(BSDXOUT(\"DILIST\",BSDXI,0),U,4),\"@\",\" \") ; Request Entered Date Time\n\"RTN\",\"BSDX01\",419,0)\n . S @BSDXY@(BSDXI)=BMXIEN_U_BMXSTATUS_U_BMXPROC_U_BMXDATE_$C(30)\n\"RTN\",\"BSDX01\",420,0)\nEND ; Errors Jump Here...\n\"RTN\",\"BSDX01\",421,0)\n S @BSDXY@(BSDXI+1)=$C(31)\n\"RTN\",\"BSDX01\",422,0)\n QUIT\n\"RTN\",\"BSDX01\",423,0)\n ;\n\"RTN\",\"BSDX01\",424,0)\nSCHRAEX(BSDXY,RADFN,RAOIFN,RAOSCH) ; Schedule a Radiology Exam; RPC EP; UJO/SMH new in v 1.6\n\"RTN\",\"BSDX01\",425,0)\n ; RPC: BSDX SCHEDULE RAD EXAM; Return: Single Value\n\"RTN\",\"BSDX01\",426,0)\n ;\n\"RTN\",\"BSDX01\",427,0)\n ; Input: \n\"RTN\",\"BSDX01\",428,0)\n ; - RADFN -> DFN\n\"RTN\",\"BSDX01\",429,0)\n ; - RAOIFN -> Radiology Order IEN in file 75.1\n\"RTN\",\"BSDX01\",430,0)\n ; - RAOSCH -> Scheduled Time for Exam\n\"RTN\",\"BSDX01\",431,0)\n ; Output: Always \"1\"\n\"RTN\",\"BSDX01\",432,0)\n ;\n\"RTN\",\"BSDX01\",433,0)\n S RAOSCH=+RAOSCH ; Strip the trailing zeros from the Fileman Date produced by C#\n\"RTN\",\"BSDX01\",434,0)\n N RAOSTS S RAOSTS=8  ; Status of Scheduled\n\"RTN\",\"BSDX01\",435,0)\n D ^RAORDU  ; API in Rad expects RADFN, RAOIFN, RAOSCH, and RAOSTS\n\"RTN\",\"BSDX01\",436,0)\n S BSDXY=1 ; Success\n\"RTN\",\"BSDX01\",437,0)\n QUIT\n\"RTN\",\"BSDX01\",438,0)\n ;\n\"RTN\",\"BSDX01\",439,0)\nHOLDRAEX(BSDXY,RADFN,RAOIFN) ; Hold a Radiology Exam; RPC EP; UJO/SMH new in v 1.6\n\"RTN\",\"BSDX01\",440,0)\n ; RPC: BSDX HOLD RAD EXAM; Return: Single Value\n\"RTN\",\"BSDX01\",441,0)\n ;\n\"RTN\",\"BSDX01\",442,0)\n ; Input:\n\"RTN\",\"BSDX01\",443,0)\n ; - RADFN -> DFN\n\"RTN\",\"BSDX01\",444,0)\n ; - RAOIFN -> Radiology Order IEN in file 75.1\n\"RTN\",\"BSDX01\",445,0)\n ; Output: 1 OR 0 for success or failure.\n\"RTN\",\"BSDX01\",446,0)\n ; Can we hold?\n\"RTN\",\"BSDX01\",447,0)\n N CANHOLD\n\"RTN\",\"BSDX01\",448,0)\n D CANHOLD(.CANHOLD,RAOIFN)\n\"RTN\",\"BSDX01\",449,0)\n I 'CANHOLD S BSDXY=0 QUIT\n\"RTN\",\"BSDX01\",450,0)\n ;\n\"RTN\",\"BSDX01\",451,0)\n N RAOSTS S RAOSTS=3  ; Status of Hold\n\"RTN\",\"BSDX01\",452,0)\n N RAOREA ; Reason, stored in file 75.2\n\"RTN\",\"BSDX01\",453,0)\n I $D(^RA(75.2,100)) S RAOREA=100  ; Custom site Reason\n\"RTN\",\"BSDX01\",454,0)\n E  I $D(^RA(75.2,20))  S RAOREA=20 ; Reason: Exam Cancelled\n\"RTN\",\"BSDX01\",455,0)\n E   ; Else is empty. I won't set RAOREA at all.\n\"RTN\",\"BSDX01\",456,0)\n D ^RAORDU\n\"RTN\",\"BSDX01\",457,0)\n S BSDXY=1 ; Success\n\"RTN\",\"BSDX01\",458,0)\n QUIT\n\"RTN\",\"BSDX01\",459,0)\n ;\n\"RTN\",\"BSDX01\",460,0)\nCANHOLD(BSDXY,RAOIFN) ; Can we hold this Exam? RPC EP; UJO/SMH new in 1.6\n\"RTN\",\"BSDX01\",461,0)\n ; RPC: BSDX CAN HOLD RAD EXAM; Return: Single Value\n\"RTN\",\"BSDX01\",462,0)\n ;\n\"RTN\",\"BSDX01\",463,0)\n ; Input:\n\"RTN\",\"BSDX01\",464,0)\n ; - RAOIFN -> Radiology Order IEN in file 75.1\n\"RTN\",\"BSDX01\",465,0)\n ; Output: 0 or 1 for false or true\n\"RTN\",\"BSDX01\",466,0)\n ;\n\"RTN\",\"BSDX01\",467,0)\n N STATUS S STATUS=$$GET1^DIQ(75.1,RAOIFN,\"REQUEST STATUS\",\"I\")\n\"RTN\",\"BSDX01\",468,0)\n ; 1 = discontinued; 2 = Complete; 6 = Active\n\"RTN\",\"BSDX01\",469,0)\n ; if any one of these, cannot hold exam; otherwise, we can\n\"RTN\",\"BSDX01\",470,0)\n I 126[STATUS S BSDXY=0 QUIT\n\"RTN\",\"BSDX01\",471,0)\n ELSE  S BSDXY=1 QUIT\n\"RTN\",\"BSDX01\",472,0)\n QUIT\n\"RTN\",\"BSDX02\")\n0^9^B55079780\n\"RTN\",\"BSDX02\",1,0)\nBSDX02 ; IHS/OIT/HMW - WINDOWS SCHEDULING RPCS ; 3/7/22 11:23am\n\"RTN\",\"BSDX02\",2,0)\n ;;1.7T2;BSDX;;Jul 11, 2012;Build 11\n\"RTN\",\"BSDX02\",3,0)\n ;Licensed under LGPL \n\"RTN\",\"BSDX02\",4,0)\n ; Change Log\n\"RTN\",\"BSDX02\",5,0)\n ; July 15 2010: UJO/SMH - Pass FM dates in instead of US dates for i18n\n\"RTN\",\"BSDX02\",6,0)\n ; March 21 2011: UJO/SMH (v 1.5) - Return new fields: Patient SEX, PID, and DOB\n\"RTN\",\"BSDX02\",7,0)\n ; April 11 2011: UJO/SMH (v 1.6) - Added Radiology Exam Field, to retrieve Radiology Exam associated with appt\n\"RTN\",\"BSDX02\",8,0)\n ;\n\"RTN\",\"BSDX02\",9,0)\n ;\n\"RTN\",\"BSDX02\",10,0)\nCRSCHD(BSDXY,BSDXRES,BSDXSTART,BSDXEND) ;EP\n\"RTN\",\"BSDX02\",11,0)\n ;Entry point for debugging\n\"RTN\",\"BSDX02\",12,0)\n ;\n\"RTN\",\"BSDX02\",13,0)\n ;D DEBUG^%Serenji(\"CRSCH^BSDX02(.BSDXY,BSDXRES,BSDXSTART,BSDXEND)\")\n\"RTN\",\"BSDX02\",14,0)\n Q\n\"RTN\",\"BSDX02\",15,0)\n ;\n\"RTN\",\"BSDX02\",16,0)\nCRSCH(BSDXY,BSDXRES,BSDXSTART,BSDXEND,BSDXWKIN)     ;\n\"RTN\",\"BSDX02\",17,0)\n ;Called by BSDX CREATE APPT SCHEDULE\n\"RTN\",\"BSDX02\",18,0)\n ;Create Resource Appointment Schedule recordset\n\"RTN\",\"BSDX02\",19,0)\n ;On error, returns 0 in APPOINTMENTID field and error text in NOTE field\n\"RTN\",\"BSDX02\",20,0)\n ;\n\"RTN\",\"BSDX02\",21,0)\n ;$O Thru ^BSDXAPPT(\"ARSRC\", RESOURCE, STARTTIME, APPTID)\n\"RTN\",\"BSDX02\",22,0)\n ;BMXRES is a | delimited list of resource names\n\"RTN\",\"BSDX02\",23,0)\n ;BSDXWKIN - If 1, then return walkins, otherwise skip them\n\"RTN\",\"BSDX02\",24,0)\n ;9-27-2004 Added walkin to returned datatable\n\"RTN\",\"BSDX02\",25,0)\n ;TODO: Change BSDXRES from names to IDs\n\"RTN\",\"BSDX02\",26,0)\n ;\n\"RTN\",\"BSDX02\",27,0)\n N BSDXERR,BSDXIEN,BSDXDEPD,BSDXDEPN,BSDXRESD,BSDXI,BSDXJ,BSDXRESN,BSDXS,BSDXAD,BSDXZ,BSDXQ,BSDXNOD\n\"RTN\",\"BSDX02\",28,0)\n N BSDXPAT,BSDXNOT,BSDXZPCD,BSDXPCD\n\"RTN\",\"BSDX02\",29,0)\n K ^BSDXTMP($J)\n\"RTN\",\"BSDX02\",30,0)\n S BSDXERR=\"\"\n\"RTN\",\"BSDX02\",31,0)\n S BSDXY=\"^BSDXTMP(\"_$J_\")\"\n\"RTN\",\"BSDX02\",32,0)\n S ^BSDXTMP($J,0)=\"I00020APPOINTMENTID^D00030START_TIME^D00030END_TIME^D00030CHECKIN^D00030AUXTIME^I00020PATIENTID^T00030PATIENTNAME^T00030RESOURCENAME\"\n\"RTN\",\"BSDX02\",33,0)\n    ;\n\"RTN\",\"BSDX02\",34,0)\n   ;EHS/MOK ;UJOM*2.1*243 ; OCT 30,2023 ;rollback [rollback specific code for moh This change come from UJOM*2.0*105]\n\"RTN\",\"BSDX02\",35,0)\n ; EHS/AYG; \"UJO*2.0*61\" ; Dec 4,2013 ; Update [Scheduling GUI 1.12.0 new features]\n\"RTN\",\"BSDX02\",36,0)\n    ; 1-Reflect appointment Checked out status when checked out: Adding the Checked out status to the returned array.\n\"RTN\",\"BSDX02\",37,0)\n    ; 2-Reflect appointment (First,Follow-up) status.: Adding the appointment (First,Follow-up) status.\n\"RTN\",\"BSDX02\",38,0)\n    ;\n\"RTN\",\"BSDX02\",39,0)\n ; START OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"BSDX02\",40,0)\n ; START OF OLD CODE\n\"RTN\",\"BSDX02\",41,0)\n ;S ^(0)=^(0)_\"^I00005NOSHOW^T00020HRN^I00005ACCESSTYPEID^I00005WALKIN^T00250NOTE^T00006SEX^T00040PID^D00030DOB^I00020RADIOLOGY_EXAM\"_$C(30)\n\"RTN\",\"BSDX02\",42,0)\n ; END OF OLD CODE\n\"RTN\",\"BSDX02\",43,0)\n ; START OF NEW CODE\n\"RTN\",\"BSDX02\",44,0)\n    ;EHS/SOS ;UJO*2.1*151; MAR 07,2022; Update [Adding the Billing status to the returned array.]\n\"RTN\",\"BSDX02\",45,0)\n    ;scope: Scheduling\n\"RTN\",\"BSDX02\",46,0)\n    ;justification: Adding the Billing status to the returned array.\n\"RTN\",\"BSDX02\",47,0)\n    ;reviwed by: Ahmad Sharaf\n\"RTN\",\"BSDX02\",48,0)\n ;SET ^(0)=^(0)_\"^I00005NOSHOW^T00020HRN^I00005ACCESSTYPEID^I00005WALKIN^T00250NOTE^T00006SEX^T00040PID^D00030DOB^I00020RADIOLOGY_EXAM^T00030CHECKED_OUT^T00030APPT_TYPE\"_$C(30)\n\"RTN\",\"BSDX02\",49,0)\n    ;SET ^(0)=^(0)_\"^I00005NOSHOW^T00020HRN^I00005ACCESSTYPEID^I00005WALKIN^T00250NOTE^T00006SEX^T00040PID^D00030DOB^I00020RADIOLOGY_EXAM^T00030CHECKED_OUT^T00030APPT_TYPE^T00030BILLINGSTATUS\"_$C(30)\n\"RTN\",\"BSDX02\",50,0)\n SET ^(0)=^(0)_\"^I00005NOSHOW^T00020HRN^I00005ACCESSTYPEID^I00005WALKIN^T00250NOTE^T00006SEX^T00040PID^D00030DOB^I00020RADIOLOGY_EXAM^T00030CHECKED_OUT^T00030APPT_TYPE^T00030BILLINGSTATUS^T00030REFERRAL^T00030MADEBY\"_$C(30)\n\"RTN\",\"BSDX02\",51,0)\n ; END OF NEW CODE\n\"RTN\",\"BSDX02\",52,0)\n ; END OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"BSDX02\",53,0)\n DO ^XBKVAR S X=\"ETRAP^BSDX02\",@^%ZOSF(\"TRAP\")\n\"RTN\",\"BSDX02\",54,0)\n ;\n\"RTN\",\"BSDX02\",55,0)\n ; S %DT=\"T\",X=BSDXSTART D ^%DT S BSDXSTART=Y\n\"RTN\",\"BSDX02\",56,0)\n ; I BSDXSTART=-1 S ^BSDXTMP($J,1)=$C(31) Q\n\"RTN\",\"BSDX02\",57,0)\n ; S %DT=\"T\",X=BSDXEND D ^%DT S BSDXEND=Y\n\"RTN\",\"BSDX02\",58,0)\n ; I BSDXEND=-1 S ^BSDXTMP($J,1)=$C(31) Q\n\"RTN\",\"BSDX02\",59,0)\n ;\n\"RTN\",\"BSDX02\",60,0)\n SET BSDXI=0\n\"RTN\",\"BSDX02\",61,0)\n DO STRES\n\"RTN\",\"BSDX02\",62,0)\n ;\n\"RTN\",\"BSDX02\",63,0)\n SET BSDXI=BSDXI+1\n\"RTN\",\"BSDX02\",64,0)\n SET ^BSDXTMP($J,BSDXI)=$C(31)\n\"RTN\",\"BSDX02\",65,0)\n QUIT\n\"RTN\",\"BSDX02\",66,0)\n ;\n\"RTN\",\"BSDX02\",67,0)\nSTRES ;\n\"RTN\",\"BSDX02\",68,0)\n F BSDXJ=1:1:$L(BSDXRES,\"|\") S BSDXRESN=$P(BSDXRES,\"|\",BSDXJ) D\n\"RTN\",\"BSDX02\",69,0)\n . Q:BSDXRESN=\"\"\n\"RTN\",\"BSDX02\",70,0)\n . Q:'$D(^BSDXRES(\"B\",BSDXRESN))\n\"RTN\",\"BSDX02\",71,0)\n . S BSDXRESD=$O(^BSDXRES(\"B\",BSDXRESN,0))\n\"RTN\",\"BSDX02\",72,0)\n . Q:'+BSDXRESD\n\"RTN\",\"BSDX02\",73,0)\n . Q:'$D(^BSDXAPPT(\"ARSRC\",BSDXRESD))\n\"RTN\",\"BSDX02\",74,0)\n . S BSDXS=BSDXSTART-.0001\n\"RTN\",\"BSDX02\",75,0)\n . F  S BSDXS=$O(^BSDXAPPT(\"ARSRC\",BSDXRESD,BSDXS)) Q:'+BSDXS  Q:BSDXS>BSDXEND  D\n\"RTN\",\"BSDX02\",76,0)\n . . S BSDXAD=0 F  S BSDXAD=$O(^BSDXAPPT(\"ARSRC\",BSDXRESD,BSDXS,BSDXAD)) Q:'+BSDXAD  D STCOMM(BSDXAD,BSDXRESN)\n\"RTN\",\"BSDX02\",77,0)\n Q\n\"RTN\",\"BSDX02\",78,0)\n ;\n\"RTN\",\"BSDX02\",79,0)\nSTCOMM(BSDXAD,BSDXRESN)      ;\n\"RTN\",\"BSDX02\",80,0)\n ;BSDXAD is the appointment IEN\n\"RTN\",\"BSDX02\",81,0)\n N BSDXC,BSDXQ,BSDXZ,BSDXSUBC,BSDXHRN,BSDXPATD,BSDXATID,BSDXISWK\n\"RTN\",\"BSDX02\",82,0)\n Q:'$D(^BSDXAPPT(BSDXAD,0))\n\"RTN\",\"BSDX02\",83,0)\n S BSDXNOD=^BSDXAPPT(BSDXAD,0)\n\"RTN\",\"BSDX02\",84,0)\n Q:$P(BSDXNOD,U,12)]\"\"  ;CANCELLED\n\"RTN\",\"BSDX02\",85,0)\n S BSDXISWK=0\n\"RTN\",\"BSDX02\",86,0)\n S:$P(BSDXNOD,U,13)=\"y\" BSDXISWK=1\n\"RTN\",\"BSDX02\",87,0)\n I +$G(BSDXWKIN) Q:BSDXISWK  ;Don't return walkins if appt is WALKIN and BSDXWKIN is 1\n\"RTN\",\"BSDX02\",88,0)\n S BSDXZ=BSDXAD_\"^\"\n\"RTN\",\"BSDX02\",89,0)\n F BSDXQ=1:1:4 D\n\"RTN\",\"BSDX02\",90,0)\n . S Y=$P(BSDXNOD,U,BSDXQ)\n\"RTN\",\"BSDX02\",91,0)\n . X ^DD(\"DD\") S Y=$TR(Y,\"@\",\" \")\n\"RTN\",\"BSDX02\",92,0)\n . S BSDXZ=BSDXZ_Y_\"^\"\n\"RTN\",\"BSDX02\",93,0)\n S BSDXPATD=$P(BSDXNOD,U,5)\n\"RTN\",\"BSDX02\",94,0)\n S BSDXZ=BSDXZ_BSDXPATD_\"^\" ;PATIENT ID\n\"RTN\",\"BSDX02\",95,0)\n S BSDXPAT=\"\"\n\"RTN\",\"BSDX02\",96,0)\n I BSDXPATD]\"\",$D(^DPT(BSDXPATD,0)) S BSDXPAT=$P(^DPT(BSDXPATD,0),U)\n\"RTN\",\"BSDX02\",97,0)\n S BSDXZ=BSDXZ_BSDXPAT_\"^\" ;PATIENT NAME\n\"RTN\",\"BSDX02\",98,0)\n S BSDXZ=BSDXZ_BSDXRESN_\"^\" ;RESOURCENAME\n\"RTN\",\"BSDX02\",99,0)\n S BSDXZ=BSDXZ_+$P(BSDXNOD,U,10)_\"^\" ;NOSHOW\n\"RTN\",\"BSDX02\",100,0)\n S BSDXHRN=\"\"\n\"RTN\",\"BSDX02\",101,0)\n I $D(DUZ(2)),DUZ(2)>0 S BSDXHRN=$P($G(^AUPNPAT(BSDXPATD,41,DUZ(2),0)),U,2) ;HRN\n\"RTN\",\"BSDX02\",102,0)\n S BSDXZ=BSDXZ_BSDXHRN_\"^\"\n\"RTN\",\"BSDX02\",103,0)\n S BSDXATID=$P(BSDXNOD,U,6)\n\"RTN\",\"BSDX02\",104,0)\n S:'+BSDXATID BSDXATID=0 ;UNKNOWN TYPE\n\"RTN\",\"BSDX02\",105,0)\n S BSDXZ=BSDXZ_BSDXATID_\"^\"_BSDXISWK_\"^\"\n\"RTN\",\"BSDX02\",106,0)\n S BSDXI=BSDXI+1\n\"RTN\",\"BSDX02\",107,0)\n S ^BSDXTMP($J,BSDXI)=BSDXZ\n\"RTN\",\"BSDX02\",108,0)\n ;NOTE\n\"RTN\",\"BSDX02\",109,0)\n S BSDXNOT=\"\",BSDXQ=0 F  S BSDXQ=$O(^BSDXAPPT(BSDXAD,1,BSDXQ)) Q:'+BSDXQ  D\n\"RTN\",\"BSDX02\",110,0)\n . S BSDXNOT=$G(^BSDXAPPT(BSDXAD,1,BSDXQ,0))\n\"RTN\",\"BSDX02\",111,0)\n . S:$E(BSDXNOT,$L(BSDXNOT)-1,$L(BSDXNOT))'=\" \" BSDXNOT=BSDXNOT_\" \"\n\"RTN\",\"BSDX02\",112,0)\n . S BSDXI=BSDXI+1\n\"RTN\",\"BSDX02\",113,0)\n . S ^BSDXTMP($J,BSDXI)=BSDXNOT\n\"RTN\",\"BSDX02\",114,0)\n S ^BSDXTMP($J,BSDXI)=^BSDXTMP($J,BSDXI)_U ; Add \"^\" to separate note from next fields.\n\"RTN\",\"BSDX02\",115,0)\n S BSDXI=BSDXI+1\n\"RTN\",\"BSDX02\",116,0)\n ; new code for V1.5. Extra fields to return.\n\"RTN\",\"BSDX02\",117,0)\n N SEX S SEX=$$GET1^DIQ(2,BSDXPATD,.02)  ; SEX\n\"RTN\",\"BSDX02\",118,0)\n N PID S PID=$$GET1^DIQ(2,BSDXPATD,.363) ; PRIMARY LONG ID\n\"RTN\",\"BSDX02\",119,0)\n ; Note strange way I retrieve the value. B/c DOB Output Transform\n\"RTN\",\"BSDX02\",120,0)\n ; Outputs it in MM/DD/YYYY format, which is ambigous for C#.\n\"RTN\",\"BSDX02\",121,0)\n N DOB S DOB=$$FMTE^XLFDT($$GET1^DIQ(2,BSDXPATD,.03,\"I\"))  ; DOB\n\"RTN\",\"BSDX02\",122,0)\n N RADEX S RADEX=$P(BSDXNOD,U,14) ;Radiology exam\n\"RTN\",\"BSDX02\",123,0)\n ; EHS/AYG; \"UJO*2.0*61\" ; Dec 4,2013 ; Addition [Scheduling GUI 1.12.0 new features]\n\"RTN\",\"BSDX02\",124,0)\n    ; 1-Reflect appointment Checked out status when checked out: Adding the Checked out status to the returned array.\n\"RTN\",\"BSDX02\",125,0)\n    ; 2-Reflect appointment (First,Follow-up) status.: Adding the appointment (First,Follow-up) status.\n\"RTN\",\"BSDX02\",126,0)\n    ;\n\"RTN\",\"BSDX02\",127,0)\n ; START OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"BSDX02\",128,0)\n ; START OF OLD CODE\n\"RTN\",\"BSDX02\",129,0)\n ;S ^BSDXTMP($J,BSDXI)=SEX_U_PID_U_DOB_U_RADEX_$C(30)\n\"RTN\",\"BSDX02\",130,0)\n ; END OF OLD CODE\n\"RTN\",\"BSDX02\",131,0)\n ; START OF NEW CODE\n\"RTN\",\"BSDX02\",132,0)\n    ;\n\"RTN\",\"BSDX02\",133,0)\n    ;CHECKOUT: Check out status, 1:checked out 0:not checked out.\n\"RTN\",\"BSDX02\",134,0)\n    ;APPSDT: Appointment Start date.\n\"RTN\",\"BSDX02\",135,0)\n    ;APPTTYPE: appointment (First,Follow-up) status, 1:First Appointment 2:Follow Appointment.\n\"RTN\",\"BSDX02\",136,0)\n NEW CHECKOUT,APPSDT,APPTTYPE\n\"RTN\",\"BSDX02\",137,0)\n SET APPSDT=$PIECE(BSDXNOD,U)\n\"RTN\",\"BSDX02\",138,0)\n SET CHECKOUT=\"0\"\n\"RTN\",\"BSDX02\",139,0)\n SET:$$GET1^DIQ(2.98,APPSDT_\",\"_BSDXPATD,100)=\"CHECKED OUT\" CHECKOUT=\"1\"\n\"RTN\",\"BSDX02\",140,0)\n    ;\n\"RTN\",\"BSDX02\",141,0)\n    SET APPTTYPE=\"0\"\n\"RTN\",\"BSDX02\",142,0)\n    SET:$$GET1^DIQ(9002018.4,BSDXAD_\",\",400000000)=\"YES\" APPTTYPE=\"1\"\n\"RTN\",\"BSDX02\",143,0)\n    ;EHS/SOS ;UJO*2.1*151; MAR 07,2022; Update [Adding the Billing status to the returned array.]\n\"RTN\",\"BSDX02\",144,0)\n    ;scope: Scheduling\n\"RTN\",\"BSDX02\",145,0)\n    ;justification: Adding the Billing status to the returned array.\n\"RTN\",\"BSDX02\",146,0)\n    ;reviwed by: Ahmad Sharaf\n\"RTN\",\"BSDX02\",147,0)\n    ;START OF CODE CHANGES FOR ; UJO*2.1*151\n\"RTN\",\"BSDX02\",148,0)\n ;SET ^BSDXTMP($J,BSDXI)=SEX_U_PID_U_DOB_U_RADEX_U_CHECKOUT_U_APPTTYPE_$C(30)\n\"RTN\",\"BSDX02\",149,0)\n    NEW BILLINGSTATUS\n\"RTN\",\"BSDX02\",150,0)\n    ;Get the appointment billing status\n\"RTN\",\"BSDX02\",151,0)\n    SET BILLINGSTATUS=$$PAUSE^UJOAPTPS(BSDXAD)\n\"RTN\",\"BSDX02\",152,0)\n   ; END OF CODE CHANGES FOR ; UJO*2.1*151\n\"RTN\",\"BSDX02\",153,0)\n   ;EHS/MOK ;UJOM*2.1*243 ; OCT 30,2023 ;rollback [rollback specific code for moh This change come from UJOM*2.0*28]\n\"RTN\",\"BSDX02\",154,0)\n             ;START OF CODE CHANGE FOR UJOM*2.1*243\n\"RTN\",\"BSDX02\",155,0)\n              ; START OF CODE CHANGE FOR ; UJOM*2.1*243\n\"RTN\",\"BSDX02\",156,0)\n              NEW UJOREF,UJOMADBY\n\"RTN\",\"BSDX02\",157,0)\n              ; SET UJOREF=$SELECT($$GET1^DIQ(9002018.4,BSDXAD_\",\",400077000)=\"YES\":\"1\",1:\"0\")\n\"RTN\",\"BSDX02\",158,0)\n       SET UJOREF=$SELECT($$GET1^DIQ(9002018.4,BSDXAD_\",\",400000003)=\"YES\":\"1\",1:\"0\")\n\"RTN\",\"BSDX02\",159,0)\n              SET UJOMADBY=$$GET1^DIQ(9002018.4,BSDXAD_\",\",.08)\n\"RTN\",\"BSDX02\",160,0)\n              ; SET ^BSDXTMP($J,BSDXI)=SEX_U_PID_U_DOB_U_RADEX_U_CHECKOUT_U_APPTTYPE_U_BILLINGSTATUS_$C(30)\n\"RTN\",\"BSDX02\",161,0)\n       SET ^BSDXTMP($J,BSDXI)=SEX_U_PID_U_DOB_U_RADEX_U_CHECKOUT_U_APPTTYPE_U_BILLINGSTATUS_U_UJOREF_U_UJOMADBY_$C(30)\n\"RTN\",\"BSDX02\",162,0)\n              ; END  OF CODE CHANGE FOR ; UJOM*2.1*243\n\"RTN\",\"BSDX02\",163,0)\n ; END OF NEW CODE\n\"RTN\",\"BSDX02\",164,0)\n ; END OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"BSDX02\",165,0)\n Q\n\"RTN\",\"BSDX02\",166,0)\n ;\n\"RTN\",\"BSDX02\",167,0)\nERR(BSDXI,BSDXERR) ;Error processing\n\"RTN\",\"BSDX02\",168,0)\n S BSDXI=BSDXI+1\n\"RTN\",\"BSDX02\",169,0)\n S ^BSDXTMP($J,BSDXI)=\"0^^^^^^^^^^^\"_BSDXERR_$C(30)\n\"RTN\",\"BSDX02\",170,0)\n S BSDXI=BSDXI+1\n\"RTN\",\"BSDX02\",171,0)\n S ^BSDXTMP($J,BSDXI)=$C(31)\n\"RTN\",\"BSDX02\",172,0)\n Q\n\"RTN\",\"BSDX02\",173,0)\n ;\n\"RTN\",\"BSDX02\",174,0)\nETRAP ;EP Error trap entry\n\"RTN\",\"BSDX02\",175,0)\n D ^%ZTER\n\"RTN\",\"BSDX02\",176,0)\n I '$D(BSDXI) N BSDXI S BSDXI=999999\n\"RTN\",\"BSDX02\",177,0)\n S BSDXI=BSDXI+1\n\"RTN\",\"BSDX02\",178,0)\n D ERR(BSDXI,\"BSDX31 Error: \"_$G(%ZTERROR))\n\"RTN\",\"BSDX02\",179,0)\n Q\n\"RTN\",\"BSDX07\")\n0^1^B144048499\n\"RTN\",\"BSDX07\",1,0)\nBSDX07 ; VW/UJO/SMH - WINDOWS SCHEDULING RPCS  ; 10/14/23 9:20\n\"RTN\",\"BSDX07\",2,0)\n ;;1.7T2;BSDX;;Jul 11, 2012;Build 11\n\"RTN\",\"BSDX07\",3,0)\n ; Licensed under LGPL\n\"RTN\",\"BSDX07\",4,0)\n ;\n\"RTN\",\"BSDX07\",5,0)\n ; Change Log:\n\"RTN\",\"BSDX07\",6,0)\n ; UJO/SMH\n\"RTN\",\"BSDX07\",7,0)\n ; v1.3 July 13 2010 - Add support i18n - Dates input as FM dates, not US.\n\"RTN\",\"BSDX07\",8,0)\n ; v1.42 Oct 22 2010 - Transaction now restartable by providing arguments\n\"RTN\",\"BSDX07\",9,0)\n ; v1.42 Oct 30 2010 - Extensive refactoring.\n\"RTN\",\"BSDX07\",10,0)\n ; v1.5  Mar 15 2011 - End time does not have to have time anymore.\n\"RTN\",\"BSDX07\",11,0)\n ;      It could be midnight of the next day\n\"RTN\",\"BSDX07\",12,0)\n ; v1.6 Apr 11 2011 - Support for Scheduling Radiology Exams...\n\"RTN\",\"BSDX07\",13,0)\n ; v1.7 Jun 20 2012 - Refactoring to remove transactions - many changes\n\"RTN\",\"BSDX07\",14,0)\n ;                  - AVUPDT moved to AVUPDTMK in BSDXAPI1\n\"RTN\",\"BSDX07\",15,0)\n ;\n\"RTN\",\"BSDX07\",16,0)\n ; Error Reference:\n\"RTN\",\"BSDX07\",17,0)\n ; -1: Patient Record is locked. This means something is wrong!!!!\n\"RTN\",\"BSDX07\",18,0)\n ; -2: Start Time is not a valid Fileman date\n\"RTN\",\"BSDX07\",19,0)\n ; -3: End Time is not a valid Fileman date\n\"RTN\",\"BSDX07\",20,0)\n ; v1.5:obsolete::-4: End Time does not have time inside of it.\n\"RTN\",\"BSDX07\",21,0)\n ; -5: BSDXPATID is not numeric\n\"RTN\",\"BSDX07\",22,0)\n ; -6: Patient Does not exist in ^DPT\n\"RTN\",\"BSDX07\",23,0)\n ; -7: Resource Name does not exist in B index of BSDX RESOURCE\n\"RTN\",\"BSDX07\",24,0)\n ; -8: Resouce doesn't exist in ^BSDXRES\n\"RTN\",\"BSDX07\",25,0)\n ; -9: Couldn't add appointment to BSDX APPOINTMENT\n\"RTN\",\"BSDX07\",26,0)\n ; -10: Couldn't add appointment to files 2 and/or 44\n\"RTN\",\"BSDX07\",27,0)\n ; -100: Mumps Error\n\"RTN\",\"BSDX07\",28,0)\n ;\n\"RTN\",\"BSDX07\",29,0)\n    ; EHS/AYG; \"UJO*2.0*61\" ; Jan 29,2014 ; Update [Adding the appointment type]\n\"RTN\",\"BSDX07\",30,0)\n    ; Adding the appointment type (First,Follow-up) to save to the appointment record.\n\"RTN\",\"BSDX07\",31,0)\n    ; START OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"BSDX07\",32,0)\n    ; APPADDD(BSDXY,BSDXSTART,BSDXEND,BSDXPATID,BSDXRES,BSDXLEN,BSDXNOTE)\n\"RTN\",\"BSDX07\",33,0)\nAPPADDD(BSDXY,BSDXSTART,BSDXEND,BSDXPATID,BSDXRES,BSDXLEN,BSDXNOTE,APTTYPE)    ;EP\n\"RTN\",\"BSDX07\",34,0)\n ;Entry point for debugging\n\"RTN\",\"BSDX07\",35,0)\n ; D DEBUG^%Serenji(\"APPADD^BSDX07(.BSDXY,BSDXSTART,BSDXEND,BSDXPATID,BSDXRES,BSDXLEN,BSDXNOTE,BSDXATID)\")\n\"RTN\",\"BSDX07\",36,0)\n Q\n\"RTN\",\"BSDX07\",37,0)\n ;\n\"RTN\",\"BSDX07\",38,0)\nAPPADD(BSDXY,BSDXSTART,BSDXEND,BSDXPATID,BSDXRES,BSDXLEN,BSDXNOTE,BSDXATID,BSDXRADEXAM,APTTYPE) ;Private EP\n\"RTN\",\"BSDX07\",39,0)\n ;\n\"RTN\",\"BSDX07\",40,0)\n    ; END OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"BSDX07\",41,0)\n ;Called by RPC: BSDX ADD NEW APPOINTMENT\n\"RTN\",\"BSDX07\",42,0)\n ;\n\"RTN\",\"BSDX07\",43,0)\n ;Add new appointment to 3 files\n\"RTN\",\"BSDX07\",44,0)\n ; - BSDX APPOINTMENT\n\"RTN\",\"BSDX07\",45,0)\n ; - Hosp Location Appointment SubSubfile if Resource is linked to clinic\n\"RTN\",\"BSDX07\",46,0)\n ; - Patient Appointment Subfile if Resource is linked to clinic\n\"RTN\",\"BSDX07\",47,0)\n ;\n\"RTN\",\"BSDX07\",48,0)\n ;Paramters:\n\"RTN\",\"BSDX07\",49,0)\n ;BSDXY: Global Return (RPC must be set to Global Array)\n\"RTN\",\"BSDX07\",50,0)\n ;BSDXSTART: FM Start Date\n\"RTN\",\"BSDX07\",51,0)\n ;BSDXEND: FM End Date\n\"RTN\",\"BSDX07\",52,0)\n ;BSDXPATID: Patient DFN\n\"RTN\",\"BSDX07\",53,0)\n ;BSDXRES is ResourceName in BSDX RESOURCE file (not IEN)\n\"RTN\",\"BSDX07\",54,0)\n ;BSDXLEN is the appointment duration in minutes\n\"RTN\",\"BSDX07\",55,0)\n ;BSDXNOTE is the Appiontment Note\n\"RTN\",\"BSDX07\",56,0)\n ;BSDXATID is used for 2 purposes:\n\"RTN\",\"BSDX07\",57,0)\n ; if BSDXATID = \"WALKIN\" then BSDAPI is called to create a walkin appt.\n\"RTN\",\"BSDX07\",58,0)\n ; if BSDXATID = a number, then it is the access type id (used for rebooking)\n\"RTN\",\"BSDX07\",59,0)\n ;BSDXRADEXAM is used to store the Radiology Exam to which this appointment is tied to (optional)\n\"RTN\",\"BSDX07\",60,0)\n ;\n\"RTN\",\"BSDX07\",61,0)\n ;Return:\n\"RTN\",\"BSDX07\",62,0)\n ; ADO.net Recordset having fields:\n\"RTN\",\"BSDX07\",63,0)\n ; AppointmentID and ErrorNumber\n\"RTN\",\"BSDX07\",64,0)\n ;\n\"RTN\",\"BSDX07\",65,0)\n ; TODO: Specifying BSDXLEN and BSDXEND is redundant. For future programmers\n\"RTN\",\"BSDX07\",66,0)\n ; to sort out. Needs changes on client.\n\"RTN\",\"BSDX07\",67,0)\n ;\n\"RTN\",\"BSDX07\",68,0)\n ;Test lines:\n\"RTN\",\"BSDX07\",69,0)\n ;BSDX ADD NEW APPOINTMENT^3091122.0930^3091122.1000^370^Dr Office^30^EXAM^WALKIN\n\"RTN\",\"BSDX07\",70,0)\n ;\n\"RTN\",\"BSDX07\",71,0)\n ; Deal with optional arguments\n\"RTN\",\"BSDX07\",72,0)\n S BSDXRADEXAM=$G(BSDXRADEXAM)\n\"RTN\",\"BSDX07\",73,0)\n ;\n\"RTN\",\"BSDX07\",74,0)\n ; Return Array; set Return and clear array\n\"RTN\",\"BSDX07\",75,0)\n S BSDXY=$NA(^BSDXTMP($J))\n\"RTN\",\"BSDX07\",76,0)\n K ^BSDXTMP($J)\n\"RTN\",\"BSDX07\",77,0)\n ;\n\"RTN\",\"BSDX07\",78,0)\n ; $ET\n\"RTN\",\"BSDX07\",79,0)\n N $ET S $ET=\"G ETRAP^BSDX07\"\n\"RTN\",\"BSDX07\",80,0)\n ;\n\"RTN\",\"BSDX07\",81,0)\n ; Counter\n\"RTN\",\"BSDX07\",82,0)\n N BSDXI S BSDXI=0\n\"RTN\",\"BSDX07\",83,0)\n ;\n\"RTN\",\"BSDX07\",84,0)\n ; Lock BSDX node, only to synchronize access to the globals.\n\"RTN\",\"BSDX07\",85,0)\n ; It's not expected that the error will ever happen as no filing\n\"RTN\",\"BSDX07\",86,0)\n ; is supposed to take 5 seconds.\n\"RTN\",\"BSDX07\",87,0)\n L +^BSDXPAT(BSDXPATID):5 I '$T D ERR(BSDXI,\"-1~Patient record is locked. Please contact technical support.\") Q\n\"RTN\",\"BSDX07\",88,0)\n ;\n\"RTN\",\"BSDX07\",89,0)\n ; Header Node\n\"RTN\",\"BSDX07\",90,0)\n S ^BSDXTMP($J,BSDXI)=\"I00020APPOINTMENTID^T00100ERRORID\"_$C(30)\n\"RTN\",\"BSDX07\",91,0)\n ;;EHS/MOK; \"UJOP*2.1*19\" ; OCT 5,2023 ; Addition [Check if the user can do more referrals This change come from UJOM*2.0*105 in moh ]\n\"RTN\",\"BSDX07\",92,0)\n               ; Check user and patient referral limitations\n\"RTN\",\"BSDX07\",93,0)\n               ; START OF CODE CHANGE FOR; UJOP*2.1*19\n\"RTN\",\"BSDX07\",94,0)\n         ;EHS/MOK ;UJOM*2.1*243 ; OCT 22,2023 ;rollback [rollback specific headers and code for moh ]      \n\"RTN\",\"BSDX07\",95,0)\n  ;;EHS/HEH; \"UJOM*2.0*105\" ; DEC 28,2015 ; Addition [Check if the user can do more referrals]\n\"RTN\",\"BSDX07\",96,0)\n               ; Check user and patient referral limitations\n\"RTN\",\"BSDX07\",97,0)\n               ; START OF CODE CHANGE FOR; UJOM*2.0*105\n\"RTN\",\"BSDX07\",98,0)\n               NEW UJOCAN\n\"RTN\",\"BSDX07\",99,0)\n               ; SET UJOCAN=$$CHECK^UJOMREF0(DUZ,BSDXPATID,BSDXSTART,BSDXRES)\n\"RTN\",\"BSDX07\",100,0)\n               SET UJOCAN=$$CHECK^UJOPREF0(DUZ,BSDXPATID,BSDXSTART,BSDXRES)\n\"RTN\",\"BSDX07\",101,0)\n  IF BSDXATID=\"REFERRAL\"&('(+UJOCAN)) DO ERR(BSDXI,$PIECE(UJOCAN,\"^\",2)) QUIT\n\"RTN\",\"BSDX07\",102,0)\n               ; END OF CODE CHANGE FOR; UJOM*2.0*105\n\"RTN\",\"BSDX07\",103,0)\n        ; END OF CODE CHANGE FOR; UJOP*2.1*19\n\"RTN\",\"BSDX07\",104,0)\n ;\n\"RTN\",\"BSDX07\",105,0)\n ; Turn off SDAM APPT PROTOCOL BSDX Entries\n\"RTN\",\"BSDX07\",106,0)\n N BSDXNOEV\n\"RTN\",\"BSDX07\",107,0)\n S BSDXNOEV=1 ;Don't execute BSDX ADD APPOINTMENT protocol\n\"RTN\",\"BSDX07\",108,0)\n ;\n\"RTN\",\"BSDX07\",109,0)\n ; Set Error Message to be empty\n\"RTN\",\"BSDX07\",110,0)\n N BSDXERR S BSDXERR=0\n\"RTN\",\"BSDX07\",111,0)\n ;\n\"RTN\",\"BSDX07\",112,0)\n ;;;test for error. See if %ZTER works\n\"RTN\",\"BSDX07\",113,0)\n I $G(BSDXDIE) N X S X=1/0\n\"RTN\",\"BSDX07\",114,0)\n ;;;test\n\"RTN\",\"BSDX07\",115,0)\n ;\n\"RTN\",\"BSDX07\",116,0)\n ; -- Start and End Date Processing --\n\"RTN\",\"BSDX07\",117,0)\n ; If C# sends the dates with extra zeros, remove them\n\"RTN\",\"BSDX07\",118,0)\n S BSDXSTART=+BSDXSTART,BSDXEND=+BSDXEND\n\"RTN\",\"BSDX07\",119,0)\n ; Are the dates valid? Must be FM Dates > than 2010\n\"RTN\",\"BSDX07\",120,0)\n I BSDXSTART'>3100000 D ERR(BSDXI,\"-2~BSDX07 Error: Invalid Start Time\") Q\n\"RTN\",\"BSDX07\",121,0)\n I BSDXEND'>3100000 D ERR(BSDXI,\"-3~BSDX07 Error: Invalid End Time\") Q\n\"RTN\",\"BSDX07\",122,0)\n ;\n\"RTN\",\"BSDX07\",123,0)\n ;; If Ending date doesn't have a time, this is an error --rm 1.5\n\"RTN\",\"BSDX07\",124,0)\n ; I $L(BSDXEND,\".\")=1 D ERR(BSDXI,\"-4~BSDX07 Error: Invalid End Time\") Q\n\"RTN\",\"BSDX07\",125,0)\n ;\n\"RTN\",\"BSDX07\",126,0)\n ; If the Start Date is greater than the end date, swap dates\n\"RTN\",\"BSDX07\",127,0)\n N BSDXTMP\n\"RTN\",\"BSDX07\",128,0)\n I BSDXSTART>BSDXEND S BSDXTMP=BSDXEND,BSDXEND=BSDXSTART,BSDXSTART=BSDXTMP\n\"RTN\",\"BSDX07\",129,0)\n ;\n\"RTN\",\"BSDX07\",130,0)\n ; Check if the patient exists:\n\"RTN\",\"BSDX07\",131,0)\n ; - DFN valid number?\n\"RTN\",\"BSDX07\",132,0)\n ; - Valid Patient in file 2?\n\"RTN\",\"BSDX07\",133,0)\n I '+BSDXPATID D ERR(BSDXI,\"-5~BSDX07 Error: Invalid Patient ID\") Q \n\"RTN\",\"BSDX07\",134,0)\n I '$D(^DPT(BSDXPATID,0)) D ERR(BSDXI,\"-6~BSDX07 Error: Invalid Patient ID\") Q\n\"RTN\",\"BSDX07\",135,0)\n ;\n\"RTN\",\"BSDX07\",136,0)\n ;Validate Resource entry\n\"RTN\",\"BSDX07\",137,0)\n I '$D(^BSDXRES(\"B\",BSDXRES)) D ERR(BSDXI,\"-7~BSDX07 Error: Invalid Resource ID\") Q\n\"RTN\",\"BSDX07\",138,0)\n N BSDXRESD ; Resource IEN\n\"RTN\",\"BSDX07\",139,0)\n S BSDXRESD=$O(^BSDXRES(\"B\",BSDXRES,0))\n\"RTN\",\"BSDX07\",140,0)\n N BSDXRNOD ; Resouce zero node\n\"RTN\",\"BSDX07\",141,0)\n S BSDXRNOD=$G(^BSDXRES(BSDXRESD,0))\n\"RTN\",\"BSDX07\",142,0)\n I BSDXRNOD=\"\" D ERR(BSDXI,\"-8~BSDX07 Error: invalid Resource entry.\") Q\n\"RTN\",\"BSDX07\",143,0)\n ;\n\"RTN\",\"BSDX07\",144,0)\n ; Walk-in (Unscheduled) Appointment?\n\"RTN\",\"BSDX07\",145,0)\n N BSDXWKIN S BSDXWKIN=0\n\"RTN\",\"BSDX07\",146,0)\n I BSDXATID=\"WALKIN\" S BSDXWKIN=1\n\"RTN\",\"BSDX07\",147,0)\n ; Reset Access Type ID if it doesn't say \"WALKIN\" and isn't a number\n\"RTN\",\"BSDX07\",148,0)\n ;EHS/MOK; \"UJOP*2.1*19\" ; OCT 05,2023 ; Update [Check if referral appointment This change come from UJOM*2.0*105 in moh]\n\"RTN\",\"BSDX07\",149,0)\n  ;I BSDXATID'?.N&(BSDXATID'=\"WALKIN\") S BSDXATID=\"\"\n\"RTN\",\"BSDX07\",150,0)\n        ;Get the configration if referral feature enabled or not\n\"RTN\",\"BSDX07\",151,0)\n  IF BSDXATID'?.N&(BSDXATID'=\"WALKIN\")&(BSDXATID'=\"REFERRAL\") SET BSDXATID=\"\"\n\"RTN\",\"BSDX07\",152,0)\n ;\n\"RTN\",\"BSDX07\",153,0)\n ; Now, check if PIMS has any issues with us making the appt using MAKECK\n\"RTN\",\"BSDX07\",154,0)\n N BSDXSCD S BSDXSCD=$P(BSDXRNOD,U,4)  ; Hosp Location IEN\n\"RTN\",\"BSDX07\",155,0)\n N BSDXERR S BSDXERR=0 ; Variable to hold value of $$MAKE and $$MAKECK\n\"RTN\",\"BSDX07\",156,0)\n N BSDXC ; Array to send to MAKE and MAKECK APIs\n\"RTN\",\"BSDX07\",157,0)\n ; Only if we have a valid Hosp Location\n\"RTN\",\"BSDX07\",158,0)\n I +BSDXSCD,$D(^SC(BSDXSCD,0)) D \n\"RTN\",\"BSDX07\",159,0)\n . S BSDXC(\"PAT\")=BSDXPATID\n\"RTN\",\"BSDX07\",160,0)\n . S BSDXC(\"CLN\")=BSDXSCD\n\"RTN\",\"BSDX07\",161,0)\n . S BSDXC(\"TYP\")=3 ;3 for scheduled appts, 4 for walkins\n\"RTN\",\"BSDX07\",162,0)\n . S:BSDXWKIN BSDXC(\"TYP\")=4\n\"RTN\",\"BSDX07\",163,0)\n . S BSDXC(\"ADT\")=BSDXSTART\n\"RTN\",\"BSDX07\",164,0)\n . ; EHS/AYG; \"UJO*2.0*61\" ; Nov 28,2013 ; Addition [validation for overlapping time periods appointment]\n\"RTN\",\"BSDX07\",165,0)\n . ; Changed the logic of validating the existing overlapped appointments \n\"RTN\",\"BSDX07\",166,0)\n . ;  to prevent adding an overlapped appointments.\n\"RTN\",\"BSDX07\",167,0)\n . ; The appointment end date (BSDXC(\"ADTE\"))will be used to search on an existing appointments.\n\"RTN\",\"BSDX07\",168,0)\n . S BSDXC(\"ADTE\")=BSDXEND\n\"RTN\",\"BSDX07\",169,0)\n . S BSDXC(\"LEN\")=BSDXLEN\n\"RTN\",\"BSDX07\",170,0)\n . S BSDXC(\"OI\")=$E($G(BSDXNOTE),1,150) ;File 44 has 150 character limit on OTHER field\n\"RTN\",\"BSDX07\",171,0)\n . S BSDXC(\"OI\")=$TR(BSDXC(\"OI\"),\";\",\" \") ;No semicolons allowed by MAKE^BSDXAPI\n\"RTN\",\"BSDX07\",172,0)\n . S BSDXC(\"OI\")=$$STRIP(BSDXC(\"OI\")) ;Strip control characters from note\n\"RTN\",\"BSDX07\",173,0)\n . S BSDXC(\"USR\")=DUZ\n\"RTN\",\"BSDX07\",174,0)\n . S BSDXERR=$$MAKECK^BSDXAPI(.BSDXC)\n\"RTN\",\"BSDX07\",175,0)\n I BSDXERR D ERR(BSDXI,\"-10~BSDX07 Error: MAKECK^BSDXAPI returned error code: \"_BSDXERR) Q  ; no need for roll back\n\"RTN\",\"BSDX07\",176,0)\n ;\n\"RTN\",\"BSDX07\",177,0)\n ; Done with all checks, let's make appointment in BSDX APPOINTMENT\n\"RTN\",\"BSDX07\",178,0)\n N BSDXAPPTID\n\"RTN\",\"BSDX07\",179,0)\n    ;EHS/AYG; \"UJO*2.0*61\" ; Jan 29,2014 ; Update [Adding the appointment type]\n\"RTN\",\"BSDX07\",180,0)\n    ;Adding the appointment type (First,Follow-up) to be saved for the appointment record.\n\"RTN\",\"BSDX07\",181,0)\n    ; START OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"BSDX07\",182,0)\n    ; START OF OLD CODE\n\"RTN\",\"BSDX07\",183,0)\n ; S BSDXAPPTID=$$BSDXADD(BSDXSTART,BSDXEND,BSDXPATID,BSDXRESD,BSDXATID,BSDXRADEXAM)\n\"RTN\",\"BSDX07\",184,0)\n    ; END OF OLD CODE\n\"RTN\",\"BSDX07\",185,0)\n    ; START OF NEW CODE\n\"RTN\",\"BSDX07\",186,0)\n    SET BSDXAPPTID=$$BSDXADD(BSDXSTART,BSDXEND,BSDXPATID,BSDXRESD,BSDXATID,BSDXRADEXAM,APTTYPE)\n\"RTN\",\"BSDX07\",187,0)\n    ; END OF NEW CODE\n\"RTN\",\"BSDX07\",188,0)\n    ; END OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"BSDX07\",189,0)\n I 'BSDXAPPTID D ERR(BSDXI,\"-9~BSDX07 Error: Unable to add appointment to BSDX APPOINTMENT file.\") Q  ; no roll back needed! No appts made.\n\"RTN\",\"BSDX07\",190,0)\n I BSDXNOTE]\"\" D BSDXWP(BSDXAPPTID,BSDXNOTE) ; no error checks are made here\n\"RTN\",\"BSDX07\",191,0)\n ; I don't think it's important b/c users can detect right away if the WP\n\"RTN\",\"BSDX07\",192,0)\n ; filing fails.\n\"RTN\",\"BSDX07\",193,0)\n ;\n\"RTN\",\"BSDX07\",194,0)\n I $G(BSDXSIMERR1) D ERR(BSDXI,\"-11~BSDX07 Error: Simulated Error\"),ROLLBACK(BSDXAPPTID,.BSDXC) Q  ; UT Line\n\"RTN\",\"BSDX07\",195,0)\n ;\n\"RTN\",\"BSDX07\",196,0)\n ; Only if we have a valid Hosp Loc can we make an appointment in 2/44\n\"RTN\",\"BSDX07\",197,0)\n ; Use BSDXC array from before.\n\"RTN\",\"BSDX07\",198,0)\n ; FYI: $$MAKE itself calls $$MAKECK to check again for being okay.\n\"RTN\",\"BSDX07\",199,0)\n ; If an error happens here, we roll back both ^BSDXAPPT and 2/44 by deleting\n\"RTN\",\"BSDX07\",200,0)\n N BSDXERR S BSDXERR=0 ; Variable to hold value of $$MAKE and $$MAKECK\n\"RTN\",\"BSDX07\",201,0)\n ;\n\"RTN\",\"BSDX07\",202,0)\n    ; EHS/AYG; \"UJO*2.0*61\" ; Nov 28,2013 ; Addition [validation for overlapping time periods appointment]\n\"RTN\",\"BSDX07\",203,0)\n ; Changed the logic of validating the existing overlapped appointments \n\"RTN\",\"BSDX07\",204,0)\n ;  to prevent adding an overlapped appointments\n\"RTN\",\"BSDX07\",205,0)\n ; Will pass the SECONDCK node with the BSDXC array with one to exclude the overlapping appointments check.\n\"RTN\",\"BSDX07\",206,0)\n ; Because the appointment entry already added to the BSDX APPOINTMENT file, and all other checks in the \n\"RTN\",\"BSDX07\",207,0)\n ; MAKECK function will work normally.\n\"RTN\",\"BSDX07\",208,0)\n SET BSDXC(\"SECONDCK\")=\"1\"\n\"RTN\",\"BSDX07\",209,0)\n I +BSDXSCD,$D(^SC(BSDXSCD,0)) S BSDXERR=$$MAKE^BSDXAPI(.BSDXC)\n\"RTN\",\"BSDX07\",210,0)\n I BSDXERR D ERR(BSDXI,\"-10~BSDX07 Error: MAKE^BSDXAPI returned error code: \"_BSDXERR),ROLLBACK(BSDXAPPTID,.BSDXC) Q\n\"RTN\",\"BSDX07\",211,0)\n  ;EHS/MOK;UJOP*2.1*19; 15 OCT 2023;Addition[Generate HL7 message for add appointment This change come from UJOM*2.1*104 and UJOM*2.0*80 and UJOM*2.1*134]\n\"RTN\",\"BSDX07\",212,0)\n                  ;START OF CODE CHANGE;UJOP*2.1*19\n\"RTN\",\"BSDX07\",213,0)\n                  NEW ARR,SIUCHECK\n\"RTN\",\"BSDX07\",214,0)\n                  SET ARR(\"BSDXAPPTID\")=\"\"\n\"RTN\",\"BSDX07\",215,0)\n                  SET:PRONAME'=\"\" ARR(\"PRONAME\")=\"\"\n\"RTN\",\"BSDX07\",216,0)\n                  SET:PROIEN'=\"\" ARR(\"PROIEN\")=\"\"\n\"RTN\",\"BSDX07\",217,0)\n                  SET:PATCLASS'=\"\" ARR(\"PATCLASS\")=\"\"\n\"RTN\",\"BSDX07\",218,0)\n                  SET SIUCHECK=$$MSGCHKR^UJO7MBLD(\"UJO7 SIU S12\")\n\"RTN\",\"BSDX07\",219,0)\n           ;EHS/MOK;UJOM*2.1*243;OCT 23,2023 ;rollback [Rollback specific code related with hl7 for moh]\n\"RTN\",\"BSDX07\",220,0)\n    ; DO:($GET(ORDVAL)=\"\"&(UPENTRY'=1)) CREATE^UJOMGTSK(\"MAIN^UJOMAPTT(BSDXAPPTID)\",\"SIU S12 task\",1,.ARR)\n\"RTN\",\"BSDX07\",221,0)\n    IF ($GET(SIUCHECK)'=0)&($GET(SIUCHECK)'=\"\") DO\n\"RTN\",\"BSDX07\",222,0)\n              . DO:($GET(ORDVAL)=\"\"&(UPENTRY'=1)) CREATE^UJOGTSK(\"MAIN^UJOPAPTT(BSDXAPPTID)\",\"SIU S12 task\",1,.ARR)\n\"RTN\",\"BSDX07\",223,0)\n ;END OF CODE CHANGE FOR UJOP*2.1*19\n\"RTN\",\"BSDX07\",224,0)\n ; Unlock\n\"RTN\",\"BSDX07\",225,0)\n L -^BSDXPAT(BSDXPATID)\n\"RTN\",\"BSDX07\",226,0)\n ;\n\"RTN\",\"BSDX07\",227,0)\n ;Return Recordset\n\"RTN\",\"BSDX07\",228,0)\n S BSDXI=BSDXI+1\n\"RTN\",\"BSDX07\",229,0)\n S ^BSDXTMP($J,BSDXI)=BSDXAPPTID_\"^\"_$C(30)\n\"RTN\",\"BSDX07\",230,0)\n S BSDXI=BSDXI+1\n\"RTN\",\"BSDX07\",231,0)\n S ^BSDXTMP($J,BSDXI)=$C(31)\n\"RTN\",\"BSDX07\",232,0)\n Q\n\"RTN\",\"BSDX07\",233,0)\nSTRIP(BSDXZ)    ;Replace control characters with spaces\n\"RTN\",\"BSDX07\",234,0)\n N BSDXI\n\"RTN\",\"BSDX07\",235,0)\n F BSDXI=1:1:$L(BSDXZ) I (32>$A($E(BSDXZ,BSDXI))) S BSDXZ=$E(BSDXZ,1,BSDXI-1)_\" \"_$E(BSDXZ,BSDXI+1,999)\n\"RTN\",\"BSDX07\",236,0)\n Q BSDXZ\n\"RTN\",\"BSDX07\",237,0)\n ;\n\"RTN\",\"BSDX07\",238,0)\nBSDXADD(BSDXSTART,BSDXEND,BSDXPATID,BSDXRESD,BSDXATID,BSDXRADEXAM,APTTYPE)  ;ADD BSDX APPOINTMENT ENTRY\n\"RTN\",\"BSDX07\",239,0)\n ;Returns ien in BSDXAPPT or 0 if failed\n\"RTN\",\"BSDX07\",240,0)\n ;Create entry in BSDX APPOINTMENT\n\"RTN\",\"BSDX07\",241,0)\n N BSDXAPPTID,BSDXFDA\n\"RTN\",\"BSDX07\",242,0)\n S BSDXFDA(9002018.4,\"+1,\",.01)=BSDXSTART\n\"RTN\",\"BSDX07\",243,0)\n S BSDXFDA(9002018.4,\"+1,\",.02)=BSDXEND\n\"RTN\",\"BSDX07\",244,0)\n S BSDXFDA(9002018.4,\"+1,\",.05)=BSDXPATID\n\"RTN\",\"BSDX07\",245,0)\n S BSDXFDA(9002018.4,\"+1,\",.07)=BSDXRESD\n\"RTN\",\"BSDX07\",246,0)\n S BSDXFDA(9002018.4,\"+1,\",.08)=$G(DUZ)\n\"RTN\",\"BSDX07\",247,0)\n S BSDXFDA(9002018.4,\"+1,\",.09)=$$NOW^XLFDT\n\"RTN\",\"BSDX07\",248,0)\n S:BSDXATID=\"WALKIN\" BSDXFDA(9002018.4,\"+1,\",.13)=\"y\"\n\"RTN\",\"BSDX07\",249,0)\n S:BSDXATID?.N BSDXFDA(9002018.4,\"+1,\",.06)=BSDXATID\n\"RTN\",\"BSDX07\",250,0)\n S BSDXFDA(9002018.4,\"+1,\",.14)=$G(BSDXRADEXAM)\n\"RTN\",\"BSDX07\",251,0)\n    ;EHS/AYG; \"UJO*2.0*61\" ; Jan 29,2014 ; Addition [Adding the appointment type]\n\"RTN\",\"BSDX07\",252,0)\n    ;Adding the appointment type (First,Follow-up) to the FDA array.\n\"RTN\",\"BSDX07\",253,0)\n    SET BSDXFDA(9002018.4,\"+1,\",400000000)=$GET(APTTYPE)\n\"RTN\",\"BSDX07\",254,0)\n ;EHS/MOK; \"UJOP*2.1*19\" ; OCT 5,2023 ; Addition [Adding the appointment type This change come from UJOM*2.0*105 in moh]            \n\"RTN\",\"BSDX07\",255,0)\n ;SET:BSDXATID=\"REFERRAL\" BSDXFDA(9002018.4,\"+1,\",400077000)=\"y\"\n\"RTN\",\"BSDX07\",256,0)\n  SET:BSDXATID=\"REFERRAL\" BSDXFDA(9002018.4,\"+1,\",400000003)=\"y\"\n\"RTN\",\"BSDX07\",257,0)\n N BSDXIEN,BSDXMSG\n\"RTN\",\"BSDX07\",258,0)\n D UPDATE^DIE(\"\",\"BSDXFDA\",\"BSDXIEN\",\"BSDXMSG\")\n\"RTN\",\"BSDX07\",259,0)\n S BSDXAPPTID=+$G(BSDXIEN(1))\n\"RTN\",\"BSDX07\",260,0)\n Q BSDXAPPTID\n\"RTN\",\"BSDX07\",261,0)\n ;\n\"RTN\",\"BSDX07\",262,0)\nBSDXWP(BSDXAPPTID,BSDXNOTE) ;\n\"RTN\",\"BSDX07\",263,0)\n ;Add WP field\n\"RTN\",\"BSDX07\",264,0)\n N BSDXMSG\n\"RTN\",\"BSDX07\",265,0)\n I BSDXNOTE]\"\" S BSDXNOTE(.5)=BSDXNOTE,BSDXNOTE=\"\"\n\"RTN\",\"BSDX07\",266,0)\n I $D(BSDXNOTE(0)) S BSDXNOTE(.5)=BSDXNOTE(0) K BSDXNOTE(0)\n\"RTN\",\"BSDX07\",267,0)\n I $D(BSDXNOTE(.5)) D\n\"RTN\",\"BSDX07\",268,0)\n . D WP^DIE(9002018.4,BSDXAPPTID_\",\",1,\"\",\"BSDXNOTE\",\"BSDXMSG\")\n\"RTN\",\"BSDX07\",269,0)\n Q\n\"RTN\",\"BSDX07\",270,0)\n ;\n\"RTN\",\"BSDX07\",271,0)\nADDEVT(BSDXPATID,BSDXSTART,BSDXSC,BSDXSCDA) ;EP\n\"RTN\",\"BSDX07\",272,0)\n ;Called by BSDX ADD APPOINTMENT protocol\n\"RTN\",\"BSDX07\",273,0)\n ;BSDXSC=IEN of clinic in ^SC\n\"RTN\",\"BSDX07\",274,0)\n ;BSDXSCDA=IEN for ^SC(BSDXSC,\"S\",BSDXSTART,1,BSDXSCDA). Use to get Length & Note\n\"RTN\",\"BSDX07\",275,0)\n ;\n\"RTN\",\"BSDX07\",276,0)\n N BSDXNOD,BSDXLEN,BSDXAPPTID,BSDXNODP,BSDXWKIN,BSDXRES,BSDXNOTE,BSDXEND\n\"RTN\",\"BSDX07\",277,0)\n Q:+$G(BSDXNOEV)\n\"RTN\",\"BSDX07\",278,0)\n I $D(^BSDXRES(\"ALOC\",BSDXSC)) S BSDXRES=$O(^BSDXRES(\"ALOC\",BSDXSC,0))\n\"RTN\",\"BSDX07\",279,0)\n E  I $D(^BSDXRES(\"ASSOC\",BSDXSC)) S BSDXRES=$O(^BSDXRES(\"ASSOC\",BSDXSC,0))\n\"RTN\",\"BSDX07\",280,0)\n Q:'+$G(BSDXRES)\n\"RTN\",\"BSDX07\",281,0)\n S BSDXNOD=$G(^SC(BSDXSC,\"S\",BSDXSTART,1,BSDXSCDA,0))\n\"RTN\",\"BSDX07\",282,0)\n Q:BSDXNOD=\"\"\n\"RTN\",\"BSDX07\",283,0)\n S BSDXNODP=$G(^DPT(BSDXPATID,\"S\",BSDXSTART,0))\n\"RTN\",\"BSDX07\",284,0)\n S BSDXWKIN=\"\"\n\"RTN\",\"BSDX07\",285,0)\n S:$P(BSDXNODP,U,7)=4 BSDXWKIN=\"WALKIN\" ;Purpose of Visit field of DPT Appointment subfile\n\"RTN\",\"BSDX07\",286,0)\n S BSDXLEN=$P(BSDXNOD,U,2)\n\"RTN\",\"BSDX07\",287,0)\n Q:'+BSDXLEN\n\"RTN\",\"BSDX07\",288,0)\n S BSDXEND=$$FMADD^XLFDT(BSDXSTART,0,0,BSDXLEN,0)\n\"RTN\",\"BSDX07\",289,0)\n S BSDXAPPTID=$$BSDXADD(BSDXSTART,BSDXEND,BSDXPATID,BSDXRES,BSDXWKIN)\n\"RTN\",\"BSDX07\",290,0)\n Q:'+BSDXAPPTID\n\"RTN\",\"BSDX07\",291,0)\n S BSDXNOTE=$P(BSDXNOD,U,4)\n\"RTN\",\"BSDX07\",292,0)\n I BSDXNOTE]\"\" D BSDXWP(BSDXAPPTID,BSDXNOTE)\n\"RTN\",\"BSDX07\",293,0)\n D ADDEVT3(BSDXRES)\n\"RTN\",\"BSDX07\",294,0)\n Q\n\"RTN\",\"BSDX07\",295,0)\n ;\n\"RTN\",\"BSDX07\",296,0)\nADDEVT3(BSDXRES)    ;\n\"RTN\",\"BSDX07\",297,0)\n ;Call RaiseEvent to notify GUI clients\n\"RTN\",\"BSDX07\",298,0)\n N BSDXRESN\n\"RTN\",\"BSDX07\",299,0)\n S BSDXRESN=$G(^BSDXRES(BSDXRES,0))\n\"RTN\",\"BSDX07\",300,0)\n Q:BSDXRESN=\"\"\n\"RTN\",\"BSDX07\",301,0)\n S BSDXRESN=$P(BSDXRESN,\"^\")\n\"RTN\",\"BSDX07\",302,0)\n ;D EVENT^BSDX23(\"SCHEDULE-\"_BSDXRESN,\"\",\"\",\"\")\n\"RTN\",\"BSDX07\",303,0)\n D EVENT^BMXMEVN(\"BSDX SCHEDULE\",BSDXRESN)\n\"RTN\",\"BSDX07\",304,0)\n Q\n\"RTN\",\"BSDX07\",305,0)\n ;\n\"RTN\",\"BSDX07\",306,0)\nROLLBACK(BSDXAPPTID,BSDXC) ; Private EP; Roll back appointment set\n\"RTN\",\"BSDX07\",307,0)\n ; DO NOT USE except as an emergency measure - only if unforseen error occurs\n\"RTN\",\"BSDX07\",308,0)\n ; Input: \n\"RTN\",\"BSDX07\",309,0)\n ; Appointment ID to remove from ^BSDXAPPT\n\"RTN\",\"BSDX07\",310,0)\n ; BSDXC array (see array format in $$MAKE^BSDXAPI)\n\"RTN\",\"BSDX07\",311,0)\n N %\n\"RTN\",\"BSDX07\",312,0)\n D BSDXDEL^BSDX07(BSDXAPPTID)\n\"RTN\",\"BSDX07\",313,0)\n S:$D(BSDXC) %=$$UNMAKE^BSDXAPI(.BSDXC) ; rtn value always 0\n\"RTN\",\"BSDX07\",314,0)\n QUIT\n\"RTN\",\"BSDX07\",315,0)\n ;\n\"RTN\",\"BSDX07\",316,0)\nBSDXDEL(BSDXAPPTID) ;Private EP ; Deletes appointment BSDXAPPTID from ^BSDXAPPT\n\"RTN\",\"BSDX07\",317,0)\n ; DO NOT USE except in emergencies to roll back an appointment set\n\"RTN\",\"BSDX07\",318,0)\n N DA,DIK\n\"RTN\",\"BSDX07\",319,0)\n S DIK=\"^BSDXAPPT(\",DA=BSDXAPPTID\n\"RTN\",\"BSDX07\",320,0)\n D ^DIK\n\"RTN\",\"BSDX07\",321,0)\n Q\n\"RTN\",\"BSDX07\",322,0)\n ;\n\"RTN\",\"BSDX07\",323,0)\nERR(BSDXI,BSDXERR)  ;Error processing - different from error trap.\n\"RTN\",\"BSDX07\",324,0)\n ; Unlock first\n\"RTN\",\"BSDX07\",325,0)\n L -^BSDXPAT(BSDXPATID)\n\"RTN\",\"BSDX07\",326,0)\n ; If last line is $C(31), we are done. No more errors to send to client.\n\"RTN\",\"BSDX07\",327,0)\n I ^BSDXTMP($J,$O(^BSDXTMP($J,\" \"),-1))=$C(31) QUIT\n\"RTN\",\"BSDX07\",328,0)\n S BSDXI=BSDXI+1\n\"RTN\",\"BSDX07\",329,0)\n S BSDXERR=$TR(BSDXERR,\"^\",\"~\")\n\"RTN\",\"BSDX07\",330,0)\n S ^BSDXTMP($J,BSDXI)=\"0^\"_BSDXERR_$C(30)\n\"RTN\",\"BSDX07\",331,0)\n S BSDXI=BSDXI+1\n\"RTN\",\"BSDX07\",332,0)\n S ^BSDXTMP($J,BSDXI)=$C(31)\n\"RTN\",\"BSDX07\",333,0)\n Q\n\"RTN\",\"BSDX07\",334,0)\n ;\n\"RTN\",\"BSDX07\",335,0)\nETRAP   ;EP Error trap entry\n\"RTN\",\"BSDX07\",336,0)\n N $ET S $ET=\"D ^%ZTER HALT\"  ; Emergency Error Trap\n\"RTN\",\"BSDX07\",337,0)\n D ^%ZTER\n\"RTN\",\"BSDX07\",338,0)\n ;\n\"RTN\",\"BSDX07\",339,0)\n I +$G(BSDXAPPTID) D ROLLBACK(BSDXAPPTID,.BSDXC) ; Rollback if BSDXAPPTID exists\n\"RTN\",\"BSDX07\",340,0)\n ;\n\"RTN\",\"BSDX07\",341,0)\n ; Log error message and send to client\n\"RTN\",\"BSDX07\",342,0)\n I '$D(BSDXI) N BSDXI S BSDXI=0\n\"RTN\",\"BSDX07\",343,0)\n D ERR(BSDXI,\"-100~BSDX07 Error: \"_$G(%ZTERZE))\n\"RTN\",\"BSDX07\",344,0)\n Q:$Q 1_U_\"Mumps Error\" Q\n\"RTN\",\"BSDX07\",345,0)\n ;\n\"RTN\",\"BSDX28\")\n0^4^B66129299\n\"RTN\",\"BSDX28\",1,0)\nBSDX28 ; IHS/OIT/HMW - WINDOWS SCHEDULING RPCS ; 7/6/12 10:57am\n\"RTN\",\"BSDX28\",2,0)\n ;;1.7T2;BSDX;;Jul 11, 2012;Build 11\n\"RTN\",\"BSDX28\",3,0)\n ; Licensed under LGPL\n\"RTN\",\"BSDX28\",4,0)\n ; Change Log:\n\"RTN\",\"BSDX28\",5,0)\n ; HMW 3050721 Added test for inactivated record\n\"RTN\",\"BSDX28\",6,0)\n ; V1.3 WV/SMH 3100714 \n\"RTN\",\"BSDX28\",7,0)\n ; - add PID search\n\"RTN\",\"BSDX28\",8,0)\n ; - return PID instead of SSN (change header and logic)\n\"RTN\",\"BSDX28\",9,0)\n ; - Change Error trap to new style.\n\"RTN\",\"BSDX28\",10,0)\n ;\n\"RTN\",\"BSDX28\",11,0)\nPTLOOKRS(BSDXY,BSDXP,BSDXC)  ;EP Patient Lookup\n\"RTN\",\"BSDX28\",12,0)\n ;\n\"RTN\",\"BSDX28\",13,0)\n ;Find up to BSDXC patients matching BSDXP*\n\"RTN\",\"BSDX28\",14,0)\n ;Supports DOB Lookup, Primary Long ID lookup\n\"RTN\",\"BSDX28\",15,0)\n ;\n\"RTN\",\"BSDX28\",16,0)\n N $ET S $ET=\"G ERROR^BSDX28\"\n\"RTN\",\"BSDX28\",17,0)\n    ; rm ctrl chars\n\"RTN\",\"BSDX28\",18,0)\n S BSDXP=$TR(BSDXP,$C(13),\"\")\n\"RTN\",\"BSDX28\",19,0)\n S BSDXP=$TR(BSDXP,$C(10),\"\")\n\"RTN\",\"BSDX28\",20,0)\n S BSDXP=$TR(BSDXP,$C(9),\"\")\n\"RTN\",\"BSDX28\",21,0)\n    ; num of pts to find\n\"RTN\",\"BSDX28\",22,0)\n S:BSDXC=\"\" BSDXC=10\n\"RTN\",\"BSDX28\",23,0)\n N BSDXHRN,BSDXZ,BSDXDLIM,BSDXRET,BSDXDPT,BSDXRET,BSDXIEN,BSDXFILE\n\"RTN\",\"BSDX28\",24,0)\n N BSDXIENS,BSDXFIELDS,BSDXFLAGS,BSDXVALUE,BSDXNUMBER,BSDXINDEXES,BSDXSCREEN\n\"RTN\",\"BSDX28\",25,0)\n N BSDXTARG,BSDXMSG,BSDXRSLT\n\"RTN\",\"BSDX28\",26,0)\n S BSDXDLIM=\"^\"\n\"RTN\",\"BSDX28\",27,0)\n ;EHS/MOK;UJOP*2.1*19;OCT 1,2023;Addation[Merge EHS changes to make the effort generic patches Add SEX on Sixth piece This change come from UJOM*2.1*91 in moh]\n\"RTN\",\"BSDX28\",28,0)\n ;START OF CODE CHANGE FOR UJOP*2.1*19\n\"RTN\",\"BSDX28\",29,0)\n ;EHS/MOK ;UJOM*2.1*243 ; OCT 22,2023 ;rollback [rollback specific headers and commented code for moh ]\n\"RTN\",\"BSDX28\",30,0)\n ;EHS/BAF;UJOM*2.1*91;FEB 20,2018;Update[Add SEX on Sixth piece]\n\"RTN\",\"BSDX28\",31,0)\n               ;S BSDXRET=\"T00030NAME^T00030HRN^T00030PID^D00030DOB^T00030IEN\"_$C(30) \n\"RTN\",\"BSDX28\",32,0)\n SET BSDXRET=\"T00030NAME^T00030HRN^T00030PID^D00030DOB^T00030IEN^T00030SEX\"_$CHAR(30)\n\"RTN\",\"BSDX28\",33,0)\n I '+$G(DUZ) S BSDXY=BSDXRET_$C(31) Q\n\"RTN\",\"BSDX28\",34,0)\n I '$D(DUZ(2)) S BSDXY=BSDXRET_$C(31) Q\n\"RTN\",\"BSDX28\",35,0)\nDFN ;If DFN is passed as `nnnn, just return that patient\n\"RTN\",\"BSDX28\",36,0)\n I $E(BSDXP)=\"`\" DO  SET BSDXY=BSDXRET_$C(31) QUIT\n\"RTN\",\"BSDX28\",37,0)\n . N BSDXIEN S BSDXIEN=$E(BSDXP,2,99)\n\"RTN\",\"BSDX28\",38,0)\n . I BSDXIEN'=+BSDXIEN QUIT  ; BSDXIEN must be numeric\n\"RTN\",\"BSDX28\",39,0)\n . N NAME S NAME=$P(^DPT(BSDXIEN,0),U)\n\"RTN\",\"BSDX28\",40,0)\n . N HRN S HRN=$P($G(^AUPNPAT(BSDXIEN,41,DUZ(2),0)),U,2)\n\"RTN\",\"BSDX28\",41,0)\n . N PID S PID=$P(^DPT(BSDXIEN,.36),U,3)\n\"RTN\",\"BSDX28\",42,0)\n . N DOB S DOB=$$FMTE^XLFDT($P(^DPT(BSDXIEN,0),U,3))\n\"RTN\",\"BSDX28\",43,0)\n . ;EHS/MOK;UJOP*2.1*19;OCT 1,2023;Update[Merge EHS changes to make the effort generic patches This change come from UJOM*2.1*91 in moh]\n\"RTN\",\"BSDX28\",44,0)\n . ;START OF CODE CHANGE FOR UJOP*2.1*19\n\"RTN\",\"BSDX28\",45,0)\n . ;Get gender valuefor patient from SEX #.02 field at PATIENT #2 file      \n\"RTN\",\"BSDX28\",46,0)\n . NEW SEX\n\"RTN\",\"BSDX28\",47,0)\n . SET SEX=$PIECE(^DPT(BSDXIEN,0),U,2)\n\"RTN\",\"BSDX28\",48,0)\n . ;S BSDXRET=BSDXRET_NAME_U_HRN_U_PID_U_DOB_U_BSDXIEN_$C(30)\n\"RTN\",\"BSDX28\",49,0)\n . SET BSDXRET=BSDXRET_NAME_U_HRN_U_PID_U_DOB_U_BSDXIEN_U_SEX_$C(30)\n\"RTN\",\"BSDX28\",50,0)\n . ;END OF CODE CHANGES FOR;UJOP*2.1*19\n\"RTN\",\"BSDX28\",51,0)\nPID ;PID Lookup\n\"RTN\",\"BSDX28\",52,0)\n ; If this ID exists, go get it. If \"UJOPID\" index doesn't exist,\n\"RTN\",\"BSDX28\",53,0)\n ; won't work anyways.\n\"RTN\",\"BSDX28\",54,0)\n I $D(^DPT(\"UJOPID\",BSDXP)) DO  SET BSDXY=BSDXRET_$C(31) QUIT\n\"RTN\",\"BSDX28\",55,0)\n . S BSDXIEN=$O(^DPT(\"UJOPID\",BSDXP,\"\"))\n\"RTN\",\"BSDX28\",56,0)\n . Q:'$D(^DPT(BSDXIEN,0))\n\"RTN\",\"BSDX28\",57,0)\n . S BSDXDPT=$G(^DPT(BSDXIEN,0))\n\"RTN\",\"BSDX28\",58,0)\n . S BSDXZ=$P(BSDXDPT,U) ;NAME\n\"RTN\",\"BSDX28\",59,0)\n . S BSDXHRN=$P($G(^AUPNPAT(BSDXIEN,41,DUZ(2),0)),U,2) ;CHART\n\"RTN\",\"BSDX28\",60,0)\n . I BSDXHRN=\"\" Q  ;NO CHART AT THIS DUZ2\n\"RTN\",\"BSDX28\",61,0)\n . ; Inactivated Chart get an *\n\"RTN\",\"BSDX28\",62,0)\n . I $P($G(^AUPNPAT(BSDXIEN,41,DUZ(2),0)),U,3) S BSDXHRN=BSDXHRN_\"(*)\" Q\n\"RTN\",\"BSDX28\",63,0)\n . S $P(BSDXZ,BSDXDLIM,2)=BSDXHRN\n\"RTN\",\"BSDX28\",64,0)\n . S $P(BSDXZ,BSDXDLIM,3)=$P(^DPT(BSDXIEN,.36),U,3) ;PID\n\"RTN\",\"BSDX28\",65,0)\n . S Y=$P(BSDXDPT,U,3) X ^DD(\"DD\")\n\"RTN\",\"BSDX28\",66,0)\n . S $P(BSDXZ,BSDXDLIM,4)=Y ;DOB\n\"RTN\",\"BSDX28\",67,0)\n . S $P(BSDXZ,BSDXDLIM,5)=BSDXIEN\n\"RTN\",\"BSDX28\",68,0)\n .;EHS/MOK;UJOP*2.1*19;OCT 1,2023;Addation[Merge EHS changes to make the effort generic patches Add Gender value for patient on Sixth piece This change come from UJOM*2.1*91 in moh]\n\"RTN\",\"BSDX28\",69,0)\n . SET $PIECE(BSDXZ,BSDXDLIM,6)=$PIECE(BSDXDPT,U,2)\n\"RTN\",\"BSDX28\",70,0)\n . S BSDXRET=BSDXRET_BSDXZ_$C(30)\n\"RTN\",\"BSDX28\",71,0)\n ;\n\"RTN\",\"BSDX28\",72,0)\nDOB ;DOB Lookup\n\"RTN\",\"BSDX28\",73,0)\n I +DUZ(2),((BSDXP?1.2N1\"/\"1.2N1\"/\"1.4N)!(BSDXP?1.2N1\" \"1.2N1\" \"1.4N)!(BSDXP?1.2N1\"-\"1.2N1\"-\"1.4N)) D  S BSDXY=BSDXRET_$C(31) Q\n\"RTN\",\"BSDX28\",74,0)\n . S X=BSDXP S %DT=\"P\" D ^%DT S BSDXP=Y Q:'+Y\n\"RTN\",\"BSDX28\",75,0)\n . Q:'$D(^DPT(\"ADOB\",BSDXP))\n\"RTN\",\"BSDX28\",76,0)\n . S BSDXIEN=0 F  S BSDXIEN=$O(^DPT(\"ADOB\",BSDXP,BSDXIEN)) Q:'+BSDXIEN  D\n\"RTN\",\"BSDX28\",77,0)\n . . Q:'$D(^DPT(BSDXIEN,0))\n\"RTN\",\"BSDX28\",78,0)\n . . S BSDXDPT=$G(^DPT(BSDXIEN,0))\n\"RTN\",\"BSDX28\",79,0)\n . . S BSDXZ=$P(BSDXDPT,U) ;NAME\n\"RTN\",\"BSDX28\",80,0)\n . . S BSDXHRN=$P($G(^AUPNPAT(BSDXIEN,41,DUZ(2),0)),U,2) ;CHART\n\"RTN\",\"BSDX28\",81,0)\n . . I BSDXHRN=\"\" Q  ;NO CHART AT THIS DUZ2\n\"RTN\",\"BSDX28\",82,0)\n . . I $P($G(^AUPNPAT(BSDXIEN,41,DUZ(2),0)),U,3) S BSDXHRN=BSDXHRN_\"(*)\" Q  ;HMW 20050721 Record Inactivated\n\"RTN\",\"BSDX28\",83,0)\n . . S $P(BSDXZ,BSDXDLIM,2)=BSDXHRN\n\"RTN\",\"BSDX28\",84,0)\n    . . S $P(BSDXZ,BSDXDLIM,3)=$P(^DPT(BSDXIEN,.36),U,3) ;PID\n\"RTN\",\"BSDX28\",85,0)\n . . S Y=$P(BSDXDPT,U,3) X ^DD(\"DD\")\n\"RTN\",\"BSDX28\",86,0)\n . . S $P(BSDXZ,BSDXDLIM,4)=Y ;DOB\n\"RTN\",\"BSDX28\",87,0)\n . . S $P(BSDXZ,BSDXDLIM,5)=BSDXIEN\n\"RTN\",\"BSDX28\",88,0)\n . . ;EHS/MOK;UJOP*2.1*19;OCT 1,2023;Addation[Merge EHS changes to make the effort generic patches Add Gender value for patient on Sixth piece This change come from UJOM*2.1*91 in moh]\n\"RTN\",\"BSDX28\",89,0)\n . . SET $PIECE(BSDXZ,BSDXDLIM,6)=$PIECE(BSDXDPT,U,2)\n\"RTN\",\"BSDX28\",90,0)\n . . S BSDXRET=BSDXRET_BSDXZ_$C(30)\n\"RTN\",\"BSDX28\",91,0)\n . . Q\n\"RTN\",\"BSDX28\",92,0)\n . Q\n\"RTN\",\"BSDX28\",93,0)\n ;\n\"RTN\",\"BSDX28\",94,0)\nCHART ;Chart# Lookup\n\"RTN\",\"BSDX28\",95,0)\n I +DUZ(2),BSDXP]\"\",$D(^AUPNPAT(\"D\",BSDXP)) D  S BSDXY=BSDXRET_$C(31) Q\n\"RTN\",\"BSDX28\",96,0)\n . S BSDXIEN=0 F  S BSDXIEN=$O(^AUPNPAT(\"D\",BSDXP,BSDXIEN)) Q:'+BSDXIEN  I $D(^AUPNPAT(\"D\",BSDXP,BSDXIEN,DUZ(2))) D  Q\n\"RTN\",\"BSDX28\",97,0)\n . . Q:'$D(^DPT(BSDXIEN,0))\n\"RTN\",\"BSDX28\",98,0)\n . . S BSDXDPT=$G(^DPT(BSDXIEN,0))\n\"RTN\",\"BSDX28\",99,0)\n . . S BSDXZ=$P(BSDXDPT,U) ;NAME\n\"RTN\",\"BSDX28\",100,0)\n . . S BSDXHRN=BSDXP ;CHART\n\"RTN\",\"BSDX28\",101,0)\n . . I $D(^AUPNPAT(BSDXIEN,41,DUZ(2),0)),$P(^(0),U,3) S BSDXHRN=BSDXHRN_\"(*)\" Q  ;HMW 20050721 Record Inactivated\n\"RTN\",\"BSDX28\",102,0)\n . . S $P(BSDXZ,BSDXDLIM,2)=BSDXHRN\n\"RTN\",\"BSDX28\",103,0)\n    . . S $P(BSDXZ,BSDXDLIM,3)=$P(^DPT(BSDXIEN,.36),U,3) ;PID\n\"RTN\",\"BSDX28\",104,0)\n . . S Y=$P(BSDXDPT,U,3) X ^DD(\"DD\")\n\"RTN\",\"BSDX28\",105,0)\n . . S $P(BSDXZ,BSDXDLIM,4)=Y ;DOB\n\"RTN\",\"BSDX28\",106,0)\n . . S $P(BSDXZ,BSDXDLIM,5)=BSDXIEN\n\"RTN\",\"BSDX28\",107,0)\n . . ;EHS/MOK;UJOP*2.1*19;OCT 1,2023;Addation[Merge EHS changes to make the effort generic patches Add Gender value for patient on Sixth piece This change come from UJOM*2.1*91 in moh]\n\"RTN\",\"BSDX28\",108,0)\n . . SET $PIECE(BSDXZ,BSDXDLIM,6)=$PIECE(BSDXDPT,U,2)\n\"RTN\",\"BSDX28\",109,0)\n . . S BSDXRET=BSDXRET_BSDXZ_$C(30)\n\"RTN\",\"BSDX28\",110,0)\n . . Q\n\"RTN\",\"BSDX28\",111,0)\n . Q\n\"RTN\",\"BSDX28\",112,0)\n    ;\n\"RTN\",\"BSDX28\",113,0)\nSSN ;SSN Lookup\n\"RTN\",\"BSDX28\",114,0)\n I (BSDXP?9N)!(BSDXP?3N1\"-\"2N1\"-\"4N),$D(^DPT(\"SSN\",BSDXP)) D  S BSDXY=BSDXRET_$C(31) Q\n\"RTN\",\"BSDX28\",115,0)\n . S BSDXIEN=0 F  S BSDXIEN=$O(^DPT(\"SSN\",BSDXP,BSDXIEN)) Q:'+BSDXIEN  D  Q\n\"RTN\",\"BSDX28\",116,0)\n . . Q:'$D(^DPT(BSDXIEN,0))\n\"RTN\",\"BSDX28\",117,0)\n . . S BSDXDPT=$G(^DPT(BSDXIEN,0))\n\"RTN\",\"BSDX28\",118,0)\n . . S BSDXZ=$P(BSDXDPT,U) ;NAME\n\"RTN\",\"BSDX28\",119,0)\n . . S BSDXHRN=$P($G(^AUPNPAT(BSDXIEN,41,DUZ(2),0)),U,2) ;CHART\n\"RTN\",\"BSDX28\",120,0)\n . . I BSDXHRN=\"\" Q  ;NO CHART AT THIS DUZ2\n\"RTN\",\"BSDX28\",121,0)\n . . I $P($G(^AUPNPAT(BSDXIEN,41,DUZ(2),0)),U,3) S BSDXHRN=BSDXHRN_\"(*)\" Q  ;HMW 20050721 Record Inactivated\n\"RTN\",\"BSDX28\",122,0)\n . . S $P(BSDXZ,BSDXDLIM,2)=BSDXHRN\n\"RTN\",\"BSDX28\",123,0)\n    . . S $P(BSDXZ,BSDXDLIM,3)=$P(^DPT(BSDXIEN,.36),U,3) ;PID\n\"RTN\",\"BSDX28\",124,0)\n . . S Y=$P(BSDXDPT,U,3) X ^DD(\"DD\")\n\"RTN\",\"BSDX28\",125,0)\n . . S $P(BSDXZ,BSDXDLIM,4)=Y ;DOB\n\"RTN\",\"BSDX28\",126,0)\n . . S $P(BSDXZ,BSDXDLIM,5)=BSDXIEN\n\"RTN\",\"BSDX28\",127,0)\n . . ;EHS/MOK;UJOP*2.1*19;OCT 1,2023;Addation[Merge EHS changes to make the effort generic patches Add Gender value for patient on Sixth piece This change come from UJOM*2.1*91 in moh]\n\"RTN\",\"BSDX28\",128,0)\n . . SET $PIECE(BSDXZ,BSDXDLIM,6)=$PIECE(BSDXDPT,U,2)\n\"RTN\",\"BSDX28\",129,0)\n . . S BSDXRET=BSDXRET_BSDXZ_$C(30)\n\"RTN\",\"BSDX28\",130,0)\n . . Q\n\"RTN\",\"BSDX28\",131,0)\n . Q\n\"RTN\",\"BSDX28\",132,0)\n ;\n\"RTN\",\"BSDX28\",133,0)\n S BSDXFILE=9000001\n\"RTN\",\"BSDX28\",134,0)\n S BSDXIENS=\"\"\n\"RTN\",\"BSDX28\",135,0)\n S BSDXFIELDS=\".01\"\n\"RTN\",\"BSDX28\",136,0)\n S BSDXFLAGS=\"M\"\n\"RTN\",\"BSDX28\",137,0)\n S BSDXVALUE=BSDXP\n\"RTN\",\"BSDX28\",138,0)\n S BSDXNUMBER=BSDXC\n\"RTN\",\"BSDX28\",139,0)\n S BSDXINDEXES=\"\"\n\"RTN\",\"BSDX28\",140,0)\n S BSDXSCREEN=$S(+DUZ(2):\"I $D(^AUPNPAT(Y,41,DUZ(2),0))\",1:\"\")\n\"RTN\",\"BSDX28\",141,0)\n S BSDXIDEN=\"\"\n\"RTN\",\"BSDX28\",142,0)\n S BSDXTARG=\"BSDXRSLT\"\n\"RTN\",\"BSDX28\",143,0)\n S BSDXMSG=\"\"\n\"RTN\",\"BSDX28\",144,0)\n D FIND^DIC(BSDXFILE,BSDXIENS,BSDXFIELDS,BSDXFLAGS,BSDXVALUE,BSDXNUMBER,BSDXINDEXES,BSDXSCREEN,BSDXIDEN,BSDXTARG,BSDXMSG)\n\"RTN\",\"BSDX28\",145,0)\n I '+$G(BSDXRSLT(\"DILIST\",0)) S BSDXY=BSDXRET_$C(31) Q\n\"RTN\",\"BSDX28\",146,0)\n N BSDXCNT S BSDXCNT=2\n\"RTN\",\"BSDX28\",147,0)\n F BSDXX=1:1:$P(BSDXRSLT(\"DILIST\",0),U) D\n\"RTN\",\"BSDX28\",148,0)\n . S BSDXIEN=BSDXRSLT(\"DILIST\",2,BSDXX)\n\"RTN\",\"BSDX28\",149,0)\n . S BSDXZ=BSDXRSLT(\"DILIST\",\"ID\",BSDXX,.01) ;NAME\n\"RTN\",\"BSDX28\",150,0)\n . S BSDXHRN=$P($G(^AUPNPAT(BSDXIEN,41,DUZ(2),0)),U,2) ;CHART\n\"RTN\",\"BSDX28\",151,0)\n . I BSDXHRN=\"\" Q  ;NO CHART AT THIS DUZ2\n\"RTN\",\"BSDX28\",152,0)\n . I $P($G(^AUPNPAT(BSDXIEN,41,DUZ(2),0)),U,3) S BSDXHRN=BSDXHRN_\"(*)\" Q  ;HMW 20050721 Record Inactivated\n\"RTN\",\"BSDX28\",153,0)\n . S $P(BSDXZ,BSDXDLIM,2)=BSDXHRN\n\"RTN\",\"BSDX28\",154,0)\n . S BSDXDPT=$G(^DPT(BSDXIEN,0))\n\"RTN\",\"BSDX28\",155,0)\n    . S $P(BSDXZ,BSDXDLIM,3)=$P(^DPT(BSDXIEN,.36),U,3) ;PID\n\"RTN\",\"BSDX28\",156,0)\n . S Y=$P(BSDXDPT,U,3) X ^DD(\"DD\")\n\"RTN\",\"BSDX28\",157,0)\n . S $P(BSDXZ,BSDXDLIM,4)=Y ;DOB\n\"RTN\",\"BSDX28\",158,0)\n . S $P(BSDXZ,BSDXDLIM,5)=BSDXIEN\n\"RTN\",\"BSDX28\",159,0)\n . ;EHS/MOK;UJOP*2.1*19;OCT 1,2023;Addation[Merge EHS changes to make the effort generic patches Add Gender value for patient on Sixth piece This change come from UJOM*2.1*91 in moh]\n\"RTN\",\"BSDX28\",160,0)\n . SET $PIECE(BSDXZ,BSDXDLIM,6)=$PIECE(BSDXDPT,U,2)\n\"RTN\",\"BSDX28\",161,0)\n . S $P(BSDXRET,$C(30),BSDXCNT)=BSDXZ\n\"RTN\",\"BSDX28\",162,0)\n . S BSDXCNT=BSDXCNT+1\n\"RTN\",\"BSDX28\",163,0)\n . Q\n\"RTN\",\"BSDX28\",164,0)\n S BSDXY=BSDXRET_$C(30)_$C(31)\n\"RTN\",\"BSDX28\",165,0)\n Q\n\"RTN\",\"BSDX28\",166,0)\n ;\n\"RTN\",\"BSDX28\",167,0)\nERROR ;\n\"RTN\",\"BSDX28\",168,0)\n D ERR(\"RPMS Error\")\n\"RTN\",\"BSDX28\",169,0)\n Q\n\"RTN\",\"BSDX28\",170,0)\n ;\n\"RTN\",\"BSDX28\",171,0)\nERR(ERRNO) ;Error processing\n\"RTN\",\"BSDX28\",172,0)\n        ;EHS/MOK;UJOP*2.1*19;OCT 1,2023;Update[Merge EHS changes to make the effort generic patches Add Gender value for patient on Sixth piece This change come from UJOM*2.1*91 in moh]\n\"RTN\",\"BSDX28\",173,0)\n        ;S BSDXRET=\"T00030NAME^T00030HRN^T00030SSN^D00030DOB^T00030IEN\"_$C(30)_\"^^^^\"_$C(30)_$C(31)\n\"RTN\",\"BSDX28\",174,0)\n        SET BSDXRET=\"T00030NAME^T00030HRN^T00030SSN^D00030DOB^T00030IEN^T00030SEX\"_$CHAR(30)_\"^^^^^\"_$CHAR(30)_$CHAR(31)\n\"RTN\",\"BSDX28\",175,0)\n Q\n\"RTN\",\"UJOAPTPS\")\n0^8^B3463632\n\"RTN\",\"UJOAPTPS\",1,0)\nUJOAPTPS ;;EHS/TOA - Pause solution for check in appointments;NOV 11,2014 ; 3/22/22 9:00pm\n\"RTN\",\"UJOAPTPS\",2,0)\n         ;;2.1;UJO;**151**;NOV 11,2014;Build 11\n\"RTN\",\"UJOAPTPS\",3,0)\n         ;;  AUTHOR      : Toqa Abbas\n\"RTN\",\"UJOAPTPS\",4,0)\n         ;;  Date        : NOV 11,2014\n\"RTN\",\"UJOAPTPS\",5,0)\n         ;;  DESCRIPTION : This Routine contains API'S to stop check in appointment depending on appointment status\n\"RTN\",\"UJOAPTPS\",6,0)\n         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOAPTPS\",7,0)\n         QUIT\n\"RTN\",\"UJOAPTPS\",8,0)\n ;EHS/MOK ;UJOM*2.1*243 ; OCT 30,2023 ;rollback [rollback specific code for moh This change come from UJOM*2.0*28]\n\"RTN\",\"UJOAPTPS\",9,0)\n      ;START OF CODE CHANGE FOR UJOM*2.1*243\n\"RTN\",\"UJOAPTPS\",10,0)\n    ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOAPTPS\",11,0)\n           ;NAME          : GETWORD\n\"RTN\",\"UJOAPTPS\",12,0)\n           ;\n\"RTN\",\"UJOAPTPS\",13,0)\n           ; DESCRIPTION  : This function is used to get NOTES field from BSDX APPOINMENT file\n\"RTN\",\"UJOAPTPS\",14,0)\n           ;\n\"RTN\",\"UJOAPTPS\",15,0)\n           ; INPUTS       : - APPIEN: IEN from BSDX APPOINTMENTS\n\"RTN\",\"UJOAPTPS\",16,0)\n           ;\n\"RTN\",\"UJOAPTPS\",17,0)\n           ; OUTPUTS      : N/A\n\"RTN\",\"UJOAPTPS\",18,0)\n           ;\n\"RTN\",\"UJOAPTPS\",19,0)\n           ; RETURN       : - PRE: First subscript of NOTE field array\n\"RTN\",\"UJOAPTPS\",20,0)\n           ;                - -1 : Fail\n\"RTN\",\"UJOAPTPS\",21,0)\n           ;\n\"RTN\",\"UJOAPTPS\",22,0)\n           ; Notes        : N/A\n\"RTN\",\"UJOAPTPS\",23,0)\n           ;\n\"RTN\",\"UJOAPTPS\",24,0)\n           ; Author(s)    : Toqa Abbas\n\"RTN\",\"UJOAPTPS\",25,0)\n           ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOAPTPS\",26,0)\nGETWORD(APPIEN)\n\"RTN\",\"UJOAPTPS\",27,0)\n         NEW WORD,PRE,OUT,ERR\n\"RTN\",\"UJOAPTPS\",28,0)\n         SET WORD=$$GET1^DIQ(9002018.4,APPIEN_\",\",1,\"\",\"OUT\",\"ERR\")\n\"RTN\",\"UJOAPTPS\",29,0)\n         IF $DATA(ERR) DO  QUIT -1\n\"RTN\",\"UJOAPTPS\",30,0)\n         . DO ERRPRCS^UJOMSGPH(\"UJO BILLING SYSTEM ERROR\",$GET(DUZ),\"\",$GET(DUZ(2)),\",U PAUSE~UJOAPTPS: Empty parameter list,\")\n\"RTN\",\"UJOAPTPS\",31,0)\n         SET PRE=OUT(1)\n\"RTN\",\"UJOAPTPS\",32,0)\n         QUIT PRE\n\"RTN\",\"UJOAPTPS\",33,0)\n  ;END OF CODE CHANGE FOR UJOM*2.1*243\n\"RTN\",\"UJOAPTPS\",34,0)\n  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOAPTPS\",35,0)\n         ; NAME          : PAUSE\n\"RTN\",\"UJOAPTPS\",36,0)\n         ;\n\"RTN\",\"UJOAPTPS\",37,0)\n         ; DESCRIPTION  : This function is use to check if item is accept or reject\n\"RTN\",\"UJOAPTPS\",38,0)\n         ;\n\"RTN\",\"UJOAPTPS\",39,0)\n         ; INPUTS       : - IEN: IEN from BSDX APPOINMENT\n\"RTN\",\"UJOAPTPS\",40,0)\n         ;\n\"RTN\",\"UJOAPTPS\",41,0)\n         ; OUTPUTS      : N/A\n\"RTN\",\"UJOAPTPS\",42,0)\n         ;\n\"RTN\",\"UJOAPTPS\",43,0)\n         ; RETURN       : Status_flag;Status_desc\n\"RTN\",\"UJOAPTPS\",44,0)\n         ;                Status_flag is 0 if accepted\n\"RTN\",\"UJOAPTPS\",45,0)\n         ;                Status_flag is 1 if rejected status or not added to UJO TRANSACTION\n\"RTN\",\"UJOAPTPS\",46,0)\n         ;                Status_desc status description like ACCEPT, REJECT ... etc\n\"RTN\",\"UJOAPTPS\",47,0)\n         ;\n\"RTN\",\"UJOAPTPS\",48,0)\n         ; Notes        : N/A\n\"RTN\",\"UJOAPTPS\",49,0)\n         ;\n\"RTN\",\"UJOAPTPS\",50,0)\n         ; Author(s)    : Toqa Abbas\n\"RTN\",\"UJOAPTPS\",51,0)\n         ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOAPTPS\",52,0)\nPAUSE(IEN)  \n\"RTN\",\"UJOAPTPS\",53,0)\n ;EHS/MOK ;UJOM*2.1*243 ; OCT 30,2023 ;rollback [rollback specific code for moh This change come from UJOM*2.0*28]\n\"RTN\",\"UJOAPTPS\",54,0)\n        ;START OF CODE CHANGE FOR UJOM*2.1*243\n\"RTN\",\"UJOAPTPS\",55,0)\n IF $GET(IEN)=\"\" DO\n\"RTN\",\"UJOAPTPS\",56,0)\n        . ;DO ERRPRCS^UJOMSGPH(\"BILLING SYSTEM ERROR\",$GET(DUZ),\"\",$GET(DUZ(2)),\",U PAUSE~UJOAPTPS: Empty parameter list,\")\n\"RTN\",\"UJOAPTPS\",57,0)\n . DO ERRPRCS^UJOMSGPH(\"UJO BILLING SYSTEM ERROR\",$GET(DUZ),\"\",$GET(DUZ(2)),\",U PAUSE~UJOAPTPS: Empty parameter list,\")\n\"RTN\",\"UJOAPTPS\",58,0)\n        ;NEW STOP,ARRINFO\n\"RTN\",\"UJOAPTPS\",59,0)\n NEW STOP,PRE,ARRINFO,NOTE,ERROR\n\"RTN\",\"UJOAPTPS\",60,0)\n        ;EHS/WAN/BAF;UJO*2.0*99;Dec 24,2014;Update[Comment the filling in the Notes filed.]\n\"RTN\",\"UJOAPTPS\",61,0)\n        ;SET PRE=$$GETWORD^UJOAPTPS(IEN)\n\"RTN\",\"UJOAPTPS\",62,0)\n ;SET STOP=$$PAUSEAC(9002018.4,IEN,.ARRINFO)   \n\"RTN\",\"UJOAPTPS\",63,0)\n        SET STOP=$$PAUSE^UJOPAUSE(9002018.4,IEN,.ARRINFO)\n\"RTN\",\"UJOAPTPS\",64,0)\n        IF STOP=-1 DO\n\"RTN\",\"UJOAPTPS\",65,0)\n        . DO ERRPRCS^UJOMSGPH(\"UJO BILLING SYSTEM ERROR\",$GET(DUZ),\"\",$GET(DUZ(2)),\",U PAUSE~UJOAPTPS: Empty parameter list,\")\n\"RTN\",\"UJOAPTPS\",66,0)\n        . ;DO ERRPRCS^UJOMSGPH(\"BILLING SYSTEM ERROR\",$GET(DUZ),\"\",$GET(DUZ(2)),\",U PAUSE~UJOAPTPS: Empty parameter list,\")\n\"RTN\",\"UJOAPTPS\",67,0)\n  ;EHS/WAN/BAF;UJO*2.0*99;Dec 11,2014;Update[Comment the filling in the Notes filed, and adding the Billing status to the returned array]\n\"RTN\",\"UJOAPTPS\",68,0)\n         ;START CODE CHANGE FOR ; \"UJO*2.0*99\"\n\"RTN\",\"UJOAPTPS\",69,0)\n         ;Old code\n\"RTN\",\"UJOAPTPS\",70,0)\n         ;IF PRE'[\"**\" DO\n\"RTN\",\"UJOAPTPS\",71,0)\n         ;.SET PRE=PRE_\"****\"\n\"RTN\",\"UJOAPTPS\",72,0)\n         ;SET $PIECE(PRE,\"**\",2)=ARRINFO(\"STATUS\")_\" \"_ARRINFO(\"TEXT\")\n\"RTN\",\"UJOAPTPS\",73,0)\n         ;SET NOTE=\"Pause\",NOTE(1)=PRE\n\"RTN\",\"UJOAPTPS\",74,0)\n         ;DO WP^DIE(9002018.4,IEN_\",\",1,\"\",\"NOTE\",\"ERROR\")\n\"RTN\",\"UJOAPTPS\",75,0)\n         ;IF $DATA(ERROR) DO\n\"RTN\",\"UJOAPTPS\",76,0)\n         ;.DO ERRPRCS^UJOMSGPH(\"UJO BILLING SYSTEM ERROR\",$GET(DUZ),\"\",$GET(DUZ(2)),\",U PAUSE~UJOAPTPS: Empty parameter list,\")\n\"RTN\",\"UJOAPTPS\",77,0)\n         ;QUIT ARRINFO(\"PAUSE\")\n\"RTN\",\"UJOAPTPS\",78,0)\n         ;New code\n\"RTN\",\"UJOAPTPS\",79,0)\n         ;EHS/BAF;UJO*2.0*112;Mar 1,2015;Update[Adding the Billing text to the returned array]\n\"RTN\",\"UJOAPTPS\",80,0)\n         ;QUIT ARRINFO(\"PAUSE\")_\";\"_ARRINFO(\"STATUS\")\n\"RTN\",\"UJOAPTPS\",81,0)\n ;END OF CODE CHANGE FOR UJOM*2.1*243\n\"RTN\",\"UJOAPTPS\",82,0)\n QUIT ARRINFO(\"PAUSE\")_\";\"_ARRINFO(\"STATUS\")_\";\"_ARRINFO(\"TEXT\")\n\"RTN\",\"UJOAPTPS\",83,0)\n            ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOAPTPS\",84,0)\n            ; Name         : PAUSEAC\n\"RTN\",\"UJOAPTPS\",85,0)\n            ;\n\"RTN\",\"UJOAPTPS\",86,0)\n            ; Description  : Function to check the billing status for the given IEN and file # from \"UJO TRANSACTIONS\" file\n\"RTN\",\"UJOAPTPS\",87,0)\n            ;\n\"RTN\",\"UJOAPTPS\",88,0)\n            ; In           - FILE: File # \n\"RTN\",\"UJOAPTPS\",89,0)\n            ;              - IEN: Entry IEN for the given file #\n\"RTN\",\"UJOAPTPS\",90,0)\n            ;              \n\"RTN\",\"UJOAPTPS\",91,0)\n            ; Out          : INFARR: Pause information are returned in this array\n\"RTN\",\"UJOAPTPS\",92,0)\n            ;\n\"RTN\",\"UJOAPTPS\",93,0)\n            ; Return       :   1: Success\n\"RTN\",\"UJOAPTPS\",94,0)\n            ;                 -1: Error\n\"RTN\",\"UJOAPTPS\",95,0)\n            ;\n\"RTN\",\"UJOAPTPS\",96,0)\n            ; Notes        : N/A\n\"RTN\",\"UJOAPTPS\",97,0)\n            ;\n\"RTN\",\"UJOAPTPS\",98,0)\n            ; Author(s)    : Ayman Ghaith\n\"RTN\",\"UJOAPTPS\",99,0)\n            ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOAPTPS\",100,0)\nPAUSEAC(FILE,IEN,INFARR) \n\"RTN\",\"UJOAPTPS\",101,0)\n            IF $GET(FILE)=\"\"!($GET(IEN)=\"\") DO  QUIT -1\n\"RTN\",\"UJOAPTPS\",102,0)\n            . DO ERRPRCS^UJOMSGPH(\"BILLING SYSTEM ERROR\",$GET(DUZ),\"\",$GET(DUZ(2)),\",U PAUSEAC~UJOAPTPS: Empty parameter list,\")\n\"RTN\",\"UJOAPTPS\",103,0)\n            NEW INFO\n\"RTN\",\"UJOAPTPS\",104,0)\n            ;Call routine that data from file i need data from them.\n\"RTN\",\"UJOAPTPS\",105,0)\n            SET INFO=$$GETTRINF^UJOTRANS(FILE,IEN,.INFARR)\n\"RTN\",\"UJOAPTPS\",106,0)\n            NEW PAUSE\n\"RTN\",\"UJOAPTPS\",107,0)\n            SET PAUSE=0\n\"RTN\",\"UJOAPTPS\",108,0)\n            ;if the status not equal accept the system will turn on the pause and stop the user\n\"RTN\",\"UJOAPTPS\",109,0)\n            IF INFARR(\"STATUS\")'=\"AA\" SET PAUSE=1\n\"RTN\",\"UJOAPTPS\",110,0)\n            ;Validation the date if the date invalid set the \"PAUSE=1\"]\n\"RTN\",\"UJOAPTPS\",111,0)\n            IF $GET(INFARR(\"EXPDT\"))'=\"\" DO\n\"RTN\",\"UJOAPTPS\",112,0)\n            . NEW VALIDT\n\"RTN\",\"UJOAPTPS\",113,0)\n            . SET VALIDT=INFARR(\"LSTDT\")<INFARR(\"EXPDT\")\n\"RTN\",\"UJOAPTPS\",114,0)\n            . IF INFARR(\"STATUS\")=\"PR\"&(VALIDT'=1) DO\n\"RTN\",\"UJOAPTPS\",115,0)\n            . . SET PAUSE=1\n\"RTN\",\"UJOAPTPS\",116,0)\n            . . SET INFARR(\"TEXT\")=\"Selected item, expiration date has reached.\"\n\"RTN\",\"UJOAPTPS\",117,0)\n            . . SET INFARR(\"STATUS\")=\"EXPIRED\"\n\"RTN\",\"UJOAPTPS\",118,0)\n            IF INFARR(\"STATUS\")=\"\" SET INFARR(\"TEXT\")=\"Billing Status: Not Found\"\n\"RTN\",\"UJOAPTPS\",119,0)\n            ;get data to make sure the billing system work\n\"RTN\",\"UJOAPTPS\",120,0)\n            SET INFARR(\"PAUSE\")=$SELECT($$INSBILL^UJONWPUS(DUZ(2))>0:1,1:0)\n\"RTN\",\"UJOAPTPS\",121,0)\n            QUIT 1\n\"RTN\",\"UJOPBSD1\")\n0^5^B89782864\n\"RTN\",\"UJOPBSD1\",1,0)\nUJOPBSD1  ;EHS/MAD - BSDX01: Patient Portal / Get Time Slots By Each Resource ;Oct 4, 2017 ; 12/3/20 12:06pm\n\"RTN\",\"UJOPBSD1\",2,0)\n          ;;2.1;UJOP;**1**;Oct 4, 2017;Build 11\n\"RTN\",\"UJOPBSD1\",3,0)\n          ;; Author       : Mohammad Abu-Dayyeh\n\"RTN\",\"UJOPBSD1\",4,0)\n          ;; Date         : Oct 4,2017\n\"RTN\",\"UJOPBSD1\",5,0)\n          ;; Description  : This routine was copied from BSDX01(just the RESUSR Tag) with some minor changes.\n\"RTN\",\"UJOPBSD1\",6,0)\n          ;;                to get time slots by resource.\n\"RTN\",\"UJOPBSD1\",7,0)\n          ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPBSD1\",8,0)\n          QUIT\n\"RTN\",\"UJOPBSD1\",9,0)\n          ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPBSD1\",10,0)\n          ; Name         : RESUSR\n\"RTN\",\"UJOPBSD1\",11,0)\n          ;\n\"RTN\",\"UJOPBSD1\",12,0)\n          ; Description  : This function gets the time slots by resource id.\n\"RTN\",\"UJOPBSD1\",13,0)\n          ;\n\"RTN\",\"UJOPBSD1\",14,0)\n          ; In           : RESID        : Resource IEN from BSDX RESOURCE FILE #9002018.1\n\"RTN\",\"UJOPBSD1\",15,0)\n          ;\n\"RTN\",\"UJOPBSD1\",16,0)\n          ; Out          : BSDXY        : Global Return holds the time slot for the Resource.\n\"RTN\",\"UJOPBSD1\",17,0)\n          ;\n\"RTN\",\"UJOPBSD1\",18,0)\n          ; Return       : N/A\n\"RTN\",\"UJOPBSD1\",19,0)\n          ;\n\"RTN\",\"UJOPBSD1\",20,0)\n          ; Notes        : Called from \"UJOW TIMESLOT BY RESOURCE\" RPC.\n\"RTN\",\"UJOPBSD1\",21,0)\n          ;\n\"RTN\",\"UJOPBSD1\",22,0)\n          ; Author(s)    : Mohammad Abu-Dayyeh\n\"RTN\",\"UJOPBSD1\",23,0)\n          ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPBSD1\",24,0)\nRESUSR(BSDXY,RESID) \n\"RTN\",\"UJOPBSD1\",25,0)\n IF $GET(RESID)=\"\" DO  QUIT\n\"RTN\",\"UJOPBSD1\",26,0)\n . DO ERRPRCS^UJOMSGPH(\"UJOW ERROR\",$GET(DUZ),\"\",$GET(DUZ(2)),\",U RESID~UJOWBSD1:Empty parameter list,\")\n\"RTN\",\"UJOPBSD1\",27,0)\n ;Returns ADO Recordset with ALL RESOURCE names\n\"RTN\",\"UJOPBSD1\",28,0)\n ;Inactive RESOURCES are NOT filtered out\n\"RTN\",\"UJOPBSD1\",29,0)\n ;Called by BSDX RESOURCES BY USER\n\"RTN\",\"UJOPBSD1\",30,0)\n ;\n\"RTN\",\"UJOPBSD1\",31,0)\n N BSDXERR,BSDXRET,BSDXIEN,BSDXRES,BSDXDEP,BSDXDDR,BSDXDEPN,BSDXRDAT,BSDXRNOD,BSDXI,BSDX,BSDXLTR\n\"RTN\",\"UJOPBSD1\",32,0)\n N BSDXNOS,BSDXCAN\n\"RTN\",\"UJOPBSD1\",33,0)\n K ^BSDXTMP($J)\n\"RTN\",\"UJOPBSD1\",34,0)\n S BSDXY=\"^BSDXTMP(\"_$J_\")\"\n\"RTN\",\"UJOPBSD1\",35,0)\n S BSDXI=0\n\"RTN\",\"UJOPBSD1\",36,0)\n S BSDXERR=\"\"\n\"RTN\",\"UJOPBSD1\",37,0)\n S ^BSDXTMP($J,BSDXI)=\"I00010RESOURCEID^T00030RESOURCE_NAME^T00010INACTIVE^I00010TIMESCALE^I00010HOSPITAL_LOCATION_ID^T00030LETTER_TEXT^T00030NO_SHOW_LETTER\"\n\"RTN\",\"UJOPBSD1\",38,0)\n    ; EHS/AYG; \"UJO*2.0*61\" ; Nov 28,2013 ; Update [ADDING BSDX RESOURCE configuration fields]\n\"RTN\",\"UJOPBSD1\",39,0)\n    ; Added the following fields BSDX RESOURCE FILE#9002018.1 :\n\"RTN\",\"UJOPBSD1\",40,0)\n    ; 400000000 FIRST APPOINTMENTS MAXIMUM\n\"RTN\",\"UJOPBSD1\",41,0)\n    ; 400000001 FOLLOW-UP APPOINTMENTS MAXIMUM\n\"RTN\",\"UJOPBSD1\",42,0)\n    ; 400000002 APPOINTMENTS/SLOT MAXIMUM\n\"RTN\",\"UJOPBSD1\",43,0)\n    ; 400000003 OVERBOOKS/DAY MAXIMUM\n\"RTN\",\"UJOPBSD1\",44,0)\n    ; 400000004 SLOTS FOR FIRST APPOINTMENT\n\"RTN\",\"UJOPBSD1\",45,0)\n    ; 400000005 SLOTS FOR FOLLOWUP APPOINTMENT\n\"RTN\",\"UJOPBSD1\",46,0)\n    ; ; START OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"UJOPBSD1\",47,0)\n    ; ; START OF OLD CODE\n\"RTN\",\"UJOPBSD1\",48,0)\n    ; S ^BSDXTMP($J,BSDXI)=^(BSDXI)_\"^T00030CLINIC_CANCELLATION_LETTER^I00010VIEW^I00010OVERBOOK^I00010MODIFY_SCHEDULE^I00010MODIFY_APPOINTMENTS_$C(30)\n\"RTN\",\"UJOPBSD1\",49,0)\n    ; END OF OLD CODE\n\"RTN\",\"UJOPBSD1\",50,0)\n    ; START OF NEW CODE\n\"RTN\",\"UJOPBSD1\",51,0)\n         ;EHS/AKH;UJOW*1.0*87;OCT 27,2022;Update[Retrieve Instituation IEN and Hospital Name.]\n\"RTN\",\"UJOPBSD1\",52,0)\n        ;Scope        : Scheduling Web\n\"RTN\",\"UJOPBSD1\",53,0)\n        ;START OF CODE CHANGE FOR UJOW*1.0*87\n\"RTN\",\"UJOPBSD1\",54,0)\n ;SET ^BSDXTMP($J,BSDXI)=^(BSDXI)_\"^T00030CLINIC_CANCELLATION_LETTER^I00010VIEW^I00010OVERBOOK^I00010MODIFY_SCHEDULE^I00010MODIFY_APPOINTMENTS^I00010FIRST_MAX^I00010FOLLOW_MAX^I00010APPT_SLOT_MAX^I00010OVERBOOK_MAX^I00010FIRST_APPT_SLOTS^I00010FOLLOWUP_APPT_SLOTS\"_$C(30)\n\"RTN\",\"UJOPBSD1\",55,0)\n    ; END OF NEW CODE\n\"RTN\",\"UJOPBSD1\",56,0)\n    ; END OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"UJOPBSD1\",57,0)\n    SET ^BSDXTMP($JOB,BSDXI)=^(BSDXI)_\"^T00030CLINIC_CANCELLATION_LETTER^I00010VIEW^I00010OVERBOOK^I00010MODIFY_SCHEDULE^I00010MODIFY_APPOINTMENTS^ I00010FIRST_MAX^I00010FOLLOW_MAX^I00010APPT_SLOT_MAX^I00010OVERBOOK_MAX^I00010FIRST_APPT_SLOTS^I00010FOLLOWUP_APPT_SLOTS^T00030HOSPITAL_IEN^T00030HOSPITAL_NAME^\"_$CHAR(30)\n\"RTN\",\"UJOPBSD1\",58,0)\n ;END OF CODE CHANGE FOR UJOW*1.0*87\n\"RTN\",\"UJOPBSD1\",59,0)\n IF '+BSDXDUZ S BSDXDUZ=DUZ\n\"RTN\",\"UJOPBSD1\",60,0)\n ;$O THRU AC XREF OF BSDX RESOURCE USER\n\"RTN\",\"UJOPBSD1\",61,0)\n ;Rmoved these lines in order to just return all resource names\n\"RTN\",\"UJOPBSD1\",62,0)\n ;I $D(^BSDXRSU(\"AC\",BSDXDUZ)) S BSDXIEN=0 F  S BSDXIEN=$O(^BSDXRSU(\"AC\",BSDXDUZ,BSDXIEN)) Q:'+BSDXIEN  D\n\"RTN\",\"UJOPBSD1\",63,0)\n ;. S BSDXRES=$P(^BSDXRSU(BSDXIEN,0),U)\n\"RTN\",\"UJOPBSD1\",64,0)\n ;\n\"RTN\",\"UJOPBSD1\",65,0)\n ;$O THRU BSDX RESOURCE File\n\"RTN\",\"UJOPBSD1\",66,0)\n ;SET BSDXRES=0 F  S BSDXRES=$O(^BSDXRES(BSDXRES)) Q:'+BSDXRES  D\n\"RTN\",\"UJOPBSD1\",67,0)\n SET BSDXRES=0 S BSDXRES=RESID Q:'+BSDXRES\n\"RTN\",\"UJOPBSD1\",68,0)\n  QUIT:'$D(^BSDXRES(BSDXRES,0))\n\"RTN\",\"UJOPBSD1\",69,0)\n  SET BSDXRNOD=^BSDXRES(BSDXRES,0)\n\"RTN\",\"UJOPBSD1\",70,0)\n  NEW BSDXSC S BSDXSC=$P(BSDXRNOD,U,4)  ; Hospital Location\n\"RTN\",\"UJOPBSD1\",71,0)\n ;EHS/AKH;UJOW*1.0*87;OCT 27,2022;Update[Retrieve Instituation IEN and Hospital Name.]\n\"RTN\",\"UJOPBSD1\",72,0)\n ;Scope        : Scheduling Web\n\"RTN\",\"UJOPBSD1\",73,0)\n ;START OF CODE CHANGE FOR UJOW*1.0*87\n\"RTN\",\"UJOPBSD1\",74,0)\n NEW HOSPIEN,HOSPNAM\n\"RTN\",\"UJOPBSD1\",75,0)\n SET HOSPIEN=$PIECE(^SC(BSDXSC,0),\"^\",4)\n\"RTN\",\"UJOPBSD1\",76,0)\n SET HOSPNAM=$PIECE(^DIC(4,HOSPIEN,0),\"^\",1)\n\"RTN\",\"UJOPBSD1\",77,0)\n ; END OF CODE CHANGE FOR UJOW*1.0*87\n\"RTN\",\"UJOPBSD1\",78,0)\n    ;Q:$P(BSDXRNOD,U,2)=1  ;Inactive resources not filtered\n\"RTN\",\"UJOPBSD1\",79,0)\n  ;S BSDXRDAT=$P(BSDXRNOD,U,1,4)\n\"RTN\",\"UJOPBSD1\",80,0)\n  ;I '$$INDIV(BSDXSC) QUIT  ; If not in division, quit\n\"RTN\",\"UJOPBSD1\",81,0)\n     KILL BSDXRDAT\n\"RTN\",\"UJOPBSD1\",82,0)\n  FOR BSDX=1:1:4 S $P(BSDXRDAT,U,BSDX)=$P(BSDXRNOD,U,BSDX)\n\"RTN\",\"UJOPBSD1\",83,0)\n  SET BSDXRDAT=BSDXRES_U_BSDXRDAT\n\"RTN\",\"UJOPBSD1\",84,0)\n  ;Get letter text from wp field\n\"RTN\",\"UJOPBSD1\",85,0)\n  SET BSDXLTR=\"\"\n\"RTN\",\"UJOPBSD1\",86,0)\n  IF $D(^BSDXRES(BSDXRES,1)) D\n\"RTN\",\"UJOPBSD1\",87,0)\n  . SET BSDXIEN=0\n\"RTN\",\"UJOPBSD1\",88,0)\n  . FOR  SET BSDXIEN=$O(^BSDXRES(BSDXRES,1,BSDXIEN)) Q:'+BSDXIEN  D\n\"RTN\",\"UJOPBSD1\",89,0)\n  . . SET BSDXLTR=BSDXLTR_$G(^BSDXRES(BSDXRES,1,BSDXIEN,0))\n\"RTN\",\"UJOPBSD1\",90,0)\n  . . SET BSDXLTR=BSDXLTR_$C(13)_$C(10)\n\"RTN\",\"UJOPBSD1\",91,0)\n  SET BSDXNOS=\"\"\n\"RTN\",\"UJOPBSD1\",92,0)\n  IF $D(^BSDXRES(BSDXRES,12)) D\n\"RTN\",\"UJOPBSD1\",93,0)\n  . SET BSDXIEN=0 F  S BSDXIEN=$O(^BSDXRES(BSDXRES,12,BSDXIEN)) Q:'+BSDXIEN  D\n\"RTN\",\"UJOPBSD1\",94,0)\n  . . SET BSDXNOS=BSDXNOS_$G(^BSDXRES(BSDXRES,12,BSDXIEN,0))\n\"RTN\",\"UJOPBSD1\",95,0)\n  . . SET BSDXNOS=BSDXNOS_$C(13)_$C(10)\n\"RTN\",\"UJOPBSD1\",96,0)\n  SET BSDXCAN=\"\"\n\"RTN\",\"UJOPBSD1\",97,0)\n  IF $D(^BSDXRES(BSDXRES,13)) D\n\"RTN\",\"UJOPBSD1\",98,0)\n  . SET BSDXIEN=0 F  S BSDXIEN=$O(^BSDXRES(BSDXRES,13,BSDXIEN)) Q:'+BSDXIEN  D\n\"RTN\",\"UJOPBSD1\",99,0)\n  . . SET BSDXCAN=BSDXCAN_$G(^BSDXRES(BSDXRES,13,BSDXIEN,0))\n\"RTN\",\"UJOPBSD1\",100,0)\n  . . SET BSDXCAN=BSDXCAN_$C(13)_$C(10)\n\"RTN\",\"UJOPBSD1\",101,0)\n  NEW BSDXACC,BSDXMGR\n\"RTN\",\"UJOPBSD1\",102,0)\n  SET BSDXACC=\"0^0^0^0\"\n\"RTN\",\"UJOPBSD1\",103,0)\n  SET BSDXMGR=$O(^DIC(19.1,\"B\",\"BSDXZMGR\",0))\n\"RTN\",\"UJOPBSD1\",104,0)\n  IF +BSDXMGR,$D(^VA(200,BSDXDUZ,51,BSDXMGR)) S BSDXACC=\"1^1^1^1\"\n\"RTN\",\"UJOPBSD1\",105,0)\n  SET BSDXMGR=$O(^DIC(19.1,\"B\",\"XUPROGMODE\",0))\n\"RTN\",\"UJOPBSD1\",106,0)\n  IF +BSDXMGR,$D(^VA(200,BSDXDUZ,51,BSDXMGR)) S BSDXACC=\"1^1^1^1\"\n\"RTN\",\"UJOPBSD1\",107,0)\n  ; EHS/MOK;UJOP*2.1*19;OCT 5,2023;Addation[Add can cancel referral to return array his change come from UJOM*2.1*187 and UJOM*2.1*226 in moh.]\n\"RTN\",\"UJOPBSD1\",108,0)\n  ; START OF CODE CHANGE FOR ;UJOP*2.1*19\n\"RTN\",\"UJOPBSD1\",109,0)\n        NEW UJOMCRF\n\"RTN\",\"UJOPBSD1\",110,0)\n        SET UJOMCRF=0\n\"RTN\",\"UJOPBSD1\",111,0)\n        ; END OF CODE CHANGE FOR ;UJOP*2.1*19\n\"RTN\",\"UJOPBSD1\",112,0)\n IF BSDXACC=\"0^0^0^0\" D\n\"RTN\",\"UJOPBSD1\",113,0)\n  . NEW BSDXNOD,BSDXRUID\n\"RTN\",\"UJOPBSD1\",114,0)\n  . ;SET BSDXRUID=0\n\"RTN\",\"UJOPBSD1\",115,0)\n  . ;Get entry for this user and resource\n\"RTN\",\"UJOPBSD1\",116,0)\n  . FOR  SET BSDXRUID=$O(^BSDXRSU(\"AC\",BSDXDUZ,BSDXRUID)) Q:'+BSDXRUID  I $D(^BSDXRSU(BSDXRUID,0)),$P(^(0),U)=BSDXRES Q\n\"RTN\",\"UJOPBSD1\",117,0)\n  . QUIT:'+BSDXRUID\n\"RTN\",\"UJOPBSD1\",118,0)\n  . SET $P(BSDXACC,U)=1\n\"RTN\",\"UJOPBSD1\",119,0)\n  . SET BSDXNOD=$G(^BSDXRSU(BSDXRUID,0))\n\"RTN\",\"UJOPBSD1\",120,0)\n  . SET $P(BSDXACC,U,2)=+$P(BSDXNOD,U,3)\n\"RTN\",\"UJOPBSD1\",121,0)\n  . SET $P(BSDXACC,U,3)=+$P(BSDXNOD,U,4)\n\"RTN\",\"UJOPBSD1\",122,0)\n  . SET $P(BSDXACC,U,4)=+$P(BSDXNOD,U,5)\n\"RTN\",\"UJOPBSD1\",123,0)\n        . ; EHS/MOK;UJOP*2.1*19;OCT 5,2023;Addation[Add can cancel referral to return array This change come from UJOM*2.1*187 and UJOM*2.1*226.]\n\"RTN\",\"UJOPBSD1\",124,0)\n         .;EHS/MOK ;UJOM*2.1*243 ; OCT 22,2023 ;rollback [rollback specific  headers for moh ]\n\"RTN\",\"UJOPBSD1\",125,0)\n  .; EHS/AKH ;\"UJOM*2.1*226\" ; OCT 27,2022 ;Update[Roll Back For MOH Codes];\n\"RTN\",\"UJOPBSD1\",126,0)\n                .; Scope :MOH Roll Back Codes\n\"RTN\",\"UJOPBSD1\",127,0)\n         . ; EHS/ADA;UJOM*2.1*187;DEC 21,2020;Update[Add can cancel referral to return array.]\n\"RTN\",\"UJOPBSD1\",128,0)\n               . ; Reviewed by: Haneen Al-Sheyab\n\"RTN\",\"UJOPBSD1\",129,0)\n  .;START OF CODE CHANGE FOR UJOP*2.1*19\n\"RTN\",\"UJOPBSD1\",130,0)\n        . NEW UJOMGRF\n\"RTN\",\"UJOPBSD1\",131,0)\n        . ;. SET UJOMGRF=$$GET1^DIQ(9002018.15,BSDXRUID,400077000,\"I\")\n\"RTN\",\"UJOPBSD1\",132,0)\n        . SET UJOMGRF=$$GET1^DIQ(9002018.15,BSDXRUID,400000001,\"I\")\n\"RTN\",\"UJOPBSD1\",133,0)\n        . SET:UJOMGRF'=\"\" UJOMCRF=UJOMGRF\n\"RTN\",\"UJOPBSD1\",134,0)\n        . ; END OF CODE CHANGE FOR ;UJOP*2.1*19\n\"RTN\",\"UJOPBSD1\",135,0)\n SET BSDXRDAT=BSDXRDAT_U_BSDXLTR_U_BSDXNOS_U_BSDXCAN_U_BSDXACC\n\"RTN\",\"UJOPBSD1\",136,0)\n     ; EHS/AYG; \"UJO*2.0*61\" ; Nov 28,2013 ; Addition [ADDING BSDX RESOURCE configuration fields]\n\"RTN\",\"UJOPBSD1\",137,0)\n     ; Added the following fields BSDX RESOURCE FILE#9002018.1 :\n\"RTN\",\"UJOPBSD1\",138,0)\n     ; (FIRSTMAX) 400000000 FIRST APPOINTMENTS MAXIMUM \n\"RTN\",\"UJOPBSD1\",139,0)\n     ; (FOLLOMAX) 400000001 FOLLOW-UP APPOINTMENTS MAXIMUM\n\"RTN\",\"UJOPBSD1\",140,0)\n     ; (SLOTMAX)  400000002 APPOINTMENTS/SLOT MAXIMUM\n\"RTN\",\"UJOPBSD1\",141,0)\n     ; (OVERBMAX) 400000003 OVERBOOKS/DAY MAXIMUM\n\"RTN\",\"UJOPBSD1\",142,0)\n     ; (FIRSTSLT) 400000004 SLOTS FOR FIRST APPOINTMENT\n\"RTN\",\"UJOPBSD1\",143,0)\n     ; (FOLLOSLT) 400000005 SLOTS FOR FOLLOWUP APPOINTMENT\n\"RTN\",\"UJOPBSD1\",144,0)\n     ; ; START OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"UJOPBSD1\",145,0)\n     NEW FIRSTMAX,FOLLOMAX,SLOTMAX,OVERBMAX,FIRSTSLT,FOLLOSLT\n\"RTN\",\"UJOPBSD1\",146,0)\n     SET FIRSTMAX=$$GET1^DIQ(9002018.1,BSDXRES_\",\",400000000)\n\"RTN\",\"UJOPBSD1\",147,0)\n     SET FOLLOMAX=$$GET1^DIQ(9002018.1,BSDXRES_\",\",400000001)\n\"RTN\",\"UJOPBSD1\",148,0)\n     SET SLOTMAX=$$GET1^DIQ(9002018.1,BSDXRES_\",\",400000002)\n\"RTN\",\"UJOPBSD1\",149,0)\n     SET OVERBMAX=$$GET1^DIQ(9002018.1,BSDXRES_\",\",400000003)\n\"RTN\",\"UJOPBSD1\",150,0)\n     SET FIRSTSLT=$$GET1^DIQ(9002018.1,BSDXRES_\",\",400000004)\n\"RTN\",\"UJOPBSD1\",151,0)\n     SET FOLLOSLT=$$GET1^DIQ(9002018.1,BSDXRES_\",\",400000005)\n\"RTN\",\"UJOPBSD1\",152,0)\n     SET BSDXRDAT=BSDXRDAT_U_FIRSTMAX_U_FOLLOMAX_U_SLOTMAX_U_OVERBMAX_U_FIRSTSLT_U_FOLLOSLT\n\"RTN\",\"UJOPBSD1\",153,0)\n    ;EHS/ADA;UJOW*1.0*77;MAY 22,2021;Update[Add max number of add on appointment to return array.]\n\"RTN\",\"UJOPBSD1\",154,0)\n    ;Justification: Add max number of add on appointment to return array.\n\"RTN\",\"UJOPBSD1\",155,0)\n    ;Scope        : Scheduling GUI\n\"RTN\",\"UJOPBSD1\",156,0)\n    ;Reviewed by  : Haneen Alsheyb\n\"RTN\",\"UJOPBSD1\",157,0)\n    ;START OF CODE CHANGE FOR; UJOW*1.0*77\n\"RTN\",\"UJOPBSD1\",158,0)\n    NEW MAXADDON\n\"RTN\",\"UJOPBSD1\",159,0)\n    SET MAXADDON=$$GET1^DIQ(9002018.1,BSDXRES_\",\",400087001)\n\"RTN\",\"UJOPBSD1\",160,0)\n    SET BSDXRDAT=BSDXRDAT_U_MAXADDON\n\"RTN\",\"UJOPBSD1\",161,0)\n    ;END OF CODE CHANGE FOR; UJOW*1.0*77\n\"RTN\",\"UJOPBSD1\",162,0)\n    ;EHS/MOK; \"UJOP*2.1*19\" ; OCT 01,2023 ; Addition [add field to check if site is billing This change come from UJOM*2.1*187 and UJOM*2.1*226]\n\"RTN\",\"UJOPBSD1\",163,0)\n    ; START OF CODE CHANGE FOR;UJOP*2.1*19\n\"RTN\",\"UJOPBSD1\",164,0)\n     NEW ISBILLING\n\"RTN\",\"UJOPBSD1\",165,0)\n     SET ISBILLING=$$CHKBILLS(DUZ(2))\n\"RTN\",\"UJOPBSD1\",166,0)\n   ;END OF CODE CHANGE FOR UJOP*2.1*19\n\"RTN\",\"UJOPBSD1\",167,0)\n  ;EHS/AKH;UJOW*1.0*87;OCT 27,2022;Update[Add Instituation IEN and Hospital Name to Array.]\n\"RTN\",\"UJOPBSD1\",168,0)\n   ;Scope        : Scheduling Web\n\"RTN\",\"UJOPBSD1\",169,0)\n   ;START OF CODE CHANGE FOR UJOW*1.0*87\n\"RTN\",\"UJOPBSD1\",170,0)\n                ;SET BSDXRDAT=BSDXRDAT_U_UJOMCRF_U_ISBILLING\n\"RTN\",\"UJOPBSD1\",171,0)\n          SET BSDXRDAT=BSDXRDAT_U_UJOMCRF_U_ISBILLING_U_HOSPIEN_U_HOSPNAM_U\n\"RTN\",\"UJOPBSD1\",172,0)\n          ; END OF CODE CHANGE FOR UJOW*1.0*87\n\"RTN\",\"UJOPBSD1\",173,0)\n    ;END OF CODE CHANGES FOR ; \"UJO*2.0*61\"\n\"RTN\",\"UJOPBSD1\",174,0)\n  S BSDXI=BSDXI+1\n\"RTN\",\"UJOPBSD1\",175,0)\n  S ^BSDXTMP($J,BSDXI)=BSDXRDAT_$C(30)\n\"RTN\",\"UJOPBSD1\",176,0)\n  S ^BSDXTMP($J,BSDXI+1)=$C(31)_BSDXERR\n\"RTN\",\"UJOPBSD1\",177,0)\n Q\n\"RTN\",\"UJOPBSD1\",178,0)\n ;EHS/MOK; \"UJOP*2.1*19\" ; OCT 01,2023 ; Addition [Add new function to check if selected institution in billing or not This change come from UJOM*2.1*187 and UJOM*2.1*226.]\n\"RTN\",\"UJOPBSD1\",179,0)\n        ;Justification : Add new function to check if selected institution in billing or not.\n\"RTN\",\"UJOPBSD1\",180,0)\n        ; START OF CODE CHANGE FOR;UJOP*2.1*19\n\"RTN\",\"UJOPBSD1\",181,0)\n               ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPBSD1\",182,0)\n               ; Name  : CHKBILLS\n\"RTN\",\"UJOPBSD1\",183,0)\n               ;\n\"RTN\",\"UJOPBSD1\",184,0)\n               ; Description  : Function to check if billing system enabled for the billing system application for the logged-in user.\n\"RTN\",\"UJOPBSD1\",185,0)\n               ;\n\"RTN\",\"UJOPBSD1\",186,0)\n               ; In    - INSIEN : Institution IEN from INSTITUTION file #4\n\"RTN\",\"UJOPBSD1\",187,0)\n               ;\n\"RTN\",\"UJOPBSD1\",188,0)\n               ; Out   : N/A\n\"RTN\",\"UJOPBSD1\",189,0)\n               ;\n\"RTN\",\"UJOPBSD1\",190,0)\n               ; Return       :   0 or ENABLED : Billing system is off\n\"RTN\",\"UJOPBSD1\",191,0)\n               ;              :   1 or ENABLED : Billing system is on\n\"RTN\",\"UJOPBSD1\",192,0)\n               ;              :  -1: Error\n\"RTN\",\"UJOPBSD1\",193,0)\n               ;\n\"RTN\",\"UJOPBSD1\",194,0)\n               ; Notes : N/A\n\"RTN\",\"UJOPBSD1\",195,0)\n               ;\n\"RTN\",\"UJOPBSD1\",196,0)\n               ; Author(s)    : Adham Abdelfattah\n\"RTN\",\"UJOPBSD1\",197,0)\n               ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPBSD1\",198,0)\nCHKBILLS(INSIEN)        \n\"RTN\",\"UJOPBSD1\",199,0)\n                IF $GET(INSIEN)=\"\" QUIT -1\n\"RTN\",\"UJOPBSD1\",200,0)\n               NEW BILLIEN,ERR\n\"RTN\",\"UJOPBSD1\",201,0)\n               SET BILLIEN=$$GET1^DIQ(4,INSIEN,\"400000001\",\"I\")\n\"RTN\",\"UJOPBSD1\",202,0)\n               QUIT:BILLIEN'=1 0\n\"RTN\",\"UJOPBSD1\",203,0)\n               QUIT 1\n\"RTN\",\"UJOPBSD1\",204,0)\n ;END OF CODE CHANGE FOR UJOP*2.1*19\n\"RTN\",\"UJOPSCVL\")\n0^6^B100989404\n\"RTN\",\"UJOPSCVL\",1,0)\nUJOPSCVL         ;;EHS/MOH - Patient Portal validation and Adding appointment;MAY 18,2016 ; 2/10/21 10:42am\n\"RTN\",\"UJOPSCVL\",2,0)\n          ;;2.1;UJOP;**1**;MAY 18,2016;Build 11\n\"RTN\",\"UJOPSCVL\",3,0)\n          ;;  Author      : Mohammad Halaika\n\"RTN\",\"UJOPSCVL\",4,0)\n          ;;  Date        : MAY 18,2016\n\"RTN\",\"UJOPSCVL\",5,0)\n          ;;  DESCRIPTION : This Routine contains validation for Patient Portal Appointments\n\"RTN\",\"UJOPSCVL\",6,0)\n QUIT\n\"RTN\",\"UJOPSCVL\",7,0)\n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPSCVL\",8,0)\n ; Name         : ADDING\n\"RTN\",\"UJOPSCVL\",9,0)\n ;\n\"RTN\",\"UJOPSCVL\",10,0)\n ; Description  : Validate Adding appointment details\n\"RTN\",\"UJOPSCVL\",11,0)\n ;              \n\"RTN\",\"UJOPSCVL\",12,0)\n ;\n\"RTN\",\"UJOPSCVL\",13,0)\n ; In           :\n\"RTN\",\"UJOPSCVL\",14,0)\n ;                -BSDXSTART: FM Start Date\n\"RTN\",\"UJOPSCVL\",15,0)\n ;                -BSDXEND: FM End Date\n\"RTN\",\"UJOPSCVL\",16,0)\n ;                -BSDXPATID: Patient DFN\n\"RTN\",\"UJOPSCVL\",17,0)\n ;                -BSDXRES is ResourceName in BSDX RESOURCE file #9002018.1 (not IEN)\n\"RTN\",\"UJOPSCVL\",18,0)\n ;                -[BSDXATID] is used for 2 purposes:\n\"RTN\",\"UJOPSCVL\",19,0)\n ;                         if BSDXATID = \"WALKIN\" then BSDAPI is called to create a walkin appt.\n\"RTN\",\"UJOPSCVL\",20,0)\n ;                         if BSDXATID = a number, then it is the access type id (used for rebooking)\n\"RTN\",\"UJOPSCVL\",21,0)\n ;\n\"RTN\",\"UJOPSCVL\",22,0)\n ; Out          : RET: Validation result:\n\"RTN\",\"UJOPSCVL\",23,0)\n ;                    -Success: \n\"RTN\",\"UJOPSCVL\",24,0)\n ;                     RET(0)=1\n\"RTN\",\"UJOPSCVL\",25,0)\n ;                    -Fail:   \n\"RTN\",\"UJOPSCVL\",26,0)\n ;                     RET(0)=0\n\"RTN\",\"UJOPSCVL\",27,0)\n ;                     RET(1)=\"error message\"\n\"RTN\",\"UJOPSCVL\",28,0)\n ;\n\"RTN\",\"UJOPSCVL\",29,0)\n ; Return       : N/A\n\"RTN\",\"UJOPSCVL\",30,0)\n ;\n\"RTN\",\"UJOPSCVL\",31,0)\n ;\n\"RTN\",\"UJOPSCVL\",32,0)\n ; Notes        : N/A\n\"RTN\",\"UJOPSCVL\",33,0)\n ;\n\"RTN\",\"UJOPSCVL\",34,0)\n ; Author(s)    : Mohammad Halaika, Ayman Ghaith\n\"RTN\",\"UJOPSCVL\",35,0)\n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPSCVL\",36,0)\nADDING(RET,BSDXSTART,BSDXEND,BSDXPATID,BSDXRES,BSDXATID) \n\"RTN\",\"UJOPSCVL\",37,0)\n SET RET(0)=0\n\"RTN\",\"UJOPSCVL\",38,0)\n ;Check for Mandatory fields\n\"RTN\",\"UJOPSCVL\",39,0)\n IF $GET(BSDXSTART)=\"\"!($GET(BSDXEND)=\"\")!($GET(BSDXPATID)=\"\")!($GET(BSDXRES)=\"\") DO  QUIT\n\"RTN\",\"UJOPSCVL\",40,0)\n .SET RET(1)=\"-200~Validation Error: empty required parameters.\"\n\"RTN\",\"UJOPSCVL\",41,0)\n ;Quit if the walkin appointment in future\n\"RTN\",\"UJOPSCVL\",42,0)\n IF BSDXATID=\"WALKIN\"&(BSDXSTART>$$FMADD^XLFDT($$DT^XLFDT,1)) DO  QUIT\n\"RTN\",\"UJOPSCVL\",43,0)\n .SET RET(1)=\"-200~Validation Error: Walkin appointment can not be created in future\"\n\"RTN\",\"UJOPSCVL\",44,0)\n ;If user has the super keys then no need to validate the appointment.\n\"RTN\",\"UJOPSCVL\",45,0)\n IF $$KCHK^XUSRB(\"XUPROGMODE\")!$$KCHK^XUSRB(\"BSDXZMGR\") DO  QUIT\n\"RTN\",\"UJOPSCVL\",46,0)\n .SET RET(0)=1\n\"RTN\",\"UJOPSCVL\",47,0)\n ;Get the resource user IEN from BSDX RESOURCE USER file #9002018.15\n\"RTN\",\"UJOPSCVL\",48,0)\n NEW RESUSER\n\"RTN\",\"UJOPSCVL\",49,0)\n SET RESUSER=$$FIND1^DIC(9002018.15,\"\",\"X\",BSDXRES,\"\",\"IF $P(^(0),U,2)=\"_DUZ)\n\"RTN\",\"UJOPSCVL\",50,0)\n ;Quit if user does not have the \"Modify Appointment\" permission\n\"RTN\",\"UJOPSCVL\",51,0)\n IF '$$GET1^DIQ(9002018.15,RESUSER_\",\",\".05\",\"I\") DO  QUIT\n\"RTN\",\"UJOPSCVL\",52,0)\n .SET RET(1)=\"-200~Validation Error: User does not have MODIFY APPOINTMENTS permission\"\n\"RTN\",\"UJOPSCVL\",53,0)\n ;If the appointment in the past check if the user has the UJO ADD APNTMNT IN PAST key to continue.\n\"RTN\",\"UJOPSCVL\",54,0)\n IF BSDXSTART<$$DT^XLFDT DO  QUIT:$GET(RET(1))'=\"\"\n\"RTN\",\"UJOPSCVL\",55,0)\n .IF '$$KCHK^XUSRB(\"UJO ADD APNTMNT IN PAST\") DO\n\"RTN\",\"UJOPSCVL\",56,0)\n ..SET RET(1)=\"-200~Validation Error: User does not have permission to add appointment in the past\"\n\"RTN\",\"UJOPSCVL\",57,0)\n ;If the appointment in a Holiday check if the user has the UJO ADD APNTMNT IN HOLIDAY key to continue.\n\"RTN\",\"UJOPSCVL\",58,0)\n IF $$GET1^DIQ(40.5,$PIECE(BSDXSTART,\".\"),\"NUMBER\") DO  QUIT:$GET(RET(1))'=\"\"\n\"RTN\",\"UJOPSCVL\",59,0)\n .IF '$$KCHK^XUSRB(\"UJO ADD APNTMNT IN HOLIDAY\") DO\n\"RTN\",\"UJOPSCVL\",60,0)\n ..SET RET(1)=\"-200~Validation Error: User does not have permission to add appointment in Holiday\"\n\"RTN\",\"UJOPSCVL\",61,0)\n ;Get all Available blocks in the same day of this appointment.\n\"RTN\",\"UJOPSCVL\",62,0)\n NEW SCREEN,AVLBLARR,ERR\n\"RTN\",\"UJOPSCVL\",63,0)\n SET SCREEN=\"IF $PIECE(^(0),U,2)[\"_$PIECE(BSDXSTART,\".\")\n\"RTN\",\"UJOPSCVL\",64,0)\n DO FIND^DIC(9002018.3,\"\",\"@;.01;.02I;.03I;.04\",\"PX\",BSDXRES,\"\",\"\",SCREEN,\"\",\"AVLBLARR\",\"ERR\")\n\"RTN\",\"UJOPSCVL\",65,0)\n IF $DATA(ERR) DO  QUIT\n\"RTN\",\"UJOPSCVL\",66,0)\n .DO ERRPRCS^UJOMSGPH(\"UJO COM ERR\",$GET(DUZ),\"\",$GET(DUZ(2)),\",U ADDING~UJOPSCVL:\"_ERR(\"DIERR\",1,\"TEXT\",1))\n\"RTN\",\"UJOPSCVL\",67,0)\n .SET RET(1)=\"-200~Validation Error:\"_ERR(\"DIERR\",1,\"TEXT\",1)\n\"RTN\",\"UJOPSCVL\",68,0)\n ;If the appointment in an off-day check if the user has the UJO ADD APNTMNT IN OFFDAY key to continue.\n\"RTN\",\"UJOPSCVL\",69,0)\n IF +AVLBLARR(\"DILIST\",0)=0 DO  QUIT:$GET(RET(1))'=\"\"\n\"RTN\",\"UJOPSCVL\",70,0)\n .IF '$$KCHK^XUSRB(\"UJO ADD APNTMNT IN OFFDAY\") DO\n\"RTN\",\"UJOPSCVL\",71,0)\n ..SET RET(1)=\"-200~Validation Error: User does not have permission to add appointment in an off-day\"\n\"RTN\",\"UJOPSCVL\",72,0)\n ;Get all appointments in the same day of this appointment.\n\"RTN\",\"UJOPSCVL\",73,0)\n NEW RESIEN,SCREEN,APPTARR,ERR\n\"RTN\",\"UJOPSCVL\",74,0)\n SET RESIEN=$$FIND1^DIC(9002018.1,\"\",\"X\",BSDXRES,\"B\")\n\"RTN\",\"UJOPSCVL\",75,0)\n SET SCREEN=\"IF $PIECE(^(0),U,7)=\"_RESIEN_\"&$PIECE(^(0),U,12)=\"\"\"\"\"\n\"RTN\",\"UJOPSCVL\",76,0)\n DO FIND^DIC(9002018.4,\"\",\"@;.01;.06\",\"P\",$PIECE(BSDXSTART,\".\"),\"\",\"\",SCREEN,\"\",\"APPTARR\",\"ERR\")\n\"RTN\",\"UJOPSCVL\",77,0)\n IF $DATA(ERR) DO  QUIT\n\"RTN\",\"UJOPSCVL\",78,0)\n .DO ERRPRCS^UJOMSGPH(\"UJO COM ERR\",$GET(DUZ),\"\",$GET(DUZ(2)),\",U ADDING~UJOPSCVL:\"_ERR(\"DIERR\",1,\"TEXT\",1))\n\"RTN\",\"UJOPSCVL\",79,0)\n .SET RET(1)=\"-200~Validation Error:\"_ERR(\"DIERR\",1,\"TEXT\",1)\n\"RTN\",\"UJOPSCVL\",80,0)\n ;Get Maximum OVERBOOKS per DAY field from BSDX RESOURCE file #9002018.1\n\"RTN\",\"UJOPSCVL\",81,0)\n NEW MAXOVERB\n\"RTN\",\"UJOPSCVL\",82,0)\n SET MAXOVERB=$$GET1^DIQ(9002018.1,RESIEN_\",\",400000003)\n\"RTN\",\"UJOPSCVL\",83,0)\n ;Search for the available block that holds the appointment, if the appointment not related to an available block then it is overbooked.\n\"RTN\",\"UJOPSCVL\",84,0)\n ;Loop in the AVLBLARR array.\n\"RTN\",\"UJOPSCVL\",85,0)\n NEW UJOI,AVSTART,AVEND,AVSLOTS\n\"RTN\",\"UJOPSCVL\",86,0)\n SET (UJOI,AVSTART,AVEND)=0\n\"RTN\",\"UJOPSCVL\",87,0)\n FOR  SET UJOI=$ORDER(AVLBLARR(\"DILIST\",UJOI)) QUIT:'UJOI!($GET(AVSTART)>0)  DO\n\"RTN\",\"UJOPSCVL\",88,0)\n .;go to the next available block if not contains the appointment.\n\"RTN\",\"UJOPSCVL\",89,0)\n .IF BSDXSTART'<$PIECE(AVLBLARR(\"DILIST\",UJOI,0),\"^\",3)&(BSDXSTART'>$PIECE(AVLBLARR(\"DILIST\",UJOI,0),\"^\",4)) DO\n\"RTN\",\"UJOPSCVL\",90,0)\n ..SET AVSTART=$PIECE(AVLBLARR(\"DILIST\",UJOI,0),\"^\",3)\n\"RTN\",\"UJOPSCVL\",91,0)\n ..SET AVEND=$PIECE(AVLBLARR(\"DILIST\",UJOI,0),\"^\",4)\n\"RTN\",\"UJOPSCVL\",92,0)\n ..SET AVSLOTS=$PIECE(AVLBLARR(\"DILIST\",UJOI,0),\"^\",5)\n\"RTN\",\"UJOPSCVL\",93,0)\n ;IF Available start is 0 then no available block for the appointment and there for the appointment is overbooked.\n\"RTN\",\"UJOPSCVL\",94,0)\n ;Quit if the AVSTART=0 and the appointment access type not equal to 0\n\"RTN\",\"UJOPSCVL\",95,0)\n IF AVSTART=0&(+BSDXATID>0) DO  QUIT\n\"RTN\",\"UJOPSCVL\",96,0)\n .SET RET(1)=\"-200~Validation Error: appointment must be overbooked since there is no available slots\"\n\"RTN\",\"UJOPSCVL\",97,0)\n ;Count the overbooked appointments and available block appointments\n\"RTN\",\"UJOPSCVL\",98,0)\n ;Loop in the APPTARR arary\n\"RTN\",\"UJOPSCVL\",99,0)\n NEW UJOI,OVERBOOK,SLOTS\n\"RTN\",\"UJOPSCVL\",100,0)\n SET (UJOI,OVERBOOK,SLOTS)=0\n\"RTN\",\"UJOPSCVL\",101,0)\n FOR  SET UJOI=$ORDER(APPTARR(\"DILIST\",UJOI)) QUIT:'UJOI!(SLOTS>AVSLOTS)  DO\n\"RTN\",\"UJOPSCVL\",102,0)\n .SET:$PIECE(APPTARR(\"DILIST\",UJOI,0),\"^\",3)=0 OVERBOOK=OVERBOOK+1\n\"RTN\",\"UJOPSCVL\",103,0)\n .SET:$PIECE(APPTARR(\"DILIST\",UJOI,0),\"^\",2)'<AVSTART&($PIECE(APPTARR(\"DILIST\",UJOI,0),\"^\",2)<AVEND) SLOTS=SLOTS+1\n\"RTN\",\"UJOPSCVL\",104,0)\n ;Check if exceed the number of available slots then quit\n\"RTN\",\"UJOPSCVL\",105,0)\n IF AVSTART>0&(SLOTS'<AVSLOTS) DO  QUIT\n\"RTN\",\"UJOPSCVL\",106,0)\n .SET RET(1)=\"-200~Validation Error: Available block reached the Maximum number of appointments\"\n\"RTN\",\"UJOPSCVL\",107,0)\n ;Check if the user has permission for overbooking\n\"RTN\",\"UJOPSCVL\",108,0)\n IF BSDXATID=0&('$$GET1^DIQ(9002018.15,RESUSER_\",\",\".03\",\"I\")) DO  QUIT\n\"RTN\",\"UJOPSCVL\",109,0)\n .SET RET(1)=\"-200~Validation Error: User does not have OVERBOOK permission\"\n\"RTN\",\"UJOPSCVL\",110,0)\n ;Check if overbooked appointment reached the Maximum OVERBOOKS per DAY\n\"RTN\",\"UJOPSCVL\",111,0)\n IF BSDXATID=0&(OVERBOOK'<MAXOVERB) DO  QUIT\n\"RTN\",\"UJOPSCVL\",112,0)\n .SET RET(1)=\"-200~Validation Error: Resource clinic reached the Maximum number of overbooked appointments\"\n\"RTN\",\"UJOPSCVL\",113,0)\n ;Success\n\"RTN\",\"UJOPSCVL\",114,0)\n SET RET(0)=1\n\"RTN\",\"UJOPSCVL\",115,0)\n QUIT\n\"RTN\",\"UJOPSCVL\",116,0)\n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPSCVL\",117,0)\n ; Name         : CANCEL\n\"RTN\",\"UJOPSCVL\",118,0)\n ;\n\"RTN\",\"UJOPSCVL\",119,0)\n ; Description  : Validate Cancelling appointment\n\"RTN\",\"UJOPSCVL\",120,0)\n ;              \n\"RTN\",\"UJOPSCVL\",121,0)\n ;\n\"RTN\",\"UJOPSCVL\",122,0)\n ; In           :\n\"RTN\",\"UJOPSCVL\",123,0)\n ;                - BSDXAPTID: Entry number in BSDX APPOINTMENT file 9002018.4\n\"RTN\",\"UJOPSCVL\",124,0)\n ;\n\"RTN\",\"UJOPSCVL\",125,0)\n ; Out          : -RET: Validation result:\n\"RTN\",\"UJOPSCVL\",126,0)\n ;                    -Success: \n\"RTN\",\"UJOPSCVL\",127,0)\n ;                     RET(0)=1\n\"RTN\",\"UJOPSCVL\",128,0)\n ;                    -Fail:   \n\"RTN\",\"UJOPSCVL\",129,0)\n ;                     RET(0)=0\n\"RTN\",\"UJOPSCVL\",130,0)\n ;                     RET(1)=\"error message\"\n\"RTN\",\"UJOPSCVL\",131,0)\n ;\n\"RTN\",\"UJOPSCVL\",132,0)\n ; Return       : N/A\n\"RTN\",\"UJOPSCVL\",133,0)\n ;\n\"RTN\",\"UJOPSCVL\",134,0)\n ;\n\"RTN\",\"UJOPSCVL\",135,0)\n ; Notes        : N/A\n\"RTN\",\"UJOPSCVL\",136,0)\n ;\n\"RTN\",\"UJOPSCVL\",137,0)\n ; Author(s)    : Mohammad Halaika, Ayman Ghaith\n\"RTN\",\"UJOPSCVL\",138,0)\n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPSCVL\",139,0)\nCANCEL(RET,BSDXAPTID) \n\"RTN\",\"UJOPSCVL\",140,0)\n SET RET(0)=0\n\"RTN\",\"UJOPSCVL\",141,0)\n ;Check for Mandatory fields\n\"RTN\",\"UJOPSCVL\",142,0)\n IF $GET(BSDXAPTID)=\"\" DO  QUIT\n\"RTN\",\"UJOPSCVL\",143,0)\n .SET RET(1)=\"-200~Validation Error: empty required parameters.\"\n\"RTN\",\"UJOPSCVL\",144,0)\n ;Check if the appointment checked-in , if yes then can not cancel the appointment.\n\"RTN\",\"UJOPSCVL\",145,0)\n IF $$GET1^DIQ(\"9002018.4\",BSDXAPTID,\".03\")'=\"\" DO  QUIT\n\"RTN\",\"UJOPSCVL\",146,0)\n .SET RET(1)=\"-200~Validation Error: Can not cancel checked in appointment.\"\n\"RTN\",\"UJOPSCVL\",147,0)\n ;Check if this is Radiology appointment, can not cancel if the status is active or complete or discontinued.\n\"RTN\",\"UJOPSCVL\",148,0)\n NEW RADIEN\n\"RTN\",\"UJOPSCVL\",149,0)\n SET RADIEN=$$GET1^DIQ(\"9002018.4\",BSDXAPTID,\".14\",\"I\")\n\"RTN\",\"UJOPSCVL\",150,0)\n IF RADIEN>0 DO  QUIT:RET(1)'=\"\"\n\"RTN\",\"UJOPSCVL\",151,0)\n .;Check if Radiology status equal to (active or complete or discontinued), can not cancel these statuses.\n\"RTN\",\"UJOPSCVL\",152,0)\n .NEW STATUS\n\"RTN\",\"UJOPSCVL\",153,0)\n .SET STATUS=$$GET1^DIQ(75.1,RADIEN,\"REQUEST STATUS\",\"I\")\n\"RTN\",\"UJOPSCVL\",154,0)\n .IF \"^1^2^6^\"[(\"^\"_STATUS_\"^\") SET RET(1)=\"-200~Validation Error: Can not cancel (active or complete or discontinued) radiology appointment.\"\n\"RTN\",\"UJOPSCVL\",155,0)\n ;If user has the super keys then no need to validate the appointment cancellation.\n\"RTN\",\"UJOPSCVL\",156,0)\n IF $$KCHK^XUSRB(\"XUPROGMODE\")!$$KCHK^XUSRB(\"BSDXZMGR\") DO  QUIT\n\"RTN\",\"UJOPSCVL\",157,0)\n .SET RET(0)=1\n\"RTN\",\"UJOPSCVL\",158,0)\n ;Get the resource user IEN from BSDX RESOURCE USER file #9002018.15\n\"RTN\",\"UJOPSCVL\",159,0)\n NEW RESUSER,BSDXRES\n\"RTN\",\"UJOPSCVL\",160,0)\n SET BSDXRES=$$GET1^DIQ(\"9002018.4\",BSDXAPTID,\".07\")\n\"RTN\",\"UJOPSCVL\",161,0)\n SET RESUSER=$$FIND1^DIC(9002018.15,\"\",\"X\",BSDXRES,\"\",\"IF $P(^(0),U,2)=\"_DUZ)\n\"RTN\",\"UJOPSCVL\",162,0)\n ;Quit if user does not have the Modify appointment permission\n\"RTN\",\"UJOPSCVL\",163,0)\n        ;EHS/MOK; \"UJOP*2.1*19\" ; OCT 5,2023 ; Update [Check CAN MODIFAY APPOINTMENT if appointment is not referral appointment This change come from UJOM*2.1*187 in moh.]\n\"RTN\",\"UJOPSCVL\",164,0)\n        ;EHS/MOK ;UJOM*2.1*243 ; OCT 22,2023 ;rollback [rollback specific  headers for moh ]\n\"RTN\",\"UJOPSCVL\",165,0)\n  ;EHS/ADA; \"UJOM*2.1*187\" ; MAR 21,2021 ; Update [Check CAN MODIFAY APPOINTMENT if appointment is not referral appointment.]\n\"RTN\",\"UJOPSCVL\",166,0)\n               ;Justification : Check CAN MODIFAY APPOINTMENT if appointment is not referral appointment.\n\"RTN\",\"UJOPSCVL\",167,0)\n               ; Scope: Sceduling web\n\"RTN\",\"UJOPSCVL\",168,0)\n               ; Reviewed By: Hannen Alshyab\n\"RTN\",\"UJOPSCVL\",169,0)\n        ; START OF CODE CHANGE FOR;UJOP*2.1*19\n\"RTN\",\"UJOPSCVL\",170,0)\n               ;Quit if user does not have the Modify appointment permission\n\"RTN\",\"UJOPSCVL\",171,0)\n               ;IF '$$GET1^DIQ(9002018.15,RESUSER_\",\",\".05\",\"I\") DO  QUIT\n\"RTN\",\"UJOPSCVL\",172,0)\n               ;.SET RET(1)=\"-200~Validation Error: User does not have MODIFY APPOINTMENTS permission\"\n\"RTN\",\"UJOPSCVL\",173,0)\n         ;IF $$GET1^DIQ(9002018.4,BSDXAPTID,400077000)'=\"YES\" DO\n\"RTN\",\"UJOPSCVL\",174,0)\n  IF $$GET1^DIQ(9002018.4,BSDXAPTID,400000003)'=\"YES\" DO\n\"RTN\",\"UJOPSCVL\",175,0)\n        . IF '$$GET1^DIQ(9002018.15,RESUSER_\",\",\".05\",\"I\") DO  QUIT\n\"RTN\",\"UJOPSCVL\",176,0)\n               . . SET RET(1)=\"-200~Validation Error: User does not have MODIFY APPOINTMENTS permission\"\n\"RTN\",\"UJOPSCVL\",177,0)\n               ; END OF CODE CHANGE FOR;UJOP*2.1*19\n\"RTN\",\"UJOPSCVL\",178,0)\n ;Success\n\"RTN\",\"UJOPSCVL\",179,0)\n SET RET(0)=1\n\"RTN\",\"UJOPSCVL\",180,0)\n QUIT\n\"RTN\",\"UJOPSCVL\",181,0)\n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPSCVL\",182,0)\n ; Name         : CHECKIN\n\"RTN\",\"UJOPSCVL\",183,0)\n ;\n\"RTN\",\"UJOPSCVL\",184,0)\n ; Description  : Validate Check-in appointment\n\"RTN\",\"UJOPSCVL\",185,0)\n ;              \n\"RTN\",\"UJOPSCVL\",186,0)\n ;\n\"RTN\",\"UJOPSCVL\",187,0)\n ; In           :\n\"RTN\",\"UJOPSCVL\",188,0)\n ;                - BSDXAPTID: Entry number in BSDX APPOINTMENT file 9002018.4\n\"RTN\",\"UJOPSCVL\",189,0)\n ;\n\"RTN\",\"UJOPSCVL\",190,0)\n ; Out          : -RET: Validation result:\n\"RTN\",\"UJOPSCVL\",191,0)\n ;                    -Success: \n\"RTN\",\"UJOPSCVL\",192,0)\n ;                     RET(0)=1\n\"RTN\",\"UJOPSCVL\",193,0)\n ;                    -Fail:\n\"RTN\",\"UJOPSCVL\",194,0)\n ;                     RET(0)=0\n\"RTN\",\"UJOPSCVL\",195,0)\n ;                     RET(1)=\"error message\"\n\"RTN\",\"UJOPSCVL\",196,0)\n ;\n\"RTN\",\"UJOPSCVL\",197,0)\n ; Return       : N/A\n\"RTN\",\"UJOPSCVL\",198,0)\n ;\n\"RTN\",\"UJOPSCVL\",199,0)\n ;\n\"RTN\",\"UJOPSCVL\",200,0)\n ; Notes        : N/A\n\"RTN\",\"UJOPSCVL\",201,0)\n ;\n\"RTN\",\"UJOPSCVL\",202,0)\n ; Author(s)    : Mohammad Halaika, Ayman Ghaith\n\"RTN\",\"UJOPSCVL\",203,0)\n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPSCVL\",204,0)\nCHECKIN(RET,BSDXAPTID) \n\"RTN\",\"UJOPSCVL\",205,0)\n SET RET(0)=0\n\"RTN\",\"UJOPSCVL\",206,0)\n ;Check for Mandatory fields\n\"RTN\",\"UJOPSCVL\",207,0)\n IF $GET(BSDXAPTID)=\"\" DO  QUIT\n\"RTN\",\"UJOPSCVL\",208,0)\n .SET RET(1)=\"-200~Validation Error: empty required parameters.\"\n\"RTN\",\"UJOPSCVL\",209,0)\n ;Can not check-in appointment in future\n\"RTN\",\"UJOPSCVL\",210,0)\n NEW APSTART\n\"RTN\",\"UJOPSCVL\",211,0)\n SET APSTART=$$GET1^DIQ(\"9002018.4\",BSDXAPTID,\"STARTTIME\",\"I\")\n\"RTN\",\"UJOPSCVL\",212,0)\n IF APSTART>$$FMADD^XLFDT($$DT^XLFDT,1) DO  QUIT\n\"RTN\",\"UJOPSCVL\",213,0)\n .SET RET(1)=\"-200~Validation Error: Can not check-in appointment in future\"\n\"RTN\",\"UJOPSCVL\",214,0)\n ;Can not check-in checked-out appointment.\n\"RTN\",\"UJOPSCVL\",215,0)\n ;Get the patient IEN to get appointment status.\n\"RTN\",\"UJOPSCVL\",216,0)\n NEW PATIEN\n\"RTN\",\"UJOPSCVL\",217,0)\n SET PATIEN=$$GET1^DIQ(\"9002018.4\",BSDXAPTID,\"PATIENT\",\"I\")\n\"RTN\",\"UJOPSCVL\",218,0)\n ;Check if status is checked out, if yes quit\n\"RTN\",\"UJOPSCVL\",219,0)\n IF $$GET1^DIQ(2.98,APSTART_\",\"_PATIEN,\"100\")=\"CHECKED OUT\" DO  QUIT\n\"RTN\",\"UJOPSCVL\",220,0)\n .SET RET(1)=\"-200~Validation Error: Can not check-in a checked-out appointment\"\n\"RTN\",\"UJOPSCVL\",221,0)\n ;If user has the super keys then no need to validate the check-in appointment.\n\"RTN\",\"UJOPSCVL\",222,0)\n IF $$KCHK^XUSRB(\"XUPROGMODE\")!$$KCHK^XUSRB(\"BSDXZMGR\") DO  QUIT\n\"RTN\",\"UJOPSCVL\",223,0)\n .SET RET(0)=1\n\"RTN\",\"UJOPSCVL\",224,0)\n ;Get the resource user IEN from BSDX RESOURCE USER file #9002018.15\n\"RTN\",\"UJOPSCVL\",225,0)\n NEW RESUSER,BSDXRES\n\"RTN\",\"UJOPSCVL\",226,0)\n SET BSDXRES=$$GET1^DIQ(\"9002018.4\",BSDXAPTID,\".07\")\n\"RTN\",\"UJOPSCVL\",227,0)\n SET RESUSER=$$FIND1^DIC(9002018.15,\"\",\"X\",BSDXRES,\"\",\"IF $P(^(0),U,2)=\"_DUZ)\n\"RTN\",\"UJOPSCVL\",228,0)\n ;Quit if user does not have the Modify appointment permission\n\"RTN\",\"UJOPSCVL\",229,0)\n  IF '$$GET1^DIQ(9002018.15,RESUSER_\",\",\".05\",\"I\") DO  QUIT\n\"RTN\",\"UJOPSCVL\",230,0)\n          .SET RET(1)=\"-200~Validation Error: User does not have MODIFY APPOINTMENTS permission\"\n\"RTN\",\"UJOPSCVL\",231,0)\n ;Success\n\"RTN\",\"UJOPSCVL\",232,0)\n SET RET(0)=1\n\"RTN\",\"UJOPSCVL\",233,0)\n QUIT\n\"RTN\",\"UJOPSCVL\",234,0)\n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPSCVL\",235,0)\n ; Name         : REMCHECK\n\"RTN\",\"UJOPSCVL\",236,0)\n ;\n\"RTN\",\"UJOPSCVL\",237,0)\n ; Description  : Validate removing check-in appointment\n\"RTN\",\"UJOPSCVL\",238,0)\n ;              \n\"RTN\",\"UJOPSCVL\",239,0)\n ;\n\"RTN\",\"UJOPSCVL\",240,0)\n ; In           :\n\"RTN\",\"UJOPSCVL\",241,0)\n ;                - BSDXAPTID: Entry number in BSDX APPOINTMENT file 9002018.4\n\"RTN\",\"UJOPSCVL\",242,0)\n ;\n\"RTN\",\"UJOPSCVL\",243,0)\n ; Out          : -RET: Validation result:\n\"RTN\",\"UJOPSCVL\",244,0)\n ;                    -Success: \n\"RTN\",\"UJOPSCVL\",245,0)\n ;                     RET(0)=1\n\"RTN\",\"UJOPSCVL\",246,0)\n ;                    -Fail:   \n\"RTN\",\"UJOPSCVL\",247,0)\n ;                     RET(0)=0\n\"RTN\",\"UJOPSCVL\",248,0)\n ;                     RET(1)=\"error message\"\n\"RTN\",\"UJOPSCVL\",249,0)\n ;\n\"RTN\",\"UJOPSCVL\",250,0)\n ; Return       : N/A\n\"RTN\",\"UJOPSCVL\",251,0)\n ;\n\"RTN\",\"UJOPSCVL\",252,0)\n ;\n\"RTN\",\"UJOPSCVL\",253,0)\n ; Notes        : N/A\n\"RTN\",\"UJOPSCVL\",254,0)\n ;\n\"RTN\",\"UJOPSCVL\",255,0)\n ; Author(s)    : Mohammad Halaika, Ayman Ghaith\n\"RTN\",\"UJOPSCVL\",256,0)\n ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPSCVL\",257,0)\nREMCHECK(RET,BSDXAPTID) \n\"RTN\",\"UJOPSCVL\",258,0)\n SET RET(0)=0\n\"RTN\",\"UJOPSCVL\",259,0)\n ;Check for Mandatory fields\n\"RTN\",\"UJOPSCVL\",260,0)\n IF $GET(BSDXAPTID)=\"\" DO  QUIT\n\"RTN\",\"UJOPSCVL\",261,0)\n .SET RET(1)=\"-200~Validation Error: empty required parameters.\"\n\"RTN\",\"UJOPSCVL\",262,0)\n ;GET Appointment start time,check-in,patient IEN\n\"RTN\",\"UJOPSCVL\",263,0)\n NEW ARR,ERR\n\"RTN\",\"UJOPSCVL\",264,0)\n DO GETS^DIQ(9002018.4,BSDXAPTID_\",\",\".01;.03;.05\",\"I\",\"ARR\",\"ERR\")\n\"RTN\",\"UJOPSCVL\",265,0)\n IF $DATA(ERR) DO  QUIT\n\"RTN\",\"UJOPSCVL\",266,0)\n .SET RET(1)=\"-200~Validation Error:\"_ERR(\"DIERR\",1,\"TEXT\",1)\n\"RTN\",\"UJOPSCVL\",267,0)\n ;Check for check in date ,, can not remove check in if not checked-in.\n\"RTN\",\"UJOPSCVL\",268,0)\n IF $GET(ARR(9002018.4,BSDXAPTID_\",\",.03,\"I\"))=\"\" DO  QUIT\n\"RTN\",\"UJOPSCVL\",269,0)\n .SET RET(1)=\"-200~Validation Error: Can not remove check-in for not checked-in appointment.\"\n\"RTN\",\"UJOPSCVL\",270,0)\n ;Check if status is checked out , if yes quit\n\"RTN\",\"UJOPSCVL\",271,0)\n NEW APSTART,PATIEN\n\"RTN\",\"UJOPSCVL\",272,0)\n SET APSTART=ARR(9002018.4,BSDXAPTID_\",\",.01,\"I\")\n\"RTN\",\"UJOPSCVL\",273,0)\n SET PATIEN=ARR(9002018.4,BSDXAPTID_\",\",.05,\"I\")\n\"RTN\",\"UJOPSCVL\",274,0)\n IF $$GET1^DIQ(2.98,APSTART_\",\"_PATIEN,\"100\")=\"CHECKED OUT\" DO  QUIT\n\"RTN\",\"UJOPSCVL\",275,0)\n .SET RET(1)=\"-200~Validation Error: Can not remove check-in for a checked-out appointment\"\n\"RTN\",\"UJOPSCVL\",276,0)\n ;Success\n\"RTN\",\"UJOPSCVL\",277,0)\n SET RET(0)=1\n\"RTN\",\"UJOPSCVL\",278,0)\n QUIT\n\"RTN\",\"UJOWASC\")\n0^2^B124001134\n\"RTN\",\"UJOWASC\",1,0)\nUJOWASC  ;;EHS/TOA - Scheduling Web Application Product,Getting appointment list ;Jan 13,2021; 9/28/21 12:53pm\n\"RTN\",\"UJOWASC\",2,0)\n         ;;1.0;UJOW;**77**;Jan 13,2021;Build 11\n\"RTN\",\"UJOWASC\",3,0)\n         ;;  Author      : Toqa Abbas\n\"RTN\",\"UJOWASC\",4,0)\n         ;;  Date        : Jan 13,2021\n\"RTN\",\"UJOWASC\",5,0)\n         ;;  Description : This routine used to get list of appointments for sent criteria\n\"RTN\",\"UJOWASC\",6,0)\n         ;;                refer to \"BSDX02\" routines as a reference to those API's.\n\"RTN\",\"UJOWASC\",7,0)\n                ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",8,0)\n         QUIT\n\"RTN\",\"UJOWASC\",9,0)\n      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",10,0)\n      ; Name         : GETLIST\n\"RTN\",\"UJOWASC\",11,0)\n      ;\n\"RTN\",\"UJOWASC\",12,0)\n      ; Description  : Create Resource Appointment Schedule recordset\n\"RTN\",\"UJOWASC\",13,0)\n      ;\n\"RTN\",\"UJOWASC\",14,0)\n      ; In           :  BSDXRES: BSDX RESOURCE file #9002018.1 IEN's seperated via \"|\"\n\"RTN\",\"UJOWASC\",15,0)\n      ;                 BSDXST : FM Start Date\n\"RTN\",\"UJOWASC\",16,0)\n      ;                 BSDXEND: FM End Date\n\"RTN\",\"UJOWASC\",17,0)\n      ;                [BSDXWKIN]:Walk in flag (0:don't display walkin,otherwise display\n\"RTN\",\"UJOWASC\",18,0)\n      ;\n\"RTN\",\"UJOWASC\",19,0)\n      ; Out          : -1^Error : Fail\n\"RTN\",\"UJOWASC\",20,0)\n      ;                 LIST    : Success (array of appointments details) (send by refernece)\n\"RTN\",\"UJOWASC\",21,0)\n      ;\n\"RTN\",\"UJOWASC\",22,0)\n      ; Return       : N/A\n\"RTN\",\"UJOWASC\",23,0)\n      ;\n\"RTN\",\"UJOWASC\",24,0)\n      ; Notes        : N/A\n\"RTN\",\"UJOWASC\",25,0)\n      ;\n\"RTN\",\"UJOWASC\",26,0)\n      ; Author(s)    : Toqa Abbas\n\"RTN\",\"UJOWASC\",27,0)\n      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",28,0)\nGETLIST(LIST,BSDXRES,BSDXST,BSDXEND,BSDXWKIN) \n\"RTN\",\"UJOWASC\",29,0)\n       IF $GET(BSDXRES)=\"\"!($GET(BSDXST)=\"\")!($GET(BSDXEND)=\"\") DO  QUIT\n\"RTN\",\"UJOWASC\",30,0)\n       .SET LIST=\"-1^Empty input parameter\"\n\"RTN\",\"UJOWASC\",31,0)\n           ;EHS/AKH;UJOW*1.0*87;SEP 12,2022;Update[Update Date Parameter To Accept Date And Time Parameter .]\n\"RTN\",\"UJOWASC\",32,0)\n           ;Scope        : Scheduling Web\n\"RTN\",\"UJOWASC\",33,0)\n           ;START OF CODE CHANGE FOR patch UJOW*1.0*87\n\"RTN\",\"UJOWASC\",34,0)\n           IF $PIECE(BSDXST,\".\",2)'=\"\" DO\n\"RTN\",\"UJOWASC\",35,0)\n           .SET BSDXST=BSDXST-.0001\n\"RTN\",\"UJOWASC\",36,0)\n           ;SET BSDXEND=BSDXEND+.235959\n\"RTN\",\"UJOWASC\",37,0)\n           IF $PIECE(BSDXST,\".\",2)=\"\" DO \n\"RTN\",\"UJOWASC\",38,0)\n           .SET BSDXST=BSDXST-.0001\n\"RTN\",\"UJOWASC\",39,0)\n           .SET BSDXEND=BSDXEND+.235959\n\"RTN\",\"UJOWASC\",40,0)\n           ;END CHANGE OF CODE  patch UJOW*1.0*87\n\"RTN\",\"UJOWASC\",41,0)\n    ;loop resources ien's seperated via \"|\"\n\"RTN\",\"UJOWASC\",42,0)\n    NEW BSDXJ,BSDXRESN\n\"RTN\",\"UJOWASC\",43,0)\n    FOR BSDXJ=1:1:$LENGTH(BSDXRES,\"|\") SET BSDXRESN=$PIECE(BSDXRES,\"|\",BSDXJ) QUIT:$GET(BSDXRESN)=\"\"  DO\n\"RTN\",\"UJOWASC\",44,0)\n    . FOR  SET BSDXST=$ORDER(^BSDXAPPT(\"ARSRC\",BSDXRESN,BSDXST)) QUIT:($GET(BSDXST)=\"\")!(BSDXST>BSDXEND)  DO\n\"RTN\",\"UJOWASC\",45,0)\n    . . NEW BSDXIEN\n\"RTN\",\"UJOWASC\",46,0)\n    . . FOR  SET BSDXIEN=$ORDER(^BSDXAPPT(\"ARSRC\",BSDXRESN,BSDXST,BSDXIEN))  QUIT:$GET(BSDXIEN)=\"\"  DO\n\"RTN\",\"UJOWASC\",47,0)\n    . . .;quit if this appointment will be ignored\n\"RTN\",\"UJOWASC\",48,0)\n    . . .QUIT:'$$CHKAPT(BSDXIEN,BSDXWKIN)\n\"RTN\",\"UJOWASC\",49,0)\n    . . .;build main info.\n\"RTN\",\"UJOWASC\",50,0)\n    . . .NEW DATA\n\"RTN\",\"UJOWASC\",51,0)\n    . . .SET DATA=$$BUILD(.LIST,BSDXIEN)\n\"RTN\",\"UJOWASC\",52,0)\n    . . .SET:DATA=0 LIST(BSDXIEN,\"NODATA\")=1\n\"RTN\",\"UJOWASC\",53,0)\n    . .SET:'$DATA(LIST) LIST=0\n\"RTN\",\"UJOWASC\",54,0)\n    SET:'$DATA(LIST) LIST=0\n\"RTN\",\"UJOWASC\",55,0)\n    QUIT\n\"RTN\",\"UJOWASC\",56,0)\n      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",57,0)\n      ; Name         : CHKAPT\n\"RTN\",\"UJOWASC\",58,0)\n      ;\n\"RTN\",\"UJOWASC\",59,0)\n      ; Description  : This function used to check appointment will be displayed or not\n\"RTN\",\"UJOWASC\",60,0)\n      ;\n\"RTN\",\"UJOWASC\",61,0)\n      ; In           : BSDXIEN   : BSDX APPOINTMENT #9002018.4 file IEN\n\"RTN\",\"UJOWASC\",62,0)\n      ;                [BSDXWKIN]:Walk in flag (0:don't display walkin,otherwise display\n\"RTN\",\"UJOWASC\",63,0)\n      ;\n\"RTN\",\"UJOWASC\",64,0)\n             ; Out          : N/A\n\"RTN\",\"UJOWASC\",65,0)\n      ;\n\"RTN\",\"UJOWASC\",66,0)\n      ; Return       : 0 : Not display\n\"RTN\",\"UJOWASC\",67,0)\n      ;                1 : display\n\"RTN\",\"UJOWASC\",68,0)\n      ;\n\"RTN\",\"UJOWASC\",69,0)\n      ; Notes        : N/A\n\"RTN\",\"UJOWASC\",70,0)\n      ;\n\"RTN\",\"UJOWASC\",71,0)\n      ; Author(s)    : Toqa Abbas\n\"RTN\",\"UJOWASC\",72,0)\n      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",73,0)\nCHKAPT(BSDXIEN,BSDXWKIN) \n\"RTN\",\"UJOWASC\",74,0)\n  IF $GET(BSDXIEN)=\"\"!('$DATA(^BSDXAPPT(BSDXIEN,0))) QUIT 0\n\"RTN\",\"UJOWASC\",75,0)\n  ;ignore cancelled appt's\n\"RTN\",\"UJOWASC\",76,0)\n  QUIT:$PIECE(^BSDXAPPT(BSDXIEN,0),\"^\",12)'=\"\" 0\n\"RTN\",\"UJOWASC\",77,0)\n  ;ignore walkin if flag set to 0,otherwise display them\n\"RTN\",\"UJOWASC\",78,0)\n  QUIT:$GET(BSDXWKIN)=0&($PIECE(^BSDXAPPT(BSDXIEN,0),\"^\",13)=\"y\") 0\n\"RTN\",\"UJOWASC\",79,0)\n  QUIT 1\n\"RTN\",\"UJOWASC\",80,0)\n      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",81,0)\n      ; Name         : BUILD\n\"RTN\",\"UJOWASC\",82,0)\n      ;\n\"RTN\",\"UJOWASC\",83,0)\n      ; Description  : This function used to build appointment details.\n\"RTN\",\"UJOWASC\",84,0)\n      ;\n\"RTN\",\"UJOWASC\",85,0)\n      ; In           : BSDXIEN :BSDX APPOINTMENT #9002018.4 file IEN\n\"RTN\",\"UJOWASC\",86,0)\n      ;\n\"RTN\",\"UJOWASC\",87,0)\n      ; Out          : LIST    : Success (array of appointments details)\n\"RTN\",\"UJOWASC\",88,0)\n      ;\n\"RTN\",\"UJOWASC\",89,0)\n      ; Return       : 0 : no data to display\n\"RTN\",\"UJOWASC\",90,0)\n      ;                1 : has data to display\n\"RTN\",\"UJOWASC\",91,0)\n      ;\n\"RTN\",\"UJOWASC\",92,0)\n      ; Notes        : N/A\n\"RTN\",\"UJOWASC\",93,0)\n      ;\n\"RTN\",\"UJOWASC\",94,0)\n      ; Author(s)    : Toqa Abbas\n\"RTN\",\"UJOWASC\",95,0)\n      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",96,0)\nBUILD(LIST,BSDXIEN) \n\"RTN\",\"UJOWASC\",97,0)\n IF $GET(BSDXIEN)=\"\" QUIT 0\n\"RTN\",\"UJOWASC\",98,0)\n NEW BSDXNOD\n\"RTN\",\"UJOWASC\",99,0)\n SET BSDXNOD=^BSDXAPPT(BSDXIEN,0)\n\"RTN\",\"UJOWASC\",100,0)\n ;build dates vars\n\"RTN\",\"UJOWASC\",101,0)\n NEW FIELD,COUNTER,LOOP\n\"RTN\",\"UJOWASC\",102,0)\n SET COUNTER=1\n\"RTN\",\"UJOWASC\",103,0)\n SET FIELD=\"STARTTIME,ENDTIME,CHECKIN,AUXTIME\"\n\"RTN\",\"UJOWASC\",104,0)\n FOR  SET LOOP=$PIECE(FIELD,\",\",COUNTER)  QUIT:$GET(LOOP)=\"\"  DO\n\"RTN\",\"UJOWASC\",105,0)\n .SET LIST(BSDXIEN,LOOP)=$$DATE($PIECE(BSDXNOD,\"^\",COUNTER))\n\"RTN\",\"UJOWASC\",106,0)\n .SET COUNTER=COUNTER+1\n\"RTN\",\"UJOWASC\",107,0)\n ;patient info\n\"RTN\",\"UJOWASC\",108,0)\n QUIT:'$$PATDATA(.LIST,BSDXIEN,BSDXNOD) 0\n\"RTN\",\"UJOWASC\",109,0)\n ;appt info.\n\"RTN\",\"UJOWASC\",110,0)\n SET LIST(BSDXIEN,\"RESNAME\")=$$GET1^DIQ(9002018.4,BSDXIEN,\".07\")\n\"RTN\",\"UJOWASC\",111,0)\n SET LIST(BSDXIEN,\"RESID\")=$PIECE(BSDXNOD,\"^\",7)\n\"RTN\",\"UJOWASC\",112,0)\n SET LIST(BSDXIEN,\"NOSHOW\")=$PIECE(BSDXNOD,\"^\",10)\n\"RTN\",\"UJOWASC\",113,0)\n SET LIST(BSDXIEN,\"ACCTYPE\")=$PIECE(BSDXNOD,\"^\",6)\n\"RTN\",\"UJOWASC\",114,0)\n SET LIST(BSDXIEN,\"RADIOLOGY\")=$PIECE(BSDXNOD,\"^\",14)\n\"RTN\",\"UJOWASC\",115,0)\n SET LIST(BSDXIEN,\"CHECKOUT\")=$SELECT($$GET1^DIQ(2.98,$PIECE(^BSDXAPPT(BSDXIEN,0),\"^\")_\",\"_LIST(BSDXIEN,\"PATIENT\"),100)=\"CHECKED OUT\":1,1:0)\n\"RTN\",\"UJOWASC\",116,0)\n    ;EHS/ADA;UJOW*1.0*80;SEP 28,2021; Addition[Add radiology and patient mobile number to return value]\n\"RTN\",\"UJOWASC\",117,0)\n    ;START OF CODE CHANGES FOR;UJOW*1.0*80\n\"RTN\",\"UJOWASC\",118,0)\n    ;Radiology appointment data\n\"RTN\",\"UJOWASC\",119,0)\n    IF $DATA(LIST(BSDXIEN,\"RADIOLOGY\")) DO\n\"RTN\",\"UJOWASC\",120,0)\n    . NEW RADDATA\n\"RTN\",\"UJOWASC\",121,0)\n    . DO GTRADATA^UJOWRDT(.RADDATA,BSDXIEN)\n\"RTN\",\"UJOWASC\",122,0)\n    . SET LIST(BSDXIEN,\"RADORD\")=$PIECE(RADDATA,\"^\",1)\n\"RTN\",\"UJOWASC\",123,0)\n    . SET LIST(BSDXIEN,\"RADNAME\")=$PIECE(RADDATA,\"^\",2)\n\"RTN\",\"UJOWASC\",124,0)\n    ;Patient mobile number\n\"RTN\",\"UJOWASC\",125,0)\n    SET LIST(BSDXIEN,\"MOBILE\")=$$GET1^DIQ(2,$PIECE(BSDXNOD,\"^\",5),.131)\n\"RTN\",\"UJOWASC\",126,0)\n    ;END OF CODE CHANGES FOR;UJOW*1.0*80\n\"RTN\",\"UJOWASC\",127,0)\n    NEW APPTYP\n\"RTN\",\"UJOWASC\",128,0)\n    SET APPTYP=$$GET1^DIQ(9002018.4,BSDXIEN_\",\",400000000)\n\"RTN\",\"UJOWASC\",129,0)\n    SET LIST(BSDXIEN,\"APPTYPE\")=$SELECT(APPTYP=\"YES\":1,APPTYP=\"NO\":0,1:\"\")\n\"RTN\",\"UJOWASC\",130,0)\n SET LIST(BSDXIEN,\"ADDON\")=$$GET1^DIQ(9002018.4,BSDXIEN_\",\",400087002,\"I\")\n\"RTN\",\"UJOWASC\",131,0)\n SET LIST(BSDXIEN,\"WALKIN\")=$SELECT($PIECE(BSDXNOD,\"^\",13)=\"y\":1,1:0)\n\"RTN\",\"UJOWASC\",132,0)\n ;note build\n\"RTN\",\"UJOWASC\",133,0)\n NEW NOTE\n\"RTN\",\"UJOWASC\",134,0)\n SET NOTE=$$NOTEB(.LIST,BSDXIEN)\n\"RTN\",\"UJOWASC\",135,0)\n         ;EHS/MOK;UJOP*2.1*19;OCT 5,2023; Addition[Get Refferal & Billing data This change come from UJOM*2.1*187 and UJOM*2.1*226 in moh]\n\"RTN\",\"UJOWASC\",136,0)\n   ;START OF CODE CHANGES FOR;UJOP*2.1*19\n\"RTN\",\"UJOWASC\",137,0)\n         NEW REF,BILL\n\"RTN\",\"UJOWASC\",138,0)\n     SET REF=$$GETREF(.LIST,BSDXIEN)\n\"RTN\",\"UJOWASC\",139,0)\n  SET BILL=$$GETBILL(.LIST,BSDXIEN)\n\"RTN\",\"UJOWASC\",140,0)\n      ;END OF CODE CHANGES FOR;UJOP*2.1*19\n\"RTN\",\"UJOWASC\",141,0)\n QUIT 1\n\"RTN\",\"UJOWASC\",142,0)\n      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",143,0)\n      ; Name         : DATE\n\"RTN\",\"UJOWASC\",144,0)\n      ;\n\"RTN\",\"UJOWASC\",145,0)\n      ; Description  : This function used to convert sent dates to external format\n\"RTN\",\"UJOWASC\",146,0)\n      ;\n\"RTN\",\"UJOWASC\",147,0)\n      ; In           : Y : sent date in internal FM format\n\"RTN\",\"UJOWASC\",148,0)\n      ;\n\"RTN\",\"UJOWASC\",149,0)\n      ; Out          : N/A\n\"RTN\",\"UJOWASC\",150,0)\n      ;\n\"RTN\",\"UJOWASC\",151,0)\n      ; Return       : 0 : no date sent\n\"RTN\",\"UJOWASC\",152,0)\n      ;                Y : date after conversion\n\"RTN\",\"UJOWASC\",153,0)\n      ;\n\"RTN\",\"UJOWASC\",154,0)\n      ; Notes        : N/A\n\"RTN\",\"UJOWASC\",155,0)\n      ;\n\"RTN\",\"UJOWASC\",156,0)\n      ; Author(s)    : Toqa Abbas\n\"RTN\",\"UJOWASC\",157,0)\n      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",158,0)\nDATE(Y) \n\"RTN\",\"UJOWASC\",159,0)\n QUIT:$GET(Y)=\"\" 0\n\"RTN\",\"UJOWASC\",160,0)\n XECUTE ^DD(\"DD\")\n\"RTN\",\"UJOWASC\",161,0)\n SET Y=$TRANSLATE(Y,\"@\",\" \")\n\"RTN\",\"UJOWASC\",162,0)\n QUIT Y\n\"RTN\",\"UJOWASC\",163,0)\n      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",164,0)\n      ; Name         : PATDATA\n\"RTN\",\"UJOWASC\",165,0)\n      ;\n\"RTN\",\"UJOWASC\",166,0)\n      ; Description  : This function used to get patient info. for sent appointment\n\"RTN\",\"UJOWASC\",167,0)\n      ;\n\"RTN\",\"UJOWASC\",168,0)\n      ; In           : BSDXIEN :BSDX APPOINTMENT #9002018.4 file IEN\n\"RTN\",\"UJOWASC\",169,0)\n      ;                BSDXNOD :BSDX APPOINTMENT #9002018.4 file Node #0 details\n\"RTN\",\"UJOWASC\",170,0)\n      ;\n\"RTN\",\"UJOWASC\",171,0)\n      ; Out          : LIST    : Success (array of patient appointment details)\n\"RTN\",\"UJOWASC\",172,0)\n      ;\n\"RTN\",\"UJOWASC\",173,0)\n      ; Return       : 0 : no data to display\n\"RTN\",\"UJOWASC\",174,0)\n      ;                1 : has data to display\n\"RTN\",\"UJOWASC\",175,0)\n      ;\n\"RTN\",\"UJOWASC\",176,0)\n      ; Notes        : N/A\n\"RTN\",\"UJOWASC\",177,0)\n      ;\n\"RTN\",\"UJOWASC\",178,0)\n      ; Author(s)    : Toqa Abbas\n\"RTN\",\"UJOWASC\",179,0)\n      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",180,0)\nPATDATA(LIST,BSDXIEN,BSDXNOD) \n\"RTN\",\"UJOWASC\",181,0)\n IF $GET(BSDXIEN)=\"\"!($GET(BSDXNOD)=\"\") QUIT 0\n\"RTN\",\"UJOWASC\",182,0)\n SET LIST(BSDXIEN,\"PATIENT\")=$PIECE(BSDXNOD,\"^\",5)\n\"RTN\",\"UJOWASC\",183,0)\n QUIT:LIST(BSDXIEN,\"PATIENT\")=\"\"!('$DATA(^DPT(LIST(BSDXIEN,\"PATIENT\"),0))) 0\n\"RTN\",\"UJOWASC\",184,0)\n SET LIST(BSDXIEN,\"PATIENT NAME\")=$PIECE(^DPT(LIST(BSDXIEN,\"PATIENT\"),0),\"^\")\n\"RTN\",\"UJOWASC\",185,0)\n ;DUZ(2) session variable\n\"RTN\",\"UJOWASC\",186,0)\n SET LIST(BSDXIEN,\"HRN\")=$PIECE($GET(^AUPNPAT(LIST(BSDXIEN,\"PATIENT\"),41,DUZ(2),0)),\"^\",2)\n\"RTN\",\"UJOWASC\",187,0)\n SET LIST(BSDXIEN,\"SEX\")=$$GET1^DIQ(2,LIST(BSDXIEN,\"PATIENT\"),.02)\n\"RTN\",\"UJOWASC\",188,0)\n SET LIST(BSDXIEN,\"PID\")=$$GET1^DIQ(2,LIST(BSDXIEN,\"PATIENT\"),.363)\n\"RTN\",\"UJOWASC\",189,0)\n SET LIST(BSDXIEN,\"DOB\")=$$FMTE^XLFDT($$GET1^DIQ(2,LIST(BSDXIEN,\"PATIENT\"),.03,\"I\"))\n\"RTN\",\"UJOWASC\",190,0)\n QUIT 1\n\"RTN\",\"UJOWASC\",191,0)\n       ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",192,0)\n      ; Name         : NOTEB\n\"RTN\",\"UJOWASC\",193,0)\n      ;\n\"RTN\",\"UJOWASC\",194,0)\n      ; Description  : This function used to build notes lines for appointment\n\"RTN\",\"UJOWASC\",195,0)\n      ;\n\"RTN\",\"UJOWASC\",196,0)\n      ; In           : BSDXIEN :BSDX APPOINTMENT #9002018.4 file IEN\n\"RTN\",\"UJOWASC\",197,0)\n      ;\n\"RTN\",\"UJOWASC\",198,0)\n      ; Out          : LIST    : Success (array of note appointments details)\n\"RTN\",\"UJOWASC\",199,0)\n      ;\n\"RTN\",\"UJOWASC\",200,0)\n      ; Return       : 0 : no data to display\n\"RTN\",\"UJOWASC\",201,0)\n      ;                1 : has data to display\n\"RTN\",\"UJOWASC\",202,0)\n      ;\n\"RTN\",\"UJOWASC\",203,0)\n      ; Notes        : N/A\n\"RTN\",\"UJOWASC\",204,0)\n      ;\n\"RTN\",\"UJOWASC\",205,0)\n      ; Author(s)    : Toqa Abbas\n\"RTN\",\"UJOWASC\",206,0)\n      ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",207,0)\nNOTEB(LIST,BSDXIEN) \n\"RTN\",\"UJOWASC\",208,0)\n QUIT:$GET(BSDXIEN)=\"\"!('$DATA(^BSDXAPPT(BSDXIEN,1))) 0\n\"RTN\",\"UJOWASC\",209,0)\n NEW LINE\n\"RTN\",\"UJOWASC\",210,0)\n SET LINE=0\n\"RTN\",\"UJOWASC\",211,0)\n FOR  SET LINE=$ORDER(^BSDXAPPT(BSDXIEN,1,LINE)) QUIT:$GET(LINE)=\"\"  DO\n\"RTN\",\"UJOWASC\",212,0)\n .SET LIST(BSDXIEN,\"NOTE\",LINE)=^BSDXAPPT(BSDXIEN,1,LINE,0)\n\"RTN\",\"UJOWASC\",213,0)\n QUIT 1\n\"RTN\",\"UJOWASC\",214,0)\n     ;EHS/MOK;UJOP*2.1*19;OCT 5,2023; Addition[Get Refferal data]\n\"RTN\",\"UJOWASC\",215,0)\n  ;START OF CODE CHANGES FOR;UJOP*2.1*19\n\"RTN\",\"UJOWASC\",216,0)\n       ;EHS/MOK ;UJOM*2.1*243 ; OCT 22,2023 ;rollback [rollback specific headers and commented code for moh This change come from UJOM*2.1*187 and UJOM*2.1*226 in moh]\n\"RTN\",\"UJOWASC\",217,0)\n         ; START OF CODE CHANGE FOR UJOM*2.1*243\n\"RTN\",\"UJOWASC\",218,0)\n  ; EHS/AKH ;\"UJOM*2.1*226\" ; OCT 27,2022 ;Update[Roll Back For MOH Codes] ;\n\"RTN\",\"UJOWASC\",219,0)\n                ; Scope :MOH Roll Back Codes\n\"RTN\",\"UJOWASC\",220,0)\n                ;EHS/ADA;UJOM*2.1*199;OCT 3,2021; Addition[Return MOH code deleted by UJOW*1.0*80]\n\"RTN\",\"UJOWASC\",221,0)\n                ;EHS/TOA;UJOM*2.1*187;Jan 14,2021; Addition[Get Refferal & Billing data for MOH]  \n\"RTN\",\"UJOWASC\",222,0)\n  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",223,0)\n                 ; Name         : GETREF\n\"RTN\",\"UJOWASC\",224,0)\n                 ;\n\"RTN\",\"UJOWASC\",225,0)\n                 ; Description  : This function used to get referral data\n\"RTN\",\"UJOWASC\",226,0)\n                 ;\n\"RTN\",\"UJOWASC\",227,0)\n                 ; In           : BSDXIEN :BSDX APPOINTMENT #9002018.4 file IEN\n\"RTN\",\"UJOWASC\",228,0)\n                 ;\n\"RTN\",\"UJOWASC\",229,0)\n                 ; Out          : LIST    : Success (array of referral data)\n\"RTN\",\"UJOWASC\",230,0)\n                 ;\n\"RTN\",\"UJOWASC\",231,0)\n                 ; Return       :  1  : Success (will be filtered)\n\"RTN\",\"UJOWASC\",232,0)\n                 ;                 0  : Not filtered\n\"RTN\",\"UJOWASC\",233,0)\n                 ;\n\"RTN\",\"UJOWASC\",234,0)\n                 ; Notes        : N/A\n\"RTN\",\"UJOWASC\",235,0)\n                 ;\n\"RTN\",\"UJOWASC\",236,0)\n                 ; Author(s)    : Mohammad Alkouz\n\"RTN\",\"UJOWASC\",237,0)\n                 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",238,0)\nGETREF(LIST,BSDXIEN)  \n\"RTN\",\"UJOWASC\",239,0)\n                QUIT:$GET(BSDXIEN)=\"\" 0\n\"RTN\",\"UJOWASC\",240,0)\n        ;SET LIST(BSDXIEN,\"REFERRAL\")=$SELECT($$GET1^DIQ(9002018.4,BSDXIEN_\",\",400077000,\"I\")=\"y\":1,1:0)\n\"RTN\",\"UJOWASC\",241,0)\n                SET LIST(BSDXIEN,\"REFERRAL\")=$SELECT($$GET1^DIQ(9002018.4,BSDXIEN_\",\",400000003,\"I\")=\"y\":1,1:0)\n\"RTN\",\"UJOWASC\",242,0)\n                SET LIST(BSDXIEN,\"CLERK\")=$$GET1^DIQ(9002018.4,BSDXIEN_\",\",.08)\n\"RTN\",\"UJOWASC\",243,0)\n                QUIT 1\n\"RTN\",\"UJOWASC\",244,0)\n   ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",245,0)\n                 ; Name         : GETBILL\n\"RTN\",\"UJOWASC\",246,0)\n                 ;\n\"RTN\",\"UJOWASC\",247,0)\n                 ; Description  : This function used to get billing data\n\"RTN\",\"UJOWASC\",248,0)\n                 ;\n\"RTN\",\"UJOWASC\",249,0)\n                 ; In           : BSDXIEN :BSDX APPOINTMENT #9002018.4 file IEN\n\"RTN\",\"UJOWASC\",250,0)\n                 ;\n\"RTN\",\"UJOWASC\",251,0)\n                 ; Out          : LIST    : Success (array of billing data)\n\"RTN\",\"UJOWASC\",252,0)\n                 ;\n\"RTN\",\"UJOWASC\",253,0)\n                 ; Return       :  1  : Success (will be filtered)\n\"RTN\",\"UJOWASC\",254,0)\n                 ;                 0  : Not filtered\n\"RTN\",\"UJOWASC\",255,0)\n                 ;\n\"RTN\",\"UJOWASC\",256,0)\n                 ; Notes        : N/A\n\"RTN\",\"UJOWASC\",257,0)\n                 ;\n\"RTN\",\"UJOWASC\",258,0)\n                 ; Author(s)    : Toqa Abbas\n\"RTN\",\"UJOWASC\",259,0)\n                 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWASC\",260,0)\nGETBILL(LIST,BSDXIEN)  \n\"RTN\",\"UJOWASC\",261,0)\n               QUIT:$GET(BSDXIEN)=\"\" 0\n\"RTN\",\"UJOWASC\",262,0)\n                SET LIST(BSDXIEN,\"BILLING\")=$$PAUSE^UJOAPTPS(BSDXIEN)\n\"RTN\",\"UJOWASC\",263,0)\n                ;END OF CODE CHANGE FOR UJOM*2.1*243\n\"RTN\",\"UJOWASC\",264,0)\n   QUIT 1\n\"RTN\",\"UJOWASC\",265,0)\n    ;END OF CODE CHANGE FOR UJOP*2.1*19\n\"VER\")\n8.0^22.0\n**END**\n**END**\n",
      "registeredAt": "2025-12-25T22:50:47.371Z",
      "status": "committed",
      "id": "53c946bcffb7c01c",
      "linkedChanges": [
        "479e2c3dacdcd741"
      ],
      "updatedAt": "2025-12-25T22:51:15.077Z",
      "committedAt": "2025-12-25T22:51:15.074Z",
      "commitResult": {
        "success": true,
        "patchId": "UJOM*2.1*243",
        "committedAt": "2025-12-25T22:51:15.074Z",
        "commitOutput": "No changes - files already up to date",
        "pushOutput": ""
      }
    },
    {
      "patchId": "UJOW*1.0*59",
      "package": "UJOW*1.0*59",
      "packageCode": "UJOW",
      "version": "1.0",
      "patchNumber": 59,
      "title": "Generic RPCs for Web applications",
      "createdDate": "2019-11-26T18:49:40",
      "author": "Haneen al-Sheyab.",
      "description": [],
      "gitlabIssues": [],
      "routines": [
        "UJOPIMGT",
        "UJOWCSIG",
        "UJOWORWU",
        "UJOWDDR3"
      ],
      "raw": "KIDS Distribution saved on Nov 26, 2019@18:49:40\nGeneric RPCs for Web applications\n**KIDS**:UJOW*1.0*59^\n\n**INSTALL NAME**\nUJOW*1.0*59\n\"BLD\",9163,0)\nUJOW*1.0*59^UJO WEB JORDAN SPECIFICATION^0^3191126^y\n\"BLD\",9163,1,0)\n^^4^4^3190123^^\n\"BLD\",9163,1,1,0)\nThis patch was created on 22/01/2019 by Haneen al-Sheyab.\n\"BLD\",9163,1,2,0)\n \n\"BLD\",9163,1,3,0)\nThis patch contains some generic needed RPCs and routines for Web\n\"BLD\",9163,1,4,0)\napplications.\n\"BLD\",9163,4,0)\n^9.64PA^^\n\"BLD\",9163,6.3)\n10\n\"BLD\",9163,\"KRN\",0)\n^9.67PA^779.2^20\n\"BLD\",9163,\"KRN\",.4,0)\n.4\n\"BLD\",9163,\"KRN\",.401,0)\n.401\n\"BLD\",9163,\"KRN\",.402,0)\n.402\n\"BLD\",9163,\"KRN\",.403,0)\n.403\n\"BLD\",9163,\"KRN\",.5,0)\n.5\n\"BLD\",9163,\"KRN\",.84,0)\n.84\n\"BLD\",9163,\"KRN\",3.6,0)\n3.6\n\"BLD\",9163,\"KRN\",3.8,0)\n3.8\n\"BLD\",9163,\"KRN\",9.2,0)\n9.2\n\"BLD\",9163,\"KRN\",9.8,0)\n9.8\n\"BLD\",9163,\"KRN\",9.8,\"NM\",0)\n^9.68A^8^4\n\"BLD\",9163,\"KRN\",9.8,\"NM\",2,0)\nUJOPIMGT^^0^B3593298\n\"BLD\",9163,\"KRN\",9.8,\"NM\",6,0)\nUJOWCSIG^^0^B5603410\n\"BLD\",9163,\"KRN\",9.8,\"NM\",7,0)\nUJOWORWU^^0^B67502374\n\"BLD\",9163,\"KRN\",9.8,\"NM\",8,0)\nUJOWDDR3^^0^B15137667\n\"BLD\",9163,\"KRN\",9.8,\"NM\",\"B\",\"UJOPIMGT\",2)\n\n\"BLD\",9163,\"KRN\",9.8,\"NM\",\"B\",\"UJOWCSIG\",6)\n\n\"BLD\",9163,\"KRN\",9.8,\"NM\",\"B\",\"UJOWDDR3\",8)\n\n\"BLD\",9163,\"KRN\",9.8,\"NM\",\"B\",\"UJOWORWU\",7)\n\n\"BLD\",9163,\"KRN\",19,0)\n19\n\"BLD\",9163,\"KRN\",19.1,0)\n19.1\n\"BLD\",9163,\"KRN\",101,0)\n101\n\"BLD\",9163,\"KRN\",409.61,0)\n409.61\n\"BLD\",9163,\"KRN\",771,0)\n771\n\"BLD\",9163,\"KRN\",779.2,0)\n779.2\n\"BLD\",9163,\"KRN\",870,0)\n870\n\"BLD\",9163,\"KRN\",8989.51,0)\n8989.51\n\"BLD\",9163,\"KRN\",8989.52,0)\n8989.52\n\"BLD\",9163,\"KRN\",8994,0)\n8994\n\"BLD\",9163,\"KRN\",8994,\"NM\",0)\n^9.68A^6^4\n\"BLD\",9163,\"KRN\",8994,\"NM\",3,0)\nUJOW USERINFO^^0\n\"BLD\",9163,\"KRN\",8994,\"NM\",4,0)\nUJOW ENCRYPT SIG^^0\n\"BLD\",9163,\"KRN\",8994,\"NM\",5,0)\nUJOW GET PATIENT IMG^^0\n\"BLD\",9163,\"KRN\",8994,\"NM\",6,0)\nUJOW DDR FILER^^0\n\"BLD\",9163,\"KRN\",8994,\"NM\",\"B\",\"UJOW DDR FILER\",6)\n\n\"BLD\",9163,\"KRN\",8994,\"NM\",\"B\",\"UJOW ENCRYPT SIG\",4)\n\n\"BLD\",9163,\"KRN\",8994,\"NM\",\"B\",\"UJOW GET PATIENT IMG\",5)\n\n\"BLD\",9163,\"KRN\",8994,\"NM\",\"B\",\"UJOW USERINFO\",3)\n\n\"BLD\",9163,\"KRN\",\"B\",.4,.4)\n\n\"BLD\",9163,\"KRN\",\"B\",.401,.401)\n\n\"BLD\",9163,\"KRN\",\"B\",.402,.402)\n\n\"BLD\",9163,\"KRN\",\"B\",.403,.403)\n\n\"BLD\",9163,\"KRN\",\"B\",.5,.5)\n\n\"BLD\",9163,\"KRN\",\"B\",.84,.84)\n\n\"BLD\",9163,\"KRN\",\"B\",3.6,3.6)\n\n\"BLD\",9163,\"KRN\",\"B\",3.8,3.8)\n\n\"BLD\",9163,\"KRN\",\"B\",9.2,9.2)\n\n\"BLD\",9163,\"KRN\",\"B\",9.8,9.8)\n\n\"BLD\",9163,\"KRN\",\"B\",19,19)\n\n\"BLD\",9163,\"KRN\",\"B\",19.1,19.1)\n\n\"BLD\",9163,\"KRN\",\"B\",101,101)\n\n\"BLD\",9163,\"KRN\",\"B\",409.61,409.61)\n\n\"BLD\",9163,\"KRN\",\"B\",771,771)\n\n\"BLD\",9163,\"KRN\",\"B\",779.2,779.2)\n\n\"BLD\",9163,\"KRN\",\"B\",870,870)\n\n\"BLD\",9163,\"KRN\",\"B\",8989.51,8989.51)\n\n\"BLD\",9163,\"KRN\",\"B\",8989.52,8989.52)\n\n\"BLD\",9163,\"KRN\",\"B\",8994,8994)\n\n\"BLD\",9163,\"QUES\",0)\n^9.62^^\n\"BLD\",9163,\"REQB\",0)\n^9.611^1^1\n\"BLD\",9163,\"REQB\",1,0)\nUJOW*1.0*58^1\n\"BLD\",9163,\"REQB\",\"B\",\"UJOW*1.0*58\",1)\n\n\"KRN\",8994,3264,-1)\n0^3\n\"KRN\",8994,3264,0)\nUJOW USERINFO^USERINFO^UJOWORWU^2\n\"KRN\",8994,3264,1,0)\n^8994.01^11^11^3190123^^^\n\"KRN\",8994,3264,1,1,0)\nThis RPC was created on 22/01/2019 by EHS/Haneen Al-Sheyab and Danya \n\"KRN\",8994,3264,1,2,0)\nGharbieh in UJOW*1.0*59\n\"KRN\",8994,3264,1,3,0)\n \n\"KRN\",8994,3264,1,4,0)\n \n\"KRN\",8994,3264,1,5,0)\n - Main functionality is to returns user information.\n\"KRN\",8994,3264,1,6,0)\n  \n\"KRN\",8994,3264,1,7,0)\n - Input parameters:\n\"KRN\",8994,3264,1,8,0)\n N/A\n\"KRN\",8994,3264,1,9,0)\n  \n\"KRN\",8994,3264,1,10,0)\n - Output parameters: \n\"KRN\",8994,3264,1,11,0)\n LST : Array that holds user details.\n\"KRN\",8994,3265,-1)\n0^4\n\"KRN\",8994,3265,0)\nUJOW ENCRYPT SIG^ESIG^UJOWCSIG^1\n\"KRN\",8994,3265,1,0)\n^8994.01^10^10^3190122^^\n\"KRN\",8994,3265,1,1,0)\nThis rpc was created on 22/01/2019 by EHS\\Toqa Abbas and Haneen \n\"KRN\",8994,3265,1,2,0)\nAl-Sheyab for UJOW*1.0*59\n\"KRN\",8994,3265,1,3,0)\n \n\"KRN\",8994,3265,1,4,0)\nThis rpc used to check sent valid signature or not.\n\"KRN\",8994,3265,1,5,0)\n \n\"KRN\",8994,3265,1,6,0)\nIn    : - SIG: Signature string\n\"KRN\",8994,3265,1,7,0)\n        - DUZ: User DUZ.\n\"KRN\",8994,3265,1,8,0)\n \n\"KRN\",8994,3265,1,9,0)\nOut   : -1^Error message :Fail.\n\"KRN\",8994,3265,1,10,0)\n         Encrypted sig   :Success.\n\"KRN\",8994,3266,-1)\n0^5\n\"KRN\",8994,3266,0)\nUJOW GET PATIENT IMG^TXTIMG^UJOPIMGT^2^^^^0\n\"KRN\",8994,3266,1,0)\n^^16^16^3190122^\n\"KRN\",8994,3266,1,1,0)\nThis RPC was created on 22/01/2019 by EHS/Haneen Al-Sheyab and Mohammad \n\"KRN\",8994,3266,1,2,0)\nHalaika in UJOW*1.0*59\n\"KRN\",8994,3266,1,3,0)\n \n\"KRN\",8994,3266,1,4,0)\n \n\"KRN\",8994,3266,1,5,0)\n-The functionality for retrieving patient image text as array\n\"KRN\",8994,3266,1,6,0)\n \n\"KRN\",8994,3266,1,7,0)\n \n\"KRN\",8994,3266,1,8,0)\n  \n\"KRN\",8994,3266,1,9,0)\n Input:\n\"KRN\",8994,3266,1,10,0)\n - DFN: patient internal entry number\n\"KRN\",8994,3266,1,11,0)\n  \n\"KRN\",8994,3266,1,12,0)\n Output:\n\"KRN\",8994,3266,1,13,0)\n - N/A\n\"KRN\",8994,3266,1,14,0)\n \n\"KRN\",8994,3266,1,15,0)\nReturn:\n\"KRN\",8994,3266,1,16,0)\n - patient image text stored in UJOW PATIENT IMAGE FILE #400087016\n\"KRN\",8994,3266,2,0)\n^8994.02A^1^1\n\"KRN\",8994,3266,2,1,0)\nDFN^1^^1\n\"KRN\",8994,3266,2,\"B\",\"DFN\",1)\n\n\"KRN\",8994,3267,-1)\n0^6\n\"KRN\",8994,3267,0)\nUJOW DDR FILER^FILEC^UJOWDDR3^2\n\"KRN\",8994,3267,1,0)\n^^17^17^3190123^\n\"KRN\",8994,3267,1,1,0)\nThis RPC was created on 22/01/2019 by EHS/Haneen Al-Sheyab in UJOW*1.0*59\n\"KRN\",8994,3267,1,2,0)\n \n\"KRN\",8994,3267,1,3,0)\nThis RPC is copy from \"DDR FILER\" RPC with only one change which is in \n\"KRN\",8994,3267,1,4,0)\nthe called routine, the routine also is a copied routine from the \n\"KRN\",8994,3267,1,5,0)\noriginal with only one change to clean a error variable.\n\"KRN\",8994,3267,1,6,0)\n \n\"KRN\",8994,3267,1,7,0)\nThis remote procedure used for web applications.\n\"KRN\",8994,3267,1,8,0)\n \n\"KRN\",8994,3267,1,9,0)\nInput           :\n\"KRN\",8994,3267,1,10,0)\n                -DDRMODE  : Is processing in edit or add data mode.\n\"KRN\",8994,3267,1,11,0)\n                 DDRROOT  : Needed data for edit or update.\n\"KRN\",8994,3267,1,12,0)\n                 DDRFLAGS : type of data flag.\n\"KRN\",8994,3267,1,13,0)\n                 DDRIENS  : records IENs. \n\"KRN\",8994,3267,1,14,0)\n \n\"KRN\",8994,3267,1,15,0)\nOutput: \n\"KRN\",8994,3267,1,16,0)\n                -DDRDATA :  Results of editing to be placed in FDA array\n\"KRN\",8994,3267,1,17,0)\n                            by broker.\n\"MBREQ\")\n0\n\"ORD\",16,8994)\n8994;16;1;;;;;;;RPCDEL^XPDIA1\n\"ORD\",16,8994,0)\nREMOTE PROCEDURE\n\"PKG\",224,-1)\n1^1\n\"PKG\",224,0)\nUJO WEB JORDAN SPECIFICATION^UJOW^This is the web interface package\n\"PKG\",224,20,0)\n^9.402P^^\n\"PKG\",224,22,0)\n^9.49I^1^1\n\"PKG\",224,22,1,0)\n1.0\n\"PKG\",224,22,1,\"PAH\",1,0)\n59^3191126^8\n\"PKG\",224,22,1,\"PAH\",1,1,0)\n^^4^4^3191126\n\"PKG\",224,22,1,\"PAH\",1,1,1,0)\nThis patch was created on 22/01/2019 by Haneen al-Sheyab.\n\"PKG\",224,22,1,\"PAH\",1,1,2,0)\n \n\"PKG\",224,22,1,\"PAH\",1,1,3,0)\nThis patch contains some generic needed RPCs and routines for Web\n\"PKG\",224,22,1,\"PAH\",1,1,4,0)\napplications.\n\"QUES\",\"XPF1\",0)\nY\n\"QUES\",\"XPF1\",\"??\")\n^D REP^XPDH\n\"QUES\",\"XPF1\",\"A\")\nShall I write over your |FLAG| File\n\"QUES\",\"XPF1\",\"B\")\nYES\n\"QUES\",\"XPF1\",\"M\")\nD XPF1^XPDIQ\n\"QUES\",\"XPF2\",0)\nY\n\"QUES\",\"XPF2\",\"??\")\n^D DTA^XPDH\n\"QUES\",\"XPF2\",\"A\")\nWant my data |FLAG| yours\n\"QUES\",\"XPF2\",\"B\")\nYES\n\"QUES\",\"XPF2\",\"M\")\nD XPF2^XPDIQ\n\"QUES\",\"XPI1\",0)\nYO\n\"QUES\",\"XPI1\",\"??\")\n^D INHIBIT^XPDH\n\"QUES\",\"XPI1\",\"A\")\nWant KIDS to INHIBIT LOGONs during the install\n\"QUES\",\"XPI1\",\"B\")\nNO\n\"QUES\",\"XPI1\",\"M\")\nD XPI1^XPDIQ\n\"QUES\",\"XPM1\",0)\nPO^VA(200,:EM\n\"QUES\",\"XPM1\",\"??\")\n^D MG^XPDH\n\"QUES\",\"XPM1\",\"A\")\nEnter the Coordinator for Mail Group '|FLAG|'\n\"QUES\",\"XPM1\",\"B\")\n\n\"QUES\",\"XPM1\",\"M\")\nD XPM1^XPDIQ\n\"QUES\",\"XPO1\",0)\nY\n\"QUES\",\"XPO1\",\"??\")\n^D MENU^XPDH\n\"QUES\",\"XPO1\",\"A\")\nWant KIDS to Rebuild Menu Trees Upon Completion of Install\n\"QUES\",\"XPO1\",\"B\")\nNO\n\"QUES\",\"XPO1\",\"M\")\nD XPO1^XPDIQ\n\"QUES\",\"XPZ1\",0)\nY\n\"QUES\",\"XPZ1\",\"??\")\n^D OPT^XPDH\n\"QUES\",\"XPZ1\",\"A\")\nWant to DISABLE Scheduled Options, Menu Options, and Protocols\n\"QUES\",\"XPZ1\",\"B\")\nNO\n\"QUES\",\"XPZ1\",\"M\")\nD XPZ1^XPDIQ\n\"QUES\",\"XPZ2\",0)\nY\n\"QUES\",\"XPZ2\",\"??\")\n^D RTN^XPDH\n\"QUES\",\"XPZ2\",\"A\")\nWant to MOVE routines to other CPUs\n\"QUES\",\"XPZ2\",\"B\")\nNO\n\"QUES\",\"XPZ2\",\"M\")\nD XPZ2^XPDIQ\n\"RTN\")\n4\n\"RTN\",\"UJOPIMGT\")\n0^2^B3593298\n\"RTN\",\"UJOPIMGT\",1,0)\nUJOPIMGT  ;EHS/MOH/HAS - Web application store image ; 1/22/19 3:11pm\n\"RTN\",\"UJOPIMGT\",2,0)\n          ;;1.0;UJOW**59**;Jan 22,2019;;Build 10\n\"RTN\",\"UJOPIMGT\",3,0)\n          ;Author: Mohammad Halaika\n\"RTN\",\"UJOPIMGT\",4,0)\n          ;Date  : May 02,2018\n\"RTN\",\"UJOPIMGT\",5,0)\n          ;Description : This routine contains function to return patient image text.\n\"RTN\",\"UJOPIMGT\",6,0)\n       QUIT\n\"RTN\",\"UJOPIMGT\",7,0)\n           ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPIMGT\",8,0)\n            ;Name  : TXTIMG\n\"RTN\",\"UJOPIMGT\",9,0)\n            ;\n\"RTN\",\"UJOPIMGT\",10,0)\n            ;Description : This function used to get patient image text \n\"RTN\",\"UJOPIMGT\",11,0)\n            ;\n\"RTN\",\"UJOPIMGT\",12,0)\n            ;In    :  - PDFN : patient internal entry number \n\"RTN\",\"UJOPIMGT\",13,0)\n            ;\n\"RTN\",\"UJOPIMGT\",14,0)\n            ;Out   :  - RET: -1^Error (Fail)\n\"RTN\",\"UJOPIMGT\",15,0)\n                   ;           RET: string array\n\"RTN\",\"UJOPIMGT\",16,0)\n            ;\n\"RTN\",\"UJOPIMGT\",17,0)\n            ;Return:   N/A\n\"RTN\",\"UJOPIMGT\",18,0)\n            ; \n\"RTN\",\"UJOPIMGT\",19,0)\n            ;Notes    : N/A\n\"RTN\",\"UJOPIMGT\",20,0)\n            ;\n\"RTN\",\"UJOPIMGT\",21,0)\n            ;Author(s): Mohammad Halaika\n\"RTN\",\"UJOPIMGT\",22,0)\n            ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOPIMGT\",23,0)\nTXTIMG(RET,PDFN) \n\"RTN\",\"UJOPIMGT\",24,0)\n QUIT:$GET(PDFN)=\"\" \"-1^Empty parameter\"\n\"RTN\",\"UJOPIMGT\",25,0)\n NEW RECIEN,ERR\n\"RTN\",\"UJOPIMGT\",26,0)\n SET RECIEN=$$FIND1^DIC(400087016,\"\",\"Q\",PDFN,\"B\",\"\",\"ERR\")\n\"RTN\",\"UJOPIMGT\",27,0)\n IF $GET(RECIEN)=\"\" DO  QUIT\n\"RTN\",\"UJOPIMGT\",28,0)\n .SET RET(1)=\"\"\n\"RTN\",\"UJOPIMGT\",29,0)\n NEW ARR,ERR\n\"RTN\",\"UJOPIMGT\",30,0)\n DO GETS^DIQ(400087016,RECIEN,\".02\",\"Z\",\"ARR\",\"ERR\")\n\"RTN\",\"UJOPIMGT\",31,0)\n IF $DATA(ERR)>1 DO  QUIT\n\"RTN\",\"UJOPIMGT\",32,0)\n .SET RET(1)=\"-1^TXTIMG~UJOPIMGT,NO PATIENT IMAGE\"_ERR(\"DIERR\",1,\"TEXT\",1)\n\"RTN\",\"UJOPIMGT\",33,0)\n MERGE RET=ARR(400087016,RECIEN_\",\",\".02\")\n\"RTN\",\"UJOPIMGT\",34,0)\n QUIT\n\"RTN\",\"UJOWCSIG\")\n0^6^B5603410\n\"RTN\",\"UJOWCSIG\",1,0)\nUJOWCSIG          ;;EHS/TOA/HAS - CPRS web application,accept checks rpc's ; 1/22/19 3:40pm\n\"RTN\",\"UJOWCSIG\",2,0)\n                  ;;1.0;UJOW;**59**;Jan 22,2019;Build 10\n\"RTN\",\"UJOWCSIG\",3,0)\n                  ;Author: Haneen Al-Sheyab,Toqa Abbas\n\"RTN\",\"UJOWCSIG\",4,0)\n                  ;Date  : Feb 27,2018\n\"RTN\",\"UJOWCSIG\",5,0)\n                  ;Description : This routine contains function(s) to accept checks rpc's.\n\"RTN\",\"UJOWCSIG\",6,0)\n                  QUIT\n\"RTN\",\"UJOWCSIG\",7,0)\n                 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWCSIG\",8,0)\n                 ;Name  : ESIG\n\"RTN\",\"UJOWCSIG\",9,0)\n                 ;\n\"RTN\",\"UJOWCSIG\",10,0)\n                 ;Description : This function used to encrypt sig. and check if it's valid or not.\n\"RTN\",\"UJOWCSIG\",11,0)\n                 ;\n\"RTN\",\"UJOWCSIG\",12,0)\n                 ;In    : - SIG: Signature string\n\"RTN\",\"UJOWCSIG\",13,0)\n                 ;        - DUZ: User DUZ.\n\"RTN\",\"UJOWCSIG\",14,0)\n                 ;\n\"RTN\",\"UJOWCSIG\",15,0)\n                 ;Out   : - RESULT: -1^Error message :Fail.\n\"RTN\",\"UJOWCSIG\",16,0)\n                 ;                  Encrypted sig   :Success.\n\"RTN\",\"UJOWCSIG\",17,0)\n                 ;\n\"RTN\",\"UJOWCSIG\",18,0)\n                 ;Return: N/A\n\"RTN\",\"UJOWCSIG\",19,0)\n                 ; \n\"RTN\",\"UJOWCSIG\",20,0)\n                 ;Notes    : N/A\n\"RTN\",\"UJOWCSIG\",21,0)\n                 ;\n\"RTN\",\"UJOWCSIG\",22,0)\n                 ;Author(s): Haneen Al-Sheyab,Toqa Abbas\n\"RTN\",\"UJOWCSIG\",23,0)\n                 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWCSIG\",24,0)\nESIG(RESULT,SIG,DUZ) \n\"RTN\",\"UJOWCSIG\",25,0)\n                 IF $GET(SIG)=\"\"!($GET(DUZ)=\"\") DO  QUIT\n\"RTN\",\"UJOWCSIG\",26,0)\n                 .SET RESULT=\"-1^Signature or DUZ is empty\"\n\"RTN\",\"UJOWCSIG\",27,0)\n                 .DO ERRPRCS^UJOMSGPH(\"UJOW ERROR\",$GET(DUZ),\"\",$GET(DUZ(2)),\",U ESIG~UJOWCSIG:Empty parameter list,\")\n\"RTN\",\"UJOWCSIG\",28,0)\n                 ;encrypt sig.\n\"RTN\",\"UJOWCSIG\",29,0)\n                 NEW EN\n\"RTN\",\"UJOWCSIG\",30,0)\n                 SET EN=$$ENCRYP^XUSRB1(SIG)\n\"RTN\",\"UJOWCSIG\",31,0)\n                 ;check if valid sig.\n\"RTN\",\"UJOWCSIG\",32,0)\n                 NEW ESOK\n\"RTN\",\"UJOWCSIG\",33,0)\n                 DO VALIDSIG^ORWU(.ESOK,EN)\n\"RTN\",\"UJOWCSIG\",34,0)\n                 IF ($GET(ESOK)'=1) DO  QUIT\n\"RTN\",\"UJOWCSIG\",35,0)\n                 .SET RESULT=\"-1^Not valid electronic signature,Try again\"\n\"RTN\",\"UJOWCSIG\",36,0)\n                 SET RESULT=EN\n\"RTN\",\"UJOWCSIG\",37,0)\n                 QUIT\n\"RTN\",\"UJOWDDR3\")\n0^8^B15137667\n\"RTN\",\"UJOWDDR3\",1,0)\nUJOWDDR3  ;EHS/HAS - DDR3 :Clear DDRERR variable ; 1/23/19 10:30pm\n\"RTN\",\"UJOWDDR3\",2,0)\n          ;;1.0;UJOW;**59**;Jan 22,2019;Build 10\n\"RTN\",\"UJOWDDR3\",3,0)\n          ;; Author        : Haneen Al-Sheyab\n\"RTN\",\"UJOWDDR3\",4,0)\n          ;; Date          : Jan 22,2019\n\"RTN\",\"UJOWDDR3\",5,0)\n          ;; Description   : This routine was copied from \"DDR3\" to clear [DDRERR] error variable.\n\"RTN\",\"UJOWDDR3\",6,0)\n          ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWDDR3\",7,0)\n          ;DDR3    ;ALB/MJK,SF/DCM-FileMan Delphi Components' RPCs ; 1/23/19 4:32pm\n\"RTN\",\"UJOWDDR3\",8,0)\n          ;;22.0;VA FileMan;;Mar 30, 1999;Build 4\n\"RTN\",\"UJOWDDR3\",9,0)\n ;Per VHA Directive 10-93-142, this routine should not be modified.\n\"RTN\",\"UJOWDDR3\",10,0)\n ;\n\"RTN\",\"UJOWDDR3\",11,0)\n Q\n\"RTN\",\"UJOWDDR3\",12,0)\n ;\n\"RTN\",\"UJOWDDR3\",13,0)\nFILEC(DDRDATA,DDRMODE,DDRROOT,DDRFLAGS,DDRIENS) ;  DDR FILER rpc callback\n\"RTN\",\"UJOWDDR3\",14,0)\n D FDASET(.DDRROOT,.DDRFDA)\n\"RTN\",\"UJOWDDR3\",15,0)\n ; -- set up placeholder DINUM's if any\n\"RTN\",\"UJOWDDR3\",16,0)\n ; -- NOTE:  Can't use until multiple arrays can be passed by broker\n\"RTN\",\"UJOWDDR3\",17,0)\n I $D(DDRROOT(\"IENs\")) M DDRIENS=DDRROOT(\"IENs\")\n\"RTN\",\"UJOWDDR3\",18,0)\n ; EHS/AYG ; UJO*2.0*32 ; JAN 31,2013 ; Update [Adding Current Division to the Patient]\n\"RTN\",\"UJOWDDR3\",19,0)\n ; Making this routine more dynamic by using the passed flages in the ADDING MODE rather\n\"RTN\",\"UJOWDDR3\",20,0)\n ;  than the empty string \"\" in the UPDATER.\n\"RTN\",\"UJOWDDR3\",21,0)\n ;- initializing the DDRRTN array, because it was not killed and when calling this block\n\"RTN\",\"UJOWDDR3\",22,0)\n    ;   again it will use it in the IEN for the entry.\n\"RTN\",\"UJOWDDR3\",23,0)\n ; START OF CODE CHANGES FOR ;UJO*2.0*32\n\"RTN\",\"UJOWDDR3\",24,0)\n ; OLD CODE\n\"RTN\",\"UJOWDDR3\",25,0)\n ;S I=\"\" F  S I=$O(DDRIENS(I)) Q:I=\"\"  S DDRRTN(+I)=+DDRIENS(I)\n\"RTN\",\"UJOWDDR3\",26,0)\n ;IF DDRMODE=\"ADD\" D\n\"RTN\",\"UJOWDDR3\",27,0)\n ;.  D UPDATE^DIE(\"\",\"DDRFDA\",\"DDRRTN\",\"DDRERR\")\n\"RTN\",\"UJOWDDR3\",28,0)\n ;ELSE  D\n\"RTN\",\"UJOWDDR3\",29,0)\n ;. S DDRFLAGS=$S($D(DDRFLAGS):DDRFLAGS,1:\"\")\n\"RTN\",\"UJOWDDR3\",30,0)\n ;. D FILE^DIE(DDRFLAGS,\"DDRFDA\",\"DDRERR\")\n\"RTN\",\"UJOWDDR3\",31,0)\n ;\n\"RTN\",\"UJOWDDR3\",32,0)\n ; NEW CODE\n\"RTN\",\"UJOWDDR3\",33,0)\n SET DDRFLAGS=$SELECT($DATA(DDRFLAGS):DDRFLAGS,1:\"\")\n\"RTN\",\"UJOWDDR3\",34,0)\n ;OLD CODE\n\"RTN\",\"UJOWDDR3\",35,0)\n        ;NEW DDRRTN\n\"RTN\",\"UJOWDDR3\",36,0)\n        ;NEW CODE\n\"RTN\",\"UJOWDDR3\",37,0)\n        NEW DDRRTN,DDRERR\n\"RTN\",\"UJOWDDR3\",38,0)\n SET I=\"\" FOR  SET I=$ORDER(DDRIENS(I)) QUIT:I=\"\"  SET DDRRTN(+I)=+DDRIENS(I)\n\"RTN\",\"UJOWDDR3\",39,0)\n IF DDRMODE=\"ADD\" DO\n\"RTN\",\"UJOWDDR3\",40,0)\n . DO UPDATE^DIE(DDRFLAGS,\"DDRFDA\",\"DDRRTN\",\"DDRERR\")\n\"RTN\",\"UJOWDDR3\",41,0)\n ELSE  DO\n\"RTN\",\"UJOWDDR3\",42,0)\n . DO FILE^DIE(DDRFLAGS,\"DDRFDA\",\"DDRERR\")\n\"RTN\",\"UJOWDDR3\",43,0)\n ;END OF CODE CHANGES FOR ;UJO*2.0*32\n\"RTN\",\"UJOWDDR3\",44,0)\n ;\n\"RTN\",\"UJOWDDR3\",45,0)\n S N=0\n\"RTN\",\"UJOWDDR3\",46,0)\n D SET(\"[Data]\")\n\"RTN\",\"UJOWDDR3\",47,0)\n ; -- send back info on entry #'s for placeholders\n\"RTN\",\"UJOWDDR3\",48,0)\n S I=0 F  S I=$O(DDRRTN(I)) Q:'I  D SET(\"+\"_I_\",\"_U_DDRRTN(I))\n\"RTN\",\"UJOWDDR3\",49,0)\n IF $D(DDRERR) D ERROR\n\"RTN\",\"UJOWDDR3\",50,0)\n Q\n\"RTN\",\"UJOWDDR3\",51,0)\n ;\n\"RTN\",\"UJOWDDR3\",52,0)\nFDASET(DDRROOT,DDRFDA) ;\n\"RTN\",\"UJOWDDR3\",53,0)\n N DDRFILE,DDRIEN,DDRFIELD,DDRVAL,DDRERR,I\n\"RTN\",\"UJOWDDR3\",54,0)\n S I=0\n\"RTN\",\"UJOWDDR3\",55,0)\n F  S I=$O(DDRROOT(I)) Q:'I  S X=DDRROOT(I) D\n\"RTN\",\"UJOWDDR3\",56,0)\n . S DDRFILE=$P(X,U)\n\"RTN\",\"UJOWDDR3\",57,0)\n . S DDRFIELD=$P(X,U,2)\n\"RTN\",\"UJOWDDR3\",58,0)\n . S DDRIEN=$P(X,U,3)\n\"RTN\",\"UJOWDDR3\",59,0)\n . S DDRVAL=$P(X,U,4,99)\n\"RTN\",\"UJOWDDR3\",60,0)\n . D FDA^DILF(DDRFILE,DDRIEN_$S($E(DDRIEN,$L(DDRIEN))'=\",\":\",\",1:\"\"),DDRFIELD,\"\",DDRVAL,\"DDRFDA\",\"DDRERR\")\n\"RTN\",\"UJOWDDR3\",61,0)\n Q\n\"RTN\",\"UJOWDDR3\",62,0)\n ;\n\"RTN\",\"UJOWDDR3\",63,0)\nVALC(DDRDATA,DDR) ; DDR VALIDATOR rpc callback\n\"RTN\",\"UJOWDDR3\",64,0)\n N DDRFILE,DDRIENS,DDRFIELD,DDRVAL,DDRRSLT,DDRERR,DDRFLAGS,N\n\"RTN\",\"UJOWDDR3\",65,0)\n S DDRFLAGS=\"EH\"\n\"RTN\",\"UJOWDDR3\",66,0)\n S DDRFILE=$G(DDR(\"FILE\"))\n\"RTN\",\"UJOWDDR3\",67,0)\n S DDRIENS=$G(DDR(\"IENS\"))\n\"RTN\",\"UJOWDDR3\",68,0)\n S DDRFIELD=$G(DDR(\"FIELD\"))\n\"RTN\",\"UJOWDDR3\",69,0)\n S DDRVAL=$G(DDR(\"VALUE\"))\n\"RTN\",\"UJOWDDR3\",70,0)\n D VAL^DIE(DDRFILE,DDRIENS,DDRFIELD,DDRFLAGS,DDRVAL,.DDRRSLT,\"\",\"DDRERR\")\n\"RTN\",\"UJOWDDR3\",71,0)\n S N=0\n\"RTN\",\"UJOWDDR3\",72,0)\n D SET(\"[FILLER]\")\n\"RTN\",\"UJOWDDR3\",73,0)\n D SET(\"[Data]\")\n\"RTN\",\"UJOWDDR3\",74,0)\n D SET($G(DDRRSLT,U))\n\"RTN\",\"UJOWDDR3\",75,0)\n D SET($G(DDRRSLT(0)))\n\"RTN\",\"UJOWDDR3\",76,0)\n IF $D(DDRERR) D ERROR,HELP\n\"RTN\",\"UJOWDDR3\",77,0)\n Q\n\"RTN\",\"UJOWDDR3\",78,0)\nSET(X) ;\n\"RTN\",\"UJOWDDR3\",79,0)\n S N=N+1\n\"RTN\",\"UJOWDDR3\",80,0)\n S DDRDATA(N)=X\n\"RTN\",\"UJOWDDR3\",81,0)\n Q\n\"RTN\",\"UJOWDDR3\",82,0)\nHELP ;\n\"RTN\",\"UJOWDDR3\",83,0)\n Q:'$D(DDRERR(\"DIHELP\"))\n\"RTN\",\"UJOWDDR3\",84,0)\n D SET(\"[BEGIN_diHELP]\")\n\"RTN\",\"UJOWDDR3\",85,0)\n S HD=DDRFILE_U_DDRFIELD_U_\"?\"_U_DDRERR(\"DIHELP\") D SET(HD)\n\"RTN\",\"UJOWDDR3\",86,0)\n N A S A=0 F  S A=$O(DDRERR(\"DIHELP\",A)) Q:'A  D SET(DDRERR(\"DIHELP\",A))\n\"RTN\",\"UJOWDDR3\",87,0)\n D SET(\"[END_diHELP]\")\n\"RTN\",\"UJOWDDR3\",88,0)\n Q\n\"RTN\",\"UJOWDDR3\",89,0)\nERROR ;\n\"RTN\",\"UJOWDDR3\",90,0)\n D SET(\"[BEGIN_diERRORS]\")\n\"RTN\",\"UJOWDDR3\",91,0)\n N A S A=0 F  S A=$O(DDRERR(\"DIERR\",A)) Q:'A  D\n\"RTN\",\"UJOWDDR3\",92,0)\n . N HD,PARAM,B,C,TEXT,TXTCNT,D,FILE,FIELD,IENS\n\"RTN\",\"UJOWDDR3\",93,0)\n . S HD=DDRERR(\"DIERR\",A)\n\"RTN\",\"UJOWDDR3\",94,0)\n . I $D(DDRERR(\"DIERR\",A,\"PARAM\",0)) D\n\"RTN\",\"UJOWDDR3\",95,0)\n . . S (B,D)=0 F C=1:1 S B=$O(DDRERR(\"DIERR\",A,\"PARAM\",B)) Q:B=\"\"  D\n\"RTN\",\"UJOWDDR3\",96,0)\n . . . I B=\"FILE\" S FILE=DDRERR(\"DIERR\",A,\"PARAM\",\"FILE\")\n\"RTN\",\"UJOWDDR3\",97,0)\n . . . I B=\"FIELD\" S FIELD=DDRERR(\"DIERR\",A,\"PARAM\",\"FIELD\")\n\"RTN\",\"UJOWDDR3\",98,0)\n . . . I B=\"IENS\" S IENS=DDRERR(\"DIERR\",A,\"PARAM\",\"IENS\")\n\"RTN\",\"UJOWDDR3\",99,0)\n . . . S D=D+1,PARAM(D)=B_U_DDRERR(\"DIERR\",A,\"PARAM\",B)\n\"RTN\",\"UJOWDDR3\",100,0)\n . S C=0 F  S C=$O(DDRERR(\"DIERR\",A,\"TEXT\",C)) Q:'C  S TEXT(C)=DDRERR(\"DIERR\",A,\"TEXT\",C),TXTCNT=C\n\"RTN\",\"UJOWDDR3\",101,0)\n . S HD=HD_U_TXTCNT_U_$G(FILE)_U_$G(IENS)_U_$G(FIELD)_U_$G(D) D SET(HD)\n\"RTN\",\"UJOWDDR3\",102,0)\n . S B=0 F  S B=$O(PARAM(B)) Q:'B  S %=PARAM(B) D SET(%)\n\"RTN\",\"UJOWDDR3\",103,0)\n . S B=0 F  S B=$O(TEXT(B)) Q:'B  S %=TEXT(B) D SET(%)\n\"RTN\",\"UJOWDDR3\",104,0)\n . Q\n\"RTN\",\"UJOWDDR3\",105,0)\n D SET(\"[END_diERRORS]\")\n\"RTN\",\"UJOWDDR3\",106,0)\n Q\n\"RTN\",\"UJOWDDR3\",107,0)\n ;\n\"RTN\",\"UJOWORWU\")\n0^7^B67502374\n\"RTN\",\"UJOWORWU\",1,0)\nUJOWORWU  ;EHS/HAS - ORWU : Get user information ; 1/23/19 10:25pm\n\"RTN\",\"UJOWORWU\",2,0)\n       ;;1.0;UJOW;**59**;Jan 22,2019;Build 10\n\"RTN\",\"UJOWORWU\",3,0)\n       ;; Author        : Haneen Al-Sheyab\n\"RTN\",\"UJOWORWU\",4,0)\n       ;; Date          : Jan 22,2019\n\"RTN\",\"UJOWORWU\",5,0)\n       ;; Description   : This routine was copied from \"ORWU\" with some updates in order to get user class.\n\"RTN\",\"UJOWORWU\",6,0)\n       ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOWORWU\",7,0)\n              ;ORWU   ; SLC/KCM -  General Utilites for Windows Calls;\n\"RTN\",\"UJOWORWU\",8,0)\n              ;;3.0;ORDER ENTRY/RESULTS REPORTING;**10,85,132,148,149,187,195,215,243**;Dec 17, 1997;Build 8\n\"RTN\",\"UJOWORWU\",9,0)\n              ;\n\"RTN\",\"UJOWORWU\",10,0)\nDT(Y,X,%DT) ; Internal Fileman Date/Time\n\"RTN\",\"UJOWORWU\",11,0)\n ; change the '00:00' that could be passed so Fileman doesn't reject\n\"RTN\",\"UJOWORWU\",12,0)\n I $L($P(X,\"@\",2)),(\"00000000\"[$TR($P(X,\"@\",2),\":\",\"\")) S $P(X,\"@\",2)=\"00:00:01\"\n\"RTN\",\"UJOWORWU\",13,0)\n S %DT=$G(%DT,\"TS\") D ^%DT K %DT\n\"RTN\",\"UJOWORWU\",14,0)\n Q\n\"RTN\",\"UJOWORWU\",15,0)\nVALDT(Y,X,%DT) ; Validate date/time\n\"RTN\",\"UJOWORWU\",16,0)\n S:'$D(%DT) %DT=\"TX\" D ^%DT\n\"RTN\",\"UJOWORWU\",17,0)\n Q\n\"RTN\",\"UJOWORWU\",18,0)\nUSERINFO(REC) ; Relevant info for current user\n\"RTN\",\"UJOWORWU\",19,0)\n ; return DUZ^NAME^USRCLS^CANSIGN^ISPROVIDER^ORDERROLE^NOORDER^DTIME^\n\"RTN\",\"UJOWORWU\",20,0)\n ;        COUNTDOWN^ENABLEVERIFY^NOTIFYAPPS^MSGHANG^DOMAIN^SERVICE^\n\"RTN\",\"UJOWORWU\",21,0)\n ;        AUTOSAVE^INITTAB^LASTTAB^WEBACCESS^ALLOWHOLD^ISRPL^RPLLIST^\n\"RTN\",\"UJOWORWU\",22,0)\n ;        CORTABS^RPTTAB^STANUM^GECSTATUS^PRODACCT\n\"RTN\",\"UJOWORWU\",23,0)\n N X,ORRPL,ORRPL1,ORRPL2,ORTAB,CORTABS,RPTTAB,ORDT,OREFF,OREXP,ORDATEOK\n\"RTN\",\"UJOWORWU\",24,0)\n S REC=DUZ_U_$P(^VA(200,DUZ,0),U)\n\"RTN\",\"UJOWORWU\",25,0)\n S $P(REC,U,3)=$S($D(^XUSEC(\"ORES\",DUZ)):3,$D(^XUSEC(\"ORELSE\",DUZ)):2,$D(^XUSEC(\"OREMAS\",DUZ)):1,1:0)\n\"RTN\",\"UJOWORWU\",26,0)\n S $P(REC,U,4)=$D(^XUSEC(\"ORES\",DUZ))&$D(^XUSEC(\"PROVIDER\",DUZ))\n\"RTN\",\"UJOWORWU\",27,0)\n S $P(REC,U,5)=$D(^XUSEC(\"PROVIDER\",DUZ))\n\"RTN\",\"UJOWORWU\",28,0)\n S $P(REC,U,6)=$$ORDROLE\n\"RTN\",\"UJOWORWU\",29,0)\n S $P(REC,U,7)=$$GET^XPAR(\"USR^SYS^PKG\",\"ORWOR DISABLE ORDERING\",1,\"I\")\n\"RTN\",\"UJOWORWU\",30,0)\n S $P(REC,U,8)=$$GET^XPAR(\"USR^SYS\",\"ORWOR TIMEOUT CHART\",1,\"I\")\n\"RTN\",\"UJOWORWU\",31,0)\n I '$P(REC,U,8),$G(DTIME) S $P(REC,U,8)=DTIME\n\"RTN\",\"UJOWORWU\",32,0)\n S $P(REC,U,9)=$$GET^XPAR(\"USR^SYS^PKG\",\"ORWOR TIMEOUT COUNTDOWN\",1,\"I\")\n\"RTN\",\"UJOWORWU\",33,0)\n S X=$$GET^XPAR(\"USR^SYS^PKG\",\"ORWOR ENABLE VERIFY\",1,\"I\")\n\"RTN\",\"UJOWORWU\",34,0)\n S $P(REC,U,10)=$S(X=1:1,X=2:0,1:'$P(REC,U,7))\n\"RTN\",\"UJOWORWU\",35,0)\n S $P(REC,U,11)=$$GET^XPAR(\"USR^SYS^PKG\",\"ORWOR BROADCAST MESSAGES\",1,\"I\")\n\"RTN\",\"UJOWORWU\",36,0)\n S $P(REC,U,12)=$$GET^XPAR(\"USR^SYS^PKG\",\"ORWOR AUTO CLOSE PT MSG\",1,\"I\")\n\"RTN\",\"UJOWORWU\",37,0)\n S $P(REC,U,13)=$$KSP^XUPARAM(\"WHERE\")  ; domain\n\"RTN\",\"UJOWORWU\",38,0)\n S $P(REC,U,14)=+$G(^VA(200,DUZ,5))     ; service/section\n\"RTN\",\"UJOWORWU\",39,0)\n S $P(REC,U,15)=$$GET^XPAR(\"USR^SYS^PKG\",\"ORWOR AUTOSAVE NOTE\",1,\"I\")\n\"RTN\",\"UJOWORWU\",40,0)\n S $P(REC,U,16)=$$GET^XPAR(\"USR^DIV^SYS^PKG\",\"ORCH INITIAL TAB\",1,\"I\")\n\"RTN\",\"UJOWORWU\",41,0)\n S $P(REC,U,17)=$$GET^XPAR(\"USR^DIV^SYS^PKG\",\"ORCH USE LAST TAB\",1,\"I\")\n\"RTN\",\"UJOWORWU\",42,0)\n S $P(REC,U,18)=$$GET^XPAR(\"USR^DIV^SYS^PKG\",\"ORWOR DISABLE WEB ACCESS\",1,\"I\")\n\"RTN\",\"UJOWORWU\",43,0)\n S $P(REC,U,19)=$$GET^XPAR(\"SYS^PKG\",\"ORWOR DISABLE HOLD ORDERS\",1,\"I\")\n\"RTN\",\"UJOWORWU\",44,0)\n ; 2 pieces added by PKS on 11/5/2001 for \"Reports Only:\"\n\"RTN\",\"UJOWORWU\",45,0)\n ; IA# 10060 allows read access to ^VA(200 file.\n\"RTN\",\"UJOWORWU\",46,0)\n S ORRPL=$G(^VA(200,DUZ,101))           ; RPL node.\n\"RTN\",\"UJOWORWU\",47,0)\n S ORRPL1=$P(ORRPL,U)\n\"RTN\",\"UJOWORWU\",48,0)\n S $P(REC,U,20)=ORRPL1                  ; ISRPL piece.\n\"RTN\",\"UJOWORWU\",49,0)\n S ORRPL2=$P(ORRPL,U,2)\n\"RTN\",\"UJOWORWU\",50,0)\n S $P(REC,U,21)=ORRPL2                  ; RPLLIST piece.\n\"RTN\",\"UJOWORWU\",51,0)\n ;\n\"RTN\",\"UJOWORWU\",52,0)\n ; Additional pieces for CPRS tabs access:\n\"RTN\",\"UJOWORWU\",53,0)\n ; IA# 10060 allows read access to ^VA(200.01013 multiple.\n\"RTN\",\"UJOWORWU\",54,0)\n S ORDT=DT                              ; Today.\n\"RTN\",\"UJOWORWU\",55,0)\n S (CORTABS,RPTTAB)=0\n\"RTN\",\"UJOWORWU\",56,0)\n S ORRPL=0\n\"RTN\",\"UJOWORWU\",57,0)\n F  S ORRPL=$O(^VA(200,DUZ,\"ORD\",ORRPL)) Q:ORRPL<1  D\n\"RTN\",\"UJOWORWU\",58,0)\n .S ORTAB=$G(^VA(200,DUZ,\"ORD\",ORRPL,0))\n\"RTN\",\"UJOWORWU\",59,0)\n .I ORTAB=\"\" Q\n\"RTN\",\"UJOWORWU\",60,0)\n .S OREFF=$P(ORTAB,U,2)\n\"RTN\",\"UJOWORWU\",61,0)\n .S OREXP=$P(ORTAB,U,3)\n\"RTN\",\"UJOWORWU\",62,0)\n .S ORTAB=$P(ORTAB,U)\n\"RTN\",\"UJOWORWU\",63,0)\n .I ORTAB=\"\" Q\n\"RTN\",\"UJOWORWU\",64,0)\n .S ORTAB=$G(^ORD(101.13,ORTAB,0))\n\"RTN\",\"UJOWORWU\",65,0)\n .I ORTAB=\"\" Q\n\"RTN\",\"UJOWORWU\",66,0)\n .S ORTAB=$P(ORTAB,U)\n\"RTN\",\"UJOWORWU\",67,0)\n .I ORTAB=\"\" Q\n\"RTN\",\"UJOWORWU\",68,0)\n .S ORTAB=$$UP^XLFSTR(ORTAB)\n\"RTN\",\"UJOWORWU\",69,0)\n .S ORDATEOK=1                             ; Default.\n\"RTN\",\"UJOWORWU\",70,0)\n .I ((OREFF=\"\")!(OREFF>ORDT)) S ORDATEOK=0 ; Eff. date NG.\n\"RTN\",\"UJOWORWU\",71,0)\n .I ORDATEOK  D\n\"RTN\",\"UJOWORWU\",72,0)\n ..I OREXP=\"\" Q                            ; No exp. date.\n\"RTN\",\"UJOWORWU\",73,0)\n ..I (OREXP<ORDT) S ORDATEOK=0             ; Exp. date NG.\n\"RTN\",\"UJOWORWU\",74,0)\n ..I (OREXP=ORDT) S ORDATEOK=0             ; Exp. date NG.\n\"RTN\",\"UJOWORWU\",75,0)\n .;\n\"RTN\",\"UJOWORWU\",76,0)\n .; Set TRUE if OK:\n\"RTN\",\"UJOWORWU\",77,0)\n .I ((ORTAB=\"COR\")&(ORDATEOK)) S CORTABS=1\n\"RTN\",\"UJOWORWU\",78,0)\n .I ((ORTAB=\"RPT\")&(ORDATEOK)) S RPTTAB=1\n\"RTN\",\"UJOWORWU\",79,0)\n ;\n\"RTN\",\"UJOWORWU\",80,0)\n ; When done, set all valid tabs for access:\n\"RTN\",\"UJOWORWU\",81,0)\n S $P(REC,U,22)=CORTABS                 ; \"Core\" tabs.\n\"RTN\",\"UJOWORWU\",82,0)\n S $P(REC,U,23)=RPTTAB                  ; \"Reports\" tab.\n\"RTN\",\"UJOWORWU\",83,0)\n ;\n\"RTN\",\"UJOWORWU\",84,0)\n S $P(REC,U,24)=$P($$SITE^VASITE,U,3)\n\"RTN\",\"UJOWORWU\",85,0)\n S $P(REC,U,25)=$$GET^XPAR(\"USR^TEA\",\"PXRM GEC STATUS CHECK\",1,\"I\")\n\"RTN\",\"UJOWORWU\",86,0)\n S $P(REC,U,26)=$$PROD^XUPROD\n\"RTN\",\"UJOWORWU\",87,0)\n ; NEW CODE\n\"RTN\",\"UJOWORWU\",88,0)\n ; get person class\n\"RTN\",\"UJOWORWU\",89,0)\n NEW UJOIARR,UJOIRID\n\"RTN\",\"UJOWORWU\",90,0)\n DO GETS^DIQ(200,DUZ,\"8932.1*\",\"\",\"UJOIARR\")\n\"RTN\",\"UJOWORWU\",91,0)\n SET UJOIRID=$ORDER(UJOIARR(\"200.05\",\"\"),-1)\n\"RTN\",\"UJOWORWU\",92,0)\n SET $PIECE(REC,U,27)=UJOIARR(\"200.05\",UJOIRID,.01)\n\"RTN\",\"UJOWORWU\",93,0)\n ; END NEW CODE\n\"RTN\",\"UJOWORWU\",94,0)\n        Q\n\"RTN\",\"UJOWORWU\",95,0)\n ;\n\"RTN\",\"UJOWORWU\",96,0)\nHASKEY(VAL,KEY) ; returns TRUE if the user possesses the security key\n\"RTN\",\"UJOWORWU\",97,0)\n S VAL=''$D(^XUSEC(KEY,DUZ))\n\"RTN\",\"UJOWORWU\",98,0)\n Q\n\"RTN\",\"UJOWORWU\",99,0)\nHASOPTN(VAL,OPTION) ; returns TRUE if the user has access to a menu option\n\"RTN\",\"UJOWORWU\",100,0)\n S VAL=+$$ACCESS^XQCHK(DUZ,OPTION)\n\"RTN\",\"UJOWORWU\",101,0)\n I VAL'>0 S VAL=0\n\"RTN\",\"UJOWORWU\",102,0)\n E  S VAL=1\n\"RTN\",\"UJOWORWU\",103,0)\n Q\n\"RTN\",\"UJOWORWU\",104,0)\nNPHASKEY(VAL,NP,KEY) ; returns TRUE if the person has the security key\n\"RTN\",\"UJOWORWU\",105,0)\n S VAL=''$D(^XUSEC(KEY,NP))\n\"RTN\",\"UJOWORWU\",106,0)\n Q\n\"RTN\",\"UJOWORWU\",107,0)\nORDROLE() ; returns the role a person takes in ordering\n\"RTN\",\"UJOWORWU\",108,0)\n ; VAL: 0=nokey, 1=clerk, 2=nurse, 3=physician, 4=student, 5=bad keys\n\"RTN\",\"UJOWORWU\",109,0)\n ;I '$G(ORWCLVER) Q 0  ; version of client is to old for ordering\n\"RTN\",\"UJOWORWU\",110,0)\n I ($D(^XUSEC(\"OREMAS\",DUZ))+$D(^XUSEC(\"ORELSE\",DUZ))+$D(^XUSEC(\"ORES\",DUZ)))>1 Q 5\n\"RTN\",\"UJOWORWU\",111,0)\n I $D(^XUSEC(\"OREMAS\",DUZ)) Q 1                           ; clerk\n\"RTN\",\"UJOWORWU\",112,0)\n I $D(^XUSEC(\"ORELSE\",DUZ)) Q 2                           ; nurse\n\"RTN\",\"UJOWORWU\",113,0)\n I $D(^XUSEC(\"ORES\",DUZ)),$D(^XUSEC(\"PROVIDER\",DUZ)) Q 3  ; doctor\n\"RTN\",\"UJOWORWU\",114,0)\n I $D(^XUSEC(\"PROVIDER\",DUZ)) Q 4                         ; student\n\"RTN\",\"UJOWORWU\",115,0)\n Q 0\n\"RTN\",\"UJOWORWU\",116,0)\nVALIDSIG(ESOK,X) ; returns TRUE if valid electronic signature\n\"RTN\",\"UJOWORWU\",117,0)\n S X=$$DECRYP^XUSRB1(X),ESOK=0                   ; network encrypted\n\"RTN\",\"UJOWORWU\",118,0)\n D HASH^XUSHSHP\n\"RTN\",\"UJOWORWU\",119,0)\n I X=$P($G(^VA(200,+DUZ,20)),U,4) S ESOK=1\n\"RTN\",\"UJOWORWU\",120,0)\n Q\n\"RTN\",\"UJOWORWU\",121,0)\nTOOLMENU(ORLST) ; returns a list of items for the Tools menu\n\"RTN\",\"UJOWORWU\",122,0)\n N ANENT\n\"RTN\",\"UJOWORWU\",123,0)\n S ANENT=\"ALL^\"_$S($G(^VA(200,DUZ,5)):\"^SRV.`\"_+$G(^(5)),1:\"\")\n\"RTN\",\"UJOWORWU\",124,0)\n D GETLST^XPAR(.ORLST,ANENT,\"ORWT TOOLS MENU\",\"N\")\n\"RTN\",\"UJOWORWU\",125,0)\n Q\n\"RTN\",\"UJOWORWU\",126,0)\nACTLOC(LOC) ; Function: returns TRUE if active hospital location\n\"RTN\",\"UJOWORWU\",127,0)\n ; IA# 10040.\n\"RTN\",\"UJOWORWU\",128,0)\n N D0,X I +$G(^SC(LOC,\"OOS\")) Q 0                ; screen out OOS entry\n\"RTN\",\"UJOWORWU\",129,0)\n S D0=+$G(^SC(LOC,42)) I D0 D WIN^DGPMDDCF Q 'X  ; chk out of svc wards\n\"RTN\",\"UJOWORWU\",130,0)\n S X=$G(^SC(LOC,\"I\")) I +X=0 Q 1                 ; no inactivate date\n\"RTN\",\"UJOWORWU\",131,0)\n I DT>$P(X,U)&($P(X,U,2)=\"\"!(DT<$P(X,U,2))) Q 0  ; chk reactivate date\n\"RTN\",\"UJOWORWU\",132,0)\n Q 1                                             ; must still be active\n\"RTN\",\"UJOWORWU\",133,0)\n ;\n\"RTN\",\"UJOWORWU\",134,0)\nCLINLOC(Y,FROM,DIR) ; Return a set of clinics from HOSPITAL LOCATION\n\"RTN\",\"UJOWORWU\",135,0)\n ; .Y=returned list, FROM=text to $O from, DIR=$O direction,\n\"RTN\",\"UJOWORWU\",136,0)\n N I,IEN,CNT S I=0,CNT=44\n\"RTN\",\"UJOWORWU\",137,0)\n F  Q:I'<CNT  S FROM=$O(^SC(\"B\",FROM),DIR) Q:FROM=\"\"  D  ; IA# 10040.\n\"RTN\",\"UJOWORWU\",138,0)\n . S IEN=\"\" F  S IEN=$O(^SC(\"B\",FROM,IEN),DIR) Q:'IEN  D\n\"RTN\",\"UJOWORWU\",139,0)\n . . I ($P($G(^SC(IEN,0)),U,3)'=\"C\")!('$$ACTLOC(IEN)) Q\n\"RTN\",\"UJOWORWU\",140,0)\n . . S I=I+1,Y(I)=IEN_\"^\"_FROM\n\"RTN\",\"UJOWORWU\",141,0)\n Q\n\"RTN\",\"UJOWORWU\",142,0)\nINPLOC(Y,FROM,DIR) ;Return a set of wards from HOSPITAL LOCATION\n\"RTN\",\"UJOWORWU\",143,0)\n ; .Y=returned list, FROM=text to $O from, DIR=$O direction,\n\"RTN\",\"UJOWORWU\",144,0)\n N I,IEN,CNT S I=0,CNT=44\n\"RTN\",\"UJOWORWU\",145,0)\n F  Q:I'<CNT  S FROM=$O(^SC(\"B\",FROM),DIR) Q:FROM=\"\"  D  ; IA# 10040.\n\"RTN\",\"UJOWORWU\",146,0)\n . S IEN=\"\" F  S IEN=$O(^SC(\"B\",FROM,IEN),DIR) Q:'IEN  D\n\"RTN\",\"UJOWORWU\",147,0)\n . . I ($P($G(^SC(IEN,0)),U,3)'=\"W\") Q\n\"RTN\",\"UJOWORWU\",148,0)\n . . I '$$ACTLOC(IEN) Q\n\"RTN\",\"UJOWORWU\",149,0)\n . . S I=I+1,Y(I)=IEN_\"^\"_FROM\n\"RTN\",\"UJOWORWU\",150,0)\n Q\n\"RTN\",\"UJOWORWU\",151,0)\nHOSPLOC(Y,FROM,DIR) ; Return a set of locations from HOSPITAL LOCATION\n\"RTN\",\"UJOWORWU\",152,0)\n ; .Y=returned list, FROM=text to $O from, DIR=$O direction,\n\"RTN\",\"UJOWORWU\",153,0)\n N I,IEN,CNT S I=0,CNT=44\n\"RTN\",\"UJOWORWU\",154,0)\n F  Q:I'<CNT  S FROM=$O(^SC(\"B\",FROM),DIR) Q:FROM=\"\"  D  ; IA# 10040.\n\"RTN\",\"UJOWORWU\",155,0)\n . S IEN=\"\" F  S IEN=$O(^SC(\"B\",FROM,IEN),DIR) Q:'IEN  D\n\"RTN\",\"UJOWORWU\",156,0)\n . . Q:(\"CW\"'[$P($G(^SC(IEN,0)),U,3)!('$$ACTLOC(IEN)))\n\"RTN\",\"UJOWORWU\",157,0)\n . . S I=I+1,Y(I)=IEN_\"^\"_FROM\n\"RTN\",\"UJOWORWU\",158,0)\n Q\n\"RTN\",\"UJOWORWU\",159,0)\nNEWPERS(ORY,ORFROM,ORDIR,ORKEY,ORDATE,ORVIZ,ORALL) ; Return a set of names from the NEW PERSON file.\n\"RTN\",\"UJOWORWU\",160,0)\n ; SLC/PKS: Code moved to ORWU1 on 12/3/2002.\n\"RTN\",\"UJOWORWU\",161,0)\n D NP1^ORWU1\n\"RTN\",\"UJOWORWU\",162,0)\n Q\n\"RTN\",\"UJOWORWU\",163,0)\nGBLREF(VAL,FN) ; return global reference for file number\n\"RTN\",\"UJOWORWU\",164,0)\n S VAL=\"\" Q:'FN\n\"RTN\",\"UJOWORWU\",165,0)\n S VAL=$$ROOT^DILFD(+FN)\n\"RTN\",\"UJOWORWU\",166,0)\n ; I $E($RE(VAL))=\",\" S VAL=$E(VAL,1,$L(VAL)-1)_\")\"\n\"RTN\",\"UJOWORWU\",167,0)\n ; I $E($RE(VAL))=\"(\" S VAL=$P(VAL,\"(\",1) \n\"RTN\",\"UJOWORWU\",168,0)\n Q\n\"RTN\",\"UJOWORWU\",169,0)\nGENERIC(Y,FROM,DIR,REF) ; Return a set of entries from xref in REF\n\"RTN\",\"UJOWORWU\",170,0)\n ; .Y=returned list, FROM=text to $O from, DIR=$O direction,\n\"RTN\",\"UJOWORWU\",171,0)\n N I,IEN,CNT S I=0,CNT=44\n\"RTN\",\"UJOWORWU\",172,0)\n F  Q:I'<CNT  S FROM=$O(@REF@(FROM),DIR) Q:FROM=\"\"  D\n\"RTN\",\"UJOWORWU\",173,0)\n . S IEN=\"\" F  S IEN=$O(@REF@(FROM,IEN),DIR) Q:'IEN  D\n\"RTN\",\"UJOWORWU\",174,0)\n . . S I=I+1,Y(I)=IEN_\"^\"_FROM\n\"RTN\",\"UJOWORWU\",175,0)\n Q\n\"RTN\",\"UJOWORWU\",176,0)\nEXTNAME(VAL,IEN,FN) ; return external form of pointer\n\"RTN\",\"UJOWORWU\",177,0)\n ; IEN=internal number, FN=file number\n\"RTN\",\"UJOWORWU\",178,0)\n N REF S REF=$G(^DIC(FN,0,\"GL\")),VAL=\"\"\n\"RTN\",\"UJOWORWU\",179,0)\n I $L(REF),+IEN S VAL=$P($G(@(REF_IEN_\",0)\")),U)\n\"RTN\",\"UJOWORWU\",180,0)\n Q\n\"RTN\",\"UJOWORWU\",181,0)\nPARAM(VAL,APARAM) ; return a parameter value for a user\n\"RTN\",\"UJOWORWU\",182,0)\n ; call assumes current user, default entities, single instance\n\"RTN\",\"UJOWORWU\",183,0)\n S VAL=$$GET^XPAR(\"ALL\",APARAM,1,\"I\")\n\"RTN\",\"UJOWORWU\",184,0)\n Q\n\"RTN\",\"UJOWORWU\",185,0)\nPARAMS(ORLIST,APARAM) ; return a list of parameter values\n\"RTN\",\"UJOWORWU\",186,0)\n ; call assumes current user, default entities, multiple instances\n\"RTN\",\"UJOWORWU\",187,0)\n D GETLST^XPAR(.ORLIST,\"ALL\",APARAM,\"Q\")\n\"RTN\",\"UJOWORWU\",188,0)\n Q\n\"RTN\",\"UJOWORWU\",189,0)\nDEVICE(Y,FROM,DIR) ; Return a subset of entries from the Device file\n\"RTN\",\"UJOWORWU\",190,0)\n ; .LST(n)=IEN;Name^DisplayName^Location^RMar^PLen\n\"RTN\",\"UJOWORWU\",191,0)\n ; FROM=text to $O from, DIR=$O direction\n\"RTN\",\"UJOWORWU\",192,0)\n N I,IEN,CNT,SHOW,X S I=0,CNT=20\n\"RTN\",\"UJOWORWU\",193,0)\n I FROM[\"<\" S FROM=$RE($P($RE(FROM),\"<  \",2))\n\"RTN\",\"UJOWORWU\",194,0)\n F  Q:I'<CNT  S FROM=$O(^%ZIS(1,\"B\",FROM),DIR) Q:FROM=\"\"  D\n\"RTN\",\"UJOWORWU\",195,0)\n . S IEN=0 F  S IEN=$O(^%ZIS(1,\"B\",FROM,IEN)) Q:'IEN  D\n\"RTN\",\"UJOWORWU\",196,0)\n .. N X0,X1,X90,X91,X95,XTYPE,XSTYPE,XTIME,ORA,ORPX,POP\n\"RTN\",\"UJOWORWU\",197,0)\n .. Q:'$D(^%ZIS(1,IEN,0))  S X0=^(0),X1=$G(^(1)),X90=$G(^(90)),X91=$G(^(91)),X95=$G(^(95)),XSTYPE=$G(^(\"SUBTYPE\")),XTIME=$G(^(\"TIME\")),XTYPE=$G(^(\"TYPE\"))\n\"RTN\",\"UJOWORWU\",198,0)\n .. I $E($G(^%ZIS(2,+XSTYPE,0)))'=\"P\" Q  ;Printers only\n\"RTN\",\"UJOWORWU\",199,0)\n .. S X=$P(XTYPE,\"^\") I X'=\"TRM\",X'=\"HG\",X'=\"HFS\",X'=\"CHAN\" Q  ;Device Types\n\"RTN\",\"UJOWORWU\",200,0)\n .. S X=X0 I ($P(X,U,2)=\"0\")!($P(X,U,12)=2) Q  ;Queuing allowed\n\"RTN\",\"UJOWORWU\",201,0)\n .. S X=+X90 I X,(X'>DT) Q  ;Out of Service\n\"RTN\",\"UJOWORWU\",202,0)\n .. I XTIME]\"\" S ORA=$P(XTIME,\"^\"),ORPX=$P($H,\",\",2),ORPCNT=ORPX\\60#60+(ORPX\\3600*100),ORPX=$P(ORA,\"-\",2) I ORPX'<ORA&(ORPCNT'>ORPX&(ORPCNT'<ORA))!(ORPX<ORA&(ORPCNT'<ORA!(ORPCNT'>ORPX))) Q  ;Prohibited Times\n\"RTN\",\"UJOWORWU\",203,0)\n .. S POP=0\n\"RTN\",\"UJOWORWU\",204,0)\n .. I X95]\"\" S ORPX=$G(DUZ(0)) I ORPX'=\"@\" S POP=1 F ORA=1:1:$L(ORPX) I X95[$E(ORPX,ORA) S POP=0 Q\n\"RTN\",\"UJOWORWU\",205,0)\n .. Q:POP  ;Security check\n\"RTN\",\"UJOWORWU\",206,0)\n .. S SHOW=$P(X0,U) I SHOW'=FROM S SHOW=FROM_\"  <\"_SHOW_\">\"\n\"RTN\",\"UJOWORWU\",207,0)\n .. S I=I+1,Y(I)=IEN_\";\"_$P(X0,U)_U_SHOW_U_$P(X1,U)_U_$P(X91,U)_U_$P(X91,U,3)\n\"RTN\",\"UJOWORWU\",208,0)\n Q\n\"RTN\",\"UJOWORWU\",209,0)\nURGENCY(Y) ; -- retrieve set values from dd for discharge summary urgency\n\"RTN\",\"UJOWORWU\",210,0)\n N ORDD,I,X\n\"RTN\",\"UJOWORWU\",211,0)\n D FIELD^DID(8925,.09,\"\",\"POINTER\",\"ORDD\")\n\"RTN\",\"UJOWORWU\",212,0)\n F I=1:1 S X=$P(ORDD(\"POINTER\"),\";\",I) Q:X=\"\"   S Y(I)=$TR(X,\":\",\"^\")\n\"RTN\",\"UJOWORWU\",213,0)\n Q\n\"RTN\",\"UJOWORWU\",214,0)\nPATCH(VAL,X) ; Return 1 if patch X is installed\n\"RTN\",\"UJOWORWU\",215,0)\n S VAL=$$PATCH^XPDUTL(X)\n\"RTN\",\"UJOWORWU\",216,0)\n Q\n\"RTN\",\"UJOWORWU\",217,0)\nVERSION(VAL,X) ;Return version of package or namespace\n\"RTN\",\"UJOWORWU\",218,0)\n S VAL=$$VERSION^XPDUTL(X)\n\"RTN\",\"UJOWORWU\",219,0)\n Q\n\"RTN\",\"UJOWORWU\",220,0)\nVERSRV(VAL,X,CLVER) ; Return server version of option name\n\"RTN\",\"UJOWORWU\",221,0)\n S ORWCLVER=$G(CLVER)  ; leave in partition for session\n\"RTN\",\"UJOWORWU\",222,0)\n N BADVAL,ORLST\n\"RTN\",\"UJOWORWU\",223,0)\n D FIND^DIC(19,\"\",1,\"X\",X,1,,,,\"ORLST\")\n\"RTN\",\"UJOWORWU\",224,0)\n I 'ORLST(\"DILIST\",0) S VAL=\"0.0.0.0\" Q\n\"RTN\",\"UJOWORWU\",225,0)\n S VAL=ORLST(\"DILIST\",\"ID\",1,1)\n\"RTN\",\"UJOWORWU\",226,0)\n S VAL=$P(VAL,\"version \",2)\n\"RTN\",\"UJOWORWU\",227,0)\n S BADVAL=0\n\"RTN\",\"UJOWORWU\",228,0)\n I $P(VAL,\".\",1)=\"\" S BADVAL=1\n\"RTN\",\"UJOWORWU\",229,0)\n I $P(VAL,\".\",2)=\"\" S BADVAL=1\n\"RTN\",\"UJOWORWU\",230,0)\n I $P(VAL,\".\",3)=\"\" S BADVAL=1\n\"RTN\",\"UJOWORWU\",231,0)\n I $P(VAL,\".\",4)=\"\" S BADVAL=1\n\"RTN\",\"UJOWORWU\",232,0)\n I ((BADVAL)!('VAL)!(VAL=\"\")) S VAL=\"0.0.0.0\"\n\"RTN\",\"UJOWORWU\",233,0)\n Q\n\"VER\")\n8.0^22.0\n**END**\n**END**\n",
      "registeredAt": "2025-12-25T22:57:33.092Z",
      "status": "error",
      "id": "4356d04a0ef14cd0",
      "linkedChanges": [
        "4810c3d51d3cdf45",
        "120a4543e509e8ef"
      ],
      "updatedAt": "2025-12-25T23:02:18.948Z",
      "error": "No files to commit for patch UJOW*1.0*59. The scan found 0 changed routines. Make sure:\n1. The Docker container has routines in localr/\n2. The routines from the patch exist in the container\n3. The scan detected changes correctly"
    },
    {
      "patchId": "UJOP*2.1*20",
      "package": "UJOP*2.1*20",
      "packageCode": "UJOP",
      "version": "2.1",
      "patchNumber": 20,
      "title": "Hakeem API Configuration Feature File",
      "createdDate": "2023-11-05T12:07:55",
      "author": "EHS/Ahmad Alkhalaileh",
      "description": [],
      "gitlabIssues": [],
      "routines": [
        "UJOSFOFF"
      ],
      "raw": "KIDS Distribution saved on Nov 05, 2023@12:07:55\nHakeem API Configuration Feature File\n**KIDS**:UJOP*2.1*20^\n\n**INSTALL NAME**\nUJOP*2.1*20\n\"BLD\",9320,0)\nUJOP*2.1*20^Generic VistA API^0^3231105^y\n\"BLD\",9320,1,0)\n^^9^9^3231105^^^^\n\"BLD\",9320,1,1,0)\nThis patch was created on 03/10/2023 by EHS/Ahmad Alkhalaileh\n\"BLD\",9320,1,2,0)\nFor Hakeem API Generalization \n\"BLD\",9320,1,3,0)\nhttps://gitlab.ehs.com.jo/software_projects/hakeem-API/-/milestones/2\n\"BLD\",9320,1,4,0)\n \n\"BLD\",9320,1,5,0)\n \n\"BLD\",9320,1,6,0)\nThis Patch Will Hold Hakeem API Configuration Setting To Switch On/Off \n\"BLD\",9320,1,7,0)\nFeature That Configure It\n\"BLD\",9320,1,8,0)\n \n\"BLD\",9320,1,9,0)\nAnd Contain Routine To Check If Feature in This File Is Enabled Or Not\n\"BLD\",9320,4,0)\n^9.64PA^400080002^1\n\"BLD\",9320,4,400080002,0)\n400080002\n\"BLD\",9320,4,400080002,222)\ny^y^f^^n^^y^o^n\n\"BLD\",9320,4,\"B\",400080002,400080002)\n\n\"BLD\",9320,6.3)\n5\n\"BLD\",9320,\"KRN\",0)\n^9.67PA^779.2^20\n\"BLD\",9320,\"KRN\",.4,0)\n.4\n\"BLD\",9320,\"KRN\",.401,0)\n.401\n\"BLD\",9320,\"KRN\",.402,0)\n.402\n\"BLD\",9320,\"KRN\",.403,0)\n.403\n\"BLD\",9320,\"KRN\",.5,0)\n.5\n\"BLD\",9320,\"KRN\",.84,0)\n.84\n\"BLD\",9320,\"KRN\",3.6,0)\n3.6\n\"BLD\",9320,\"KRN\",3.8,0)\n3.8\n\"BLD\",9320,\"KRN\",9.2,0)\n9.2\n\"BLD\",9320,\"KRN\",9.8,0)\n9.8\n\"BLD\",9320,\"KRN\",9.8,\"NM\",0)\n^9.68A^1^1\n\"BLD\",9320,\"KRN\",9.8,\"NM\",1,0)\nUJOSFOFF^^0^B2572539\n\"BLD\",9320,\"KRN\",9.8,\"NM\",\"B\",\"UJOSFOFF\",1)\n\n\"BLD\",9320,\"KRN\",19,0)\n19\n\"BLD\",9320,\"KRN\",19.1,0)\n19.1\n\"BLD\",9320,\"KRN\",101,0)\n101\n\"BLD\",9320,\"KRN\",409.61,0)\n409.61\n\"BLD\",9320,\"KRN\",771,0)\n771\n\"BLD\",9320,\"KRN\",779.2,0)\n779.2\n\"BLD\",9320,\"KRN\",870,0)\n870\n\"BLD\",9320,\"KRN\",8989.51,0)\n8989.51\n\"BLD\",9320,\"KRN\",8989.52,0)\n8989.52\n\"BLD\",9320,\"KRN\",8994,0)\n8994\n\"BLD\",9320,\"KRN\",\"B\",.4,.4)\n\n\"BLD\",9320,\"KRN\",\"B\",.401,.401)\n\n\"BLD\",9320,\"KRN\",\"B\",.402,.402)\n\n\"BLD\",9320,\"KRN\",\"B\",.403,.403)\n\n\"BLD\",9320,\"KRN\",\"B\",.5,.5)\n\n\"BLD\",9320,\"KRN\",\"B\",.84,.84)\n\n\"BLD\",9320,\"KRN\",\"B\",3.6,3.6)\n\n\"BLD\",9320,\"KRN\",\"B\",3.8,3.8)\n\n\"BLD\",9320,\"KRN\",\"B\",9.2,9.2)\n\n\"BLD\",9320,\"KRN\",\"B\",9.8,9.8)\n\n\"BLD\",9320,\"KRN\",\"B\",19,19)\n\n\"BLD\",9320,\"KRN\",\"B\",19.1,19.1)\n\n\"BLD\",9320,\"KRN\",\"B\",101,101)\n\n\"BLD\",9320,\"KRN\",\"B\",409.61,409.61)\n\n\"BLD\",9320,\"KRN\",\"B\",771,771)\n\n\"BLD\",9320,\"KRN\",\"B\",779.2,779.2)\n\n\"BLD\",9320,\"KRN\",\"B\",870,870)\n\n\"BLD\",9320,\"KRN\",\"B\",8989.51,8989.51)\n\n\"BLD\",9320,\"KRN\",\"B\",8989.52,8989.52)\n\n\"BLD\",9320,\"KRN\",\"B\",8994,8994)\n\n\"BLD\",9320,\"QUES\",0)\n^9.62^^\n\"DATA\",400080002,1,0)\nSINGLE/MULTI^^0^^\n\"DATA\",400080002,2,0)\nREFERRAL^SADS^0\n\"DATA\",400080002,3,0)\nSIUTASK^SIUTASK for the configration to fire SIUTASK once the appointment added^0\n\"DATA\",400080002,5,0)\nPATIENT IMG^Filling the file #400087016 'UJOW PATIENT IMG' with patient image string^0\n\"DATA\",400080002,6,0)\nAuto gen num^KHCC auto generated incremental number^0\n\"DATA\",400080002,7,0)\nwrong entry enhanc^Change the algorithm of the \"wrong entry\" SSN to be in minus^0\n\"DATA\",400080002,8,0)\nHL7 CHID^Generate HL7 message for change patient national ID^0\n\"DATA\",400080002,9,0)\nMEDICAL CALC MOH^This configration for medical calc moh^0\n\"FIA\",400080002)\nUJOP API FEATURE CONFIGURATION\n\"FIA\",400080002,0)\n^UJOP(400080002,\n\"FIA\",400080002,0,0)\n400080002\n\"FIA\",400080002,0,1)\ny^y^f^^n^^y^o^n\n\"FIA\",400080002,0,10)\n\n\"FIA\",400080002,0,11)\n\n\"FIA\",400080002,0,\"RLRO\")\n\n\"FIA\",400080002,0,\"VR\")\n2.1^UJOP\n\"FIA\",400080002,400080002)\n0\n\"IX\",400080002,400080002,\"FE\",0)\n400080002^FE^FEATURE AND STATUS^R^^R^IR^I^400080002^^^^^LS\n\"IX\",400080002,400080002,\"FE\",.1,0)\n^^1^1^3231011^^\n\"IX\",400080002,400080002,\"FE\",.1,1,0)\nFEATURE and STATUS\n\"IX\",400080002,400080002,\"FE\",1)\nS ^UJOP(400080002,\"FE\",$E(X(1),1,30),X(2),DA)=\"\"\n\"IX\",400080002,400080002,\"FE\",2)\nK ^UJOP(400080002,\"FE\",$E(X(1),1,30),X(2),DA)\n\"IX\",400080002,400080002,\"FE\",2.5)\nK ^UJOP(400080002,\"FE\")\n\"IX\",400080002,400080002,\"FE\",11.1,0)\n^.114IA^2^2\n\"IX\",400080002,400080002,\"FE\",11.1,1,0)\n1^F^400080002^.01^30^1^F\n\"IX\",400080002,400080002,\"FE\",11.1,1,3)\n\n\"IX\",400080002,400080002,\"FE\",11.1,2,0)\n2^F^400080002^.03^^2^F\n\"IX\",400080002,400080002,\"FE\",11.1,2,3)\n\n\"MBREQ\")\n0\n\"PKG\",230,-1)\n1^1\n\"PKG\",230,0)\nGeneric VistA API^UJOP^Generic VistA API's\n\"PKG\",230,20,0)\n^9.402P^^\n\"PKG\",230,22,0)\n^9.49I^1^1\n\"PKG\",230,22,1,0)\n2.1\n\"PKG\",230,22,1,\"PAH\",1,0)\n20^3231105^8\n\"PKG\",230,22,1,\"PAH\",1,1,0)\n^^9^9^3231105\n\"PKG\",230,22,1,\"PAH\",1,1,1,0)\nThis patch was created on 03/10/2023 by EHS/Ahmad Alkhalaileh\n\"PKG\",230,22,1,\"PAH\",1,1,2,0)\nFor Hakeem API Generalization \n\"PKG\",230,22,1,\"PAH\",1,1,3,0)\nhttps://gitlab.ehs.com.jo/software_projects/hakeem-API/-/milestones/2\n\"PKG\",230,22,1,\"PAH\",1,1,4,0)\n \n\"PKG\",230,22,1,\"PAH\",1,1,5,0)\n \n\"PKG\",230,22,1,\"PAH\",1,1,6,0)\nThis Patch Will Hold Hakeem API Configuration Setting To Switch On/Off \n\"PKG\",230,22,1,\"PAH\",1,1,7,0)\nFeature That Configure It\n\"PKG\",230,22,1,\"PAH\",1,1,8,0)\n \n\"PKG\",230,22,1,\"PAH\",1,1,9,0)\nAnd Contain Routine To Check If Feature in This File Is Enabled Or Not\n\"QUES\",\"XPF1\",0)\nY\n\"QUES\",\"XPF1\",\"??\")\n^D REP^XPDH\n\"QUES\",\"XPF1\",\"A\")\nShall I write over your |FLAG| File\n\"QUES\",\"XPF1\",\"B\")\nYES\n\"QUES\",\"XPF1\",\"M\")\nD XPF1^XPDIQ\n\"QUES\",\"XPF2\",0)\nY\n\"QUES\",\"XPF2\",\"??\")\n^D DTA^XPDH\n\"QUES\",\"XPF2\",\"A\")\nWant my data |FLAG| yours\n\"QUES\",\"XPF2\",\"B\")\nYES\n\"QUES\",\"XPF2\",\"M\")\nD XPF2^XPDIQ\n\"QUES\",\"XPI1\",0)\nYO\n\"QUES\",\"XPI1\",\"??\")\n^D INHIBIT^XPDH\n\"QUES\",\"XPI1\",\"A\")\nWant KIDS to INHIBIT LOGONs during the install\n\"QUES\",\"XPI1\",\"B\")\nNO\n\"QUES\",\"XPI1\",\"M\")\nD XPI1^XPDIQ\n\"QUES\",\"XPM1\",0)\nPO^VA(200,:EM\n\"QUES\",\"XPM1\",\"??\")\n^D MG^XPDH\n\"QUES\",\"XPM1\",\"A\")\nEnter the Coordinator for Mail Group '|FLAG|'\n\"QUES\",\"XPM1\",\"B\")\n\n\"QUES\",\"XPM1\",\"M\")\nD XPM1^XPDIQ\n\"QUES\",\"XPO1\",0)\nY\n\"QUES\",\"XPO1\",\"??\")\n^D MENU^XPDH\n\"QUES\",\"XPO1\",\"A\")\nWant KIDS to Rebuild Menu Trees Upon Completion of Install\n\"QUES\",\"XPO1\",\"B\")\nNO\n\"QUES\",\"XPO1\",\"M\")\nD XPO1^XPDIQ\n\"QUES\",\"XPZ1\",0)\nY\n\"QUES\",\"XPZ1\",\"??\")\n^D OPT^XPDH\n\"QUES\",\"XPZ1\",\"A\")\nWant to DISABLE Scheduled Options, Menu Options, and Protocols\n\"QUES\",\"XPZ1\",\"B\")\nNO\n\"QUES\",\"XPZ1\",\"M\")\nD XPZ1^XPDIQ\n\"QUES\",\"XPZ2\",0)\nY\n\"QUES\",\"XPZ2\",\"??\")\n^D RTN^XPDH\n\"QUES\",\"XPZ2\",\"A\")\nWant to MOVE routines to other CPUs\n\"QUES\",\"XPZ2\",\"B\")\nNO\n\"QUES\",\"XPZ2\",\"M\")\nD XPZ2^XPDIQ\n\"RTN\")\n1\n\"RTN\",\"UJOSFOFF\")\n0^1^B2572539\n\"RTN\",\"UJOSFOFF\",1,0)\nUJOSFOFF       ;EHS/ROJ  Hakeem API Feature Checker\n\"RTN\",\"UJOSFOFF\",2,0)\n        ;;2.1;UJOP;**20**;OCT 4,2023;Build 5\n\"RTN\",\"UJOSFOFF\",3,0)\n        ; Description : This is routine contains function to return site feature status.\n\"RTN\",\"UJOSFOFF\",4,0)\n        QUIT\n\"RTN\",\"UJOSFOFF\",5,0)\n        ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOSFOFF\",6,0)\n        ; Name         : GETFET\n\"RTN\",\"UJOSFOFF\",7,0)\n        ;\n\"RTN\",\"UJOSFOFF\",8,0)\n        ; Description  : This function is used to return feature status on the current site\n\"RTN\",\"UJOSFOFF\",9,0)\n        ;\n\"RTN\",\"UJOSFOFF\",10,0)\n        ; In           : FEATURE: The requried feature\n\"RTN\",\"UJOSFOFF\",11,0)\n        ;\n\"RTN\",\"UJOSFOFF\",12,0)\n        ; Out          : STATUS: Feature status\n\"RTN\",\"UJOSFOFF\",13,0)\n        ;\n\"RTN\",\"UJOSFOFF\",14,0)\n        ; Return       : N/A \n\"RTN\",\"UJOSFOFF\",15,0)\n        ;\n\"RTN\",\"UJOSFOFF\",16,0)\n        ; Notes        : N/A\n\"RTN\",\"UJOSFOFF\",17,0)\n        ;                \n\"RTN\",\"UJOSFOFF\",18,0)\n        ;\n\"RTN\",\"UJOSFOFF\",19,0)\n        ; Author(s)    : Roaa Aljaafreh\n\"RTN\",\"UJOSFOFF\",20,0)\n        ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;\n\"RTN\",\"UJOSFOFF\",21,0)\nGETFET(FEATURE) \n\"RTN\",\"UJOSFOFF\",22,0)\n        IF $GET(FEATURE)=\"\" QUIT 0\n\"RTN\",\"UJOSFOFF\",23,0)\n        NEW STATUS\n\"RTN\",\"UJOSFOFF\",24,0)\n        SET STATUS=$ORDER(^UJOP(400080002,\"FE\",FEATURE,STATUS))\n\"RTN\",\"UJOSFOFF\",25,0)\n        QUIT STATUS\n\"SEC\",\"^DIC\",400080002,400080002,0,\"AUDIT\")\n\n\"SEC\",\"^DIC\",400080002,400080002,0,\"DD\")\n@\n\"SEC\",\"^DIC\",400080002,400080002,0,\"DEL\")\n#\n\"SEC\",\"^DIC\",400080002,400080002,0,\"LAYGO\")\n@\n\"SEC\",\"^DIC\",400080002,400080002,0,\"RD\")\n@\n\"SEC\",\"^DIC\",400080002,400080002,0,\"WR\")\n@\n\"VER\")\n8.0^22.0\n\"^DD\",400080002,400080002,0)\nFIELD^^.03^3\n\"^DD\",400080002,400080002,0,\"DDA\")\nN\n\"^DD\",400080002,400080002,0,\"DT\")\n3231011\n\"^DD\",400080002,400080002,0,\"IX\",\"B\",400080002,.01)\n\n\"^DD\",400080002,400080002,0,\"NM\",\"UJOP API FEATURE CONFIGURATION\")\n\n\"^DD\",400080002,400080002,0,\"VRPK\")\nUJOP\n\"^DD\",400080002,400080002,.01,0)\nFEATURE NAME^RFI^^0;1^K:$L(X)>30!(X?.N)!($L(X)<3)!'(X'?1P.E) X\n\"^DD\",400080002,400080002,.01,1,0)\n^.1\n\"^DD\",400080002,400080002,.01,1,1,0)\n400080002^B\n\"^DD\",400080002,400080002,.01,1,1,1)\nS ^UJOP(400080002,\"B\",$E(X,1,30),DA)=\"\"\n\"^DD\",400080002,400080002,.01,1,1,2)\nK ^UJOP(400080002,\"B\",$E(X,1,30),DA)\n\"^DD\",400080002,400080002,.01,3)\nNAME MUST BE 3-30 CHARACTERS, NOT NUMERIC OR STARTING WITH PUNCTUATION\n\"^DD\",400080002,400080002,.01,21,0)\n^^1^1^3231017^^^\n\"^DD\",400080002,400080002,.01,21,1,0)\nThis Field Will Hold Feature Name That Will Be Configured\n\"^DD\",400080002,400080002,.01,23,0)\n^^4^4^3231017^\n\"^DD\",400080002,400080002,.01,23,1,0)\nThis Field was created on 02/10/2023 by EHS/Ahmad Alkhalaileh\n\"^DD\",400080002,400080002,.01,23,2,0)\nin UJOP*2.1*20\n\"^DD\",400080002,400080002,.01,23,3,0)\n \n\"^DD\",400080002,400080002,.01,23,4,0)\nThis Field Will Hold The Feature That Will Be Configured\n\"^DD\",400080002,400080002,.01,\"AUDIT\")\nn\n\"^DD\",400080002,400080002,.01,\"DT\")\n3231017\n\"^DD\",400080002,400080002,.02,0)\nDESCRIPTION^F^^0;2^K:$L(X)>200!($L(X)<1) X\n\"^DD\",400080002,400080002,.02,3)\nAnswer must be 1-200 characters in length.\n\"^DD\",400080002,400080002,.02,21,0)\n^^1^1^3231017^^\n\"^DD\",400080002,400080002,.02,21,1,0)\nThis Field To Add Description For The Feature That Would Be Added\n\"^DD\",400080002,400080002,.02,23,0)\n^^5^5^3231017^\n\"^DD\",400080002,400080002,.02,23,1,0)\nThis Field was created on 24/08/2023 by EHS/Ahmad Alkhalaileh\n\"^DD\",400080002,400080002,.02,23,2,0)\nin UJOP*2.1*20\n\"^DD\",400080002,400080002,.02,23,3,0)\n \n\"^DD\",400080002,400080002,.02,23,4,0)\nthis Field Will Hold Description For Every Every Feature That Will Be \n\"^DD\",400080002,400080002,.02,23,5,0)\nConfigured\n\"^DD\",400080002,400080002,.02,\"DT\")\n3231017\n\"^DD\",400080002,400080002,.03,0)\nSTATUS^RS^0:DISABLED;1:ENABLED;^0;3^Q\n\"^DD\",400080002,400080002,.03,3)\nENTER 1 TO ENABLE FEATURE OR 0 TO DISABLE IT\n\"^DD\",400080002,400080002,.03,21,0)\n^^1^1^3231017^^\n\"^DD\",400080002,400080002,.03,21,1,0)\nThis Field Will Enabled/Disabled Feature According to There Need\n\"^DD\",400080002,400080002,.03,23,0)\n^^4^4^3231017^\n\"^DD\",400080002,400080002,.03,23,1,0)\nThis Field was created on 24/08/2023 by EHS/Ahmad Alkhalaileh\n\"^DD\",400080002,400080002,.03,23,2,0)\nin UJOP*2.1*20\n\"^DD\",400080002,400080002,.03,23,3,0)\n \n\"^DD\",400080002,400080002,.03,23,4,0)\nThis Field Will Enabled/Disabled Feature According to There Need\n\"^DD\",400080002,400080002,.03,\"DT\")\n3231017\n\"^DIC\",400080002,400080002,0)\nUJOP API FEATURE CONFIGURATION^400080002\n\"^DIC\",400080002,400080002,0,\"GL\")\n^UJOP(400080002,\n\"^DIC\",400080002,400080002,\"%\",0)\n^1.005^^0\n\"^DIC\",400080002,400080002,\"%D\",0)\n^^5^5^3231017^\n\"^DIC\",400080002,400080002,\"%D\",1,0)\nThis file was created on 02/10/2023/ by EHS/Ahmad Alkhalaileh in Patch\n\"^DIC\",400080002,400080002,\"%D\",2,0)\n UJOP*2.1*20\n\"^DIC\",400080002,400080002,\"%D\",3,0)\n \n\"^DIC\",400080002,400080002,\"%D\",4,0)\nThis Patch Create For Hakeem API Generlization to Switch On/Off Feature\n\"^DIC\",400080002,400080002,\"%D\",5,0)\nAccording To There Enviroment and According to Need\n\"^DIC\",400080002,\"B\",\"UJOP API FEATURE CONFIGURATION\",400080002)\n\n**END**\n**END**\n",
      "registeredAt": "2025-12-27T09:06:36.982Z",
      "status": "pending",
      "id": "40922066323f28de",
      "linkedChanges": [
        "1d3ff72f9b9e88b7",
        "49b05656f5caea8a",
        "fdda1c7824bf7fb2",
        "b3f105fd529bd4a5",
        "a758c2f78c4bc2de"
      ],
      "updatedAt": "2025-12-25T23:29:15.568Z",
      "error": "No files to commit for patch UJOP*2.1*20. The scan found 0 changed routines. Make sure:\n1. The Docker container has routines in localr/\n2. The routines from the patch exist in the container\n3. The scan detected changes correctly"
    }
  ]
}